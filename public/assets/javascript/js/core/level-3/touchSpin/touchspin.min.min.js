(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{if(typeof module==="object"&&module.exports){module.exports=function(a,d){if(d===undefined){if(typeof window!=="undefined"){d=require("jquery")}else{d=require("jquery")(a)}}b(d);return d}}else{b(jQuery)}}}(function(c){var d=0;c.fn.TouchSpin=function(b){var a={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:false,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:true,boostat:10,maxboostedstep:false,mousewheel:true,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(e){return e},callback_after_calculation:function(e){return e}};var f={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var e,U=c(this),ax=U.data(),am,ai,ab,av,V,ar,S,ac,ah,ad=0,ak=false;P();function P(){if(U.data("alreadyinitialized")){return}U.data("alreadyinitialized",true);d+=1;U.data("spinnerid",d);if(!U.is("input")){console.log("Must be an input.");return}T();Q();an();aa();aw();ae();al();R()}function Q(){if(e.initval!==""&&U.val()===""){U.val(e.initval)}}function aq(g){Z(g);an();var h=av.input.val();if(h!==""){h=Number(e.callback_before_calculation(av.input.val()));av.input.val(e.callback_after_calculation(Number(h).toFixed(e.decimals)))}}function T(){e=c.extend({},a,ax,af(),b)}function af(){var g={};c.each(f,function(i,h){var j="bts-"+h+"";if(U.is("[data-"+j+"]")){g[i]=U.data(j)}});return g}function ao(){var g=U.parent();ag();U.off(".touchspin");if(g.hasClass("bootstrap-touchspin-injected")){U.siblings().remove();U.unwrap()}else{c(".bootstrap-touchspin-injected",g).remove();g.removeClass("bootstrap-touchspin")}U.data("alreadyinitialized",false)}function Z(g){e=c.extend({},e,g);if(g.postfix){var i=U.parent().find(".bootstrap-touchspin-postfix");if(i.length===0){ai.insertAfter(U)}U.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(g.postfix)}if(g.prefix){var h=U.parent().find(".bootstrap-touchspin-prefix");if(h.length===0){am.insertBefore(U)}U.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(g.prefix)}ae()}function aa(){var g=U.val(),h=U.parent();if(g!==""){g=e.callback_after_calculation(Number(g).toFixed(e.decimals))}U.data("initvalue",g).val(g);U.addClass("form-control");if(h.hasClass("input-group")){W(h)}else{au()}}function W(l){l.addClass("bootstrap-touchspin");var i=U.prev(),j=U.next();var g,m,k='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+e.prefix+"</span></span>",h='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+e.postfix+"</span></span>";if(i.hasClass("input-group-btn")||i.hasClass("input-group-prepend")){g='<button class="'+e.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button"><i class="fas fa-minus"></i></button>';i.append(g)}else{g='<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+e.buttondown_class+' bootstrap-touchspin-down" type="button"><i class="fas fa-minus"></i></button></span>';c(g).insertBefore(U)}if(j.hasClass("input-group-btn")||j.hasClass("input-group-append")){m='<button class="'+e.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button"><i class="fas fa-plus"></i></button>';j.prepend(m)}else{m='<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+e.buttonup_class+' bootstrap-touchspin-up" type="button"><i class="fas fa-plus"></i></button></span>';c(m).insertAfter(U)}c(k).insertBefore(U);c(h).insertAfter(U);ab=l}function au(){var h;var g="";if(U.hasClass("input-sm")){g="input-group-sm"}if(U.hasClass("input-lg")){g="input-group-lg"}if(e.verticalbuttons){h='<div class="input-group '+g+' bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+e.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+e.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+e.buttondown_class+" bootstrap-touchspin-up "+e.verticalupclass+'" type="button"><i class="fas fa-plus"></i></button><button class="'+e.buttonup_class+" bootstrap-touchspin-down "+e.verticaldownclass+'" type="button"><i class="fas fa-minus"></i></button></span></div>'}else{h='<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><button class="'+e.buttondown_class+' bootstrap-touchspin-down" type="button"><i class="fas fa-minus"></i></button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+e.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+e.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+e.buttonup_class+' bootstrap-touchspin-up" type="button"><i class="fas fa-plus"></i></button></span></div>'}ab=c(h).insertBefore(U);c(".bootstrap-touchspin-prefix",ab).after(U);if(U.hasClass("input-sm")){ab.addClass("input-group-sm")}else{if(U.hasClass("input-lg")){ab.addClass("input-group-lg")}}}function aw(){av={down:c(".bootstrap-touchspin-down",ab),up:c(".bootstrap-touchspin-up",ab),input:c("input",ab),prefix:c(".bootstrap-touchspin-prefix",ab).addClass(e.prefix_extraclass),postfix:c(".bootstrap-touchspin-postfix",ab).addClass(e.postfix_extraclass)}}function ae(){if(e.prefix===""){am=av.prefix.detach()}if(e.postfix===""){ai=av.postfix.detach()}}function al(){U.on("keydown.touchspin",function(g){var h=g.keyCode||g.which;if(h===38){if(ak!=="up"){ay();X()}g.preventDefault()}else{if(h===40){if(ak!=="down"){Y();at()}g.preventDefault()}}});U.on("keyup.touchspin",function(g){var h=g.keyCode||g.which;if(h===38){ag()}else{if(h===40){ag()}}});U.on("blur.touchspin",function(){an();U.val(e.callback_after_calculation(U.val()))});av.down.on("keydown",function(g){var h=g.keyCode||g.which;if(h===32||h===13){if(ak!=="down"){Y();at()}g.preventDefault()}});av.down.on("keyup.touchspin",function(g){var h=g.keyCode||g.which;if(h===32||h===13){ag()}});av.up.on("keydown.touchspin",function(g){var h=g.keyCode||g.which;if(h===32||h===13){if(ak!=="up"){ay();X()}g.preventDefault()}});av.up.on("keyup.touchspin",function(g){var h=g.keyCode||g.which;if(h===32||h===13){ag()}});av.down.on("mousedown.touchspin",function(g){av.down.off("touchstart.touchspin");if(U.is(":disabled")){return}Y();at();g.preventDefault();g.stopPropagation()});av.down.on("touchstart.touchspin",function(g){av.down.off("mousedown.touchspin");if(U.is(":disabled")){return}Y();at();g.preventDefault();g.stopPropagation()});av.up.on("mousedown.touchspin",function(g){av.up.off("touchstart.touchspin");if(U.is(":disabled")){return}ay();X();g.preventDefault();g.stopPropagation()});av.up.on("touchstart.touchspin",function(g){av.up.off("mousedown.touchspin");if(U.is(":disabled")){return}ay();X();g.preventDefault();g.stopPropagation()});av.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(g){if(!ak){return}g.stopPropagation();ag()});av.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(g){if(!ak){return}g.stopPropagation();ag()});av.down.on("mousemove.touchspin touchmove.touchspin",function(g){if(!ak){return}g.stopPropagation();g.preventDefault()});av.up.on("mousemove.touchspin touchmove.touchspin",function(g){if(!ak){return}g.stopPropagation();g.preventDefault()});U.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(h){if(!e.mousewheel||!U.is(":focus")){return}var g=h.originalEvent.wheelDelta||-h.originalEvent.deltaY||-h.originalEvent.detail;h.stopPropagation();h.preventDefault();if(g<0){Y()}else{ay()}})}function R(){U.on("touchspin.destroy",function(){ao()});U.on("touchspin.uponce",function(){ag();ay()});U.on("touchspin.downonce",function(){ag();Y()});U.on("touchspin.startupspin",function(){X()});U.on("touchspin.startdownspin",function(){at()});U.on("touchspin.stopspin",function(){ag()});U.on("touchspin.updatesettings",function(h,g){aq(g)})}function aj(g){switch(e.forcestepdivisibility){case"round":return(Math.round(g/e.step)*e.step).toFixed(e.decimals);case"floor":return(Math.floor(g/e.step)*e.step).toFixed(e.decimals);case"ceil":return(Math.ceil(g/e.step)*e.step).toFixed(e.decimals);default:return g}}function an(){var g,i,h;g=e.callback_before_calculation(U.val());if(g===""){if(e.replacementval!==""){U.val(e.replacementval);U.trigger("change")}return}if(e.decimals>0&&g==="."){return}i=parseFloat(g);if(isNaN(i)){if(e.replacementval!==""){i=e.replacementval}else{i=0}}h=i;if(i.toString()!==g){h=i}if((e.min!==null)&&(i<e.min)){h=e.min}if((e.max!==null)&&(i>e.max)){h=e.max}h=aj(h);if(Number(g).toString()!==h.toString()){U.val(h);U.trigger("change")}}function ap(){if(!e.booster){return e.step}else{var g=Math.pow(2,Math.floor(ad/e.boostat))*e.step;if(e.maxboostedstep){if(g>e.maxboostedstep){g=e.maxboostedstep;V=Math.round((V/g))*g}}return Math.max(e.step,g)}}function ay(){an();V=parseFloat(e.callback_before_calculation(av.input.val()));if(isNaN(V)){V=0}var g=V,h=ap();V=V+h;if((e.max!==null)&&(V>e.max)){V=e.max;U.trigger("touchspin.on.max");ag()}av.input.val(e.callback_after_calculation(Number(V).toFixed(e.decimals)));if(g!==V){U.trigger("change")}}function Y(){an();V=parseFloat(e.callback_before_calculation(av.input.val()));if(isNaN(V)){V=0}var g=V,h=ap();V=V-h;if((e.min!==null)&&(V<e.min)){V=e.min;U.trigger("touchspin.on.min");ag()}av.input.val(e.callback_after_calculation(Number(V).toFixed(e.decimals)));if(g!==V){U.trigger("change")}}function at(){ag();ad=0;ak="down";U.trigger("touchspin.on.startspin");U.trigger("touchspin.on.startdownspin");ac=setTimeout(function(){ar=setInterval(function(){ad++;Y()},e.stepinterval)},e.stepintervaldelay)}function X(){ag();ad=0;ak="up";U.trigger("touchspin.on.startspin");U.trigger("touchspin.on.startupspin");ah=setTimeout(function(){S=setInterval(function(){ad++;ay()},e.stepinterval)},e.stepintervaldelay)}function ag(){clearTimeout(ac);clearTimeout(ah);clearInterval(ar);clearInterval(S);switch(ak){case"up":U.trigger("touchspin.on.stopupspin");U.trigger("touchspin.on.stopspin");break;case"down":U.trigger("touchspin.on.stopdownspin");U.trigger("touchspin.on.stopspin");break}ad=0;ak=false}})}}));