!function(r){function q(b){var a=b.$header;return b.options.height&&(a=b.$tableHeader),a}function p(b){if(!r.isEmptyObject(b.filterColumnsPartial)){var a=q(b);r.each(b.columns,function(f,e){var g=b.filterColumnsPartial[e.field];if(e.filter){if(e.filter.setFilterValue){var d=a.find("[data-field="+e.field+"] .filter");e.filter.setFilterValue(d,e.field,g)}else{var c=a.find("[data-filter-field="+e.field+"]");switch(e.filter.type){case"input":c.val(g);case"select":c.val(g).trigger("change")}}}})}}function o(d,c){var a,e,b=!1,f=0;r.each(d.columns,function(u,i){if(a="hidden",e=null,i.visible){if(i.filter){var h=i.filter["class"]?" "+i.filter["class"]:"";if(e=r('<div style="margin: 0px 2px 2px 2px;" class="filter'+h+'">'),i.searchable&&(b=!0,a="visible"),i.filter.template){e.append(i.filter.template(d,i,a))}else{var g=r(d.options.filterTemplate[i.filter.type.toLowerCase()](d,i,a));switch(i.filter.type){case"input":var v=!0;g.off("compositionstart").on("compositionstart",function(){v=!1}),g.off("compositionend").on("compositionend",function(t){v=!0;var s=r(this);clearTimeout(f),f=setTimeout(function(){d.onColumnSearch(t,i.field,s.val())},d.options.searchTimeOut)}),g.off("keyup").on("keyup",function(t){if(v){var s=r(this);clearTimeout(f),f=setTimeout(function(){d.onColumnSearch(t,i.field,s.val())},d.options.searchTimeOut)}}),g.off("mouseup").on("mouseup",function(t){var s=r(this),w=s.val();""!==w&&setTimeout(function(){var x=s.val();""===x&&(clearTimeout(f),f=setTimeout(function(){d.onColumnSearch(t,i.field,x)},d.options.searchTimeOut))},1)});break;case"select":g.on("select2:select",function(s){d.onColumnSearch(s,i.field,r(this).val())}),g.on("select2:unselecting",function(t){var s=r(this);t.preventDefault(),s.val(null).trigger("change"),d.searchText=void 0,d.onColumnSearch(t,i.field,s.val())})}e.append(g)}}else{e=r('<div class="no-filter"></div>')}r.each(c.children().children(),function(s,t){return t=r(t),t.data("field")===i.field?(t.find(".fht-cell").append(e),!1):void 0})}}),b||c.find(".filter").hide()}function n(b){var a=q(b);r.each(b.columns,function(f,e){if(e.filter&&"select"===e.filter.type){var d=a.find('select[data-filter-field="'+e.field+'"]');if(d.length>0&&!d.data().select2){var c={placeholder:"",allowClear:!0,data:e.filter.data,dropdownParent:b.$el.closest(".bootstrap-table")};d.select2(c)}}})}r.extend(r.fn.bootstrapTable.defaults,{filter:!1,filterValues:{},filterTemplate:{input:function(b,a,c){return'<input type="text" class="form-control" data-filter-field="'+a.field+'" style="width: 100%; visibility:'+c+'">'},select:function(b,a,c){return'<select data-filter-field="'+a.field+'" style="width: 100%; visibility:'+c+'"></select>'}},onColumnSearch:function(){return !1}}),r.extend(r.fn.bootstrapTable.COLUMN_DEFAULTS,{filter:void 0}),r.extend(r.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"});var m=r.fn.bootstrapTable.Constructor,l=m.prototype.init,k=m.prototype.initHeader,j=m.prototype.initSearch;m.prototype.init=function(){if(this.options.filter){var a=this;a.options.filterTemplate&&(a.options.filterTemplate=r.extend({},r.fn.bootstrapTable.defaults.filterTemplate,a.options.filterTemplate)),r.isEmptyObject(a.options.filterValues)||(a.filterColumnsPartial=a.options.filterValues,a.options.filterValues={}),this.$el.on("reset-view.bs.table",function(){a.options.height&&(a.$tableHeader.find("select").length>0||a.$tableHeader.find("input").length>0||o(a,a.$tableHeader))}).on("post-header.bs.table",function(){var b=0;n(a),clearTimeout(b),b=setTimeout(function(){p(a)},a.options.searchTimeOut-1000)}).on("column-switch.bs.table",function(){p(a)})}l.apply(this,Array.prototype.slice.apply(arguments))},m.prototype.initHeader=function(){k.apply(this,Array.prototype.slice.apply(arguments)),this.options.filter&&o(this,this.$header)},m.prototype.initSearch=function(){var b=this,a=b.filterColumnsPartial;"client"===b.options.sidePagination&&(this.data=r.grep(this.data,function(c,h){for(var g in a){var f=b.columns[b.fieldsColumnsIndex[g]],e=a[g].toLowerCase(),d=c[g];if(d=r.fn.bootstrapTable.utils.calculateObjectValue(b.header,b.header.formatters[r.inArray(g,b.header.fields)],[d,c,h],d),f.filterStrictSearch){if(-1===r.inArray(g,b.header.fields)||"string"!=typeof d&&"number"!=typeof d||d.toString().toLowerCase()!==e.toString().toLowerCase()){return !1}}else{if(-1===r.inArray(g,b.header.fields)||"string"!=typeof d&&"number"!=typeof d||-1===(d+"").toLowerCase().indexOf(e)){return !1}}}return !0})),j.apply(this,Array.prototype.slice.apply(arguments))},m.prototype.onColumnSearch=function(c,b,a){r.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),a?this.filterColumnsPartial[b]=a:delete this.filterColumnsPartial[b],this.options.pageNumber=1,this.onSearch(c),this.trigger("column-search",b,a)},m.prototype.setSelect2Data=function(e,b){var a=this,d=q(a),c=d.find('select[data-filter-field="'+e+'"]');c.empty(),c.select2({data:b,placeholder:"",allowClear:!0,dropdownParent:a.$el.closest(".bootstrap-table")}),r.each(this.columns,function(g,f){return f.field===e?(f.filter.data=b,!1):void 0})},m.prototype.setFilterValues=function(a){this.filterColumnsPartial=a},r.fn.bootstrapTable.methods.push("setSelect2Data"),r.fn.bootstrapTable.methods.push("setFilterValues")}(jQuery);