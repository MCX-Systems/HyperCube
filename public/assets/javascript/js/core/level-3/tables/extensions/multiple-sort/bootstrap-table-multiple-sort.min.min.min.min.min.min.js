!function(f){var j=!1,i=function(d){var b=d.sortModalSelector,k="#"+b;if(!f(k).hasClass("modal")){var e='  <div class="modal fade" id="'+b+'" tabindex="-1" role="dialog" aria-labelledby="'+b+'Label" aria-hidden="true">';e+='         <div class="modal-dialog">',e+='             <div class="modal-content">',e+='                 <div class="modal-header">',e+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',e+='                     <h4 class="modal-title" id="'+b+'Label">'+d.options.formatMultipleSort()+"</h4>",e+="                 </div>",e+='                 <div class="modal-body">',e+='                     <div class="bootstrap-table">',e+='                         <div class="fixed-table-toolbar">',e+='                             <div class="bars">',e+='                                 <div id="toolbar">',e+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+d.options.iconsPrefix+" "+d.options.icons.plus+'"></i> '+d.options.formatAddLevel()+"</button>",e+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+d.options.iconsPrefix+" "+d.options.icons.minus+'"></i> '+d.options.formatDeleteLevel()+"</button>",e+="                                 </div>",e+="                             </div>",e+="                         </div>",e+='                         <div class="fixed-table-container">',e+='                             <table id="multi-sort" class="table">',e+="                                 <thead>",e+="                                     <tr>",e+="                                         <th></th>",e+='                                         <th><div class="th-inner">'+d.options.formatColumn()+"</div></th>",e+='                                         <th><div class="th-inner">'+d.options.formatOrder()+"</div></th>",e+="                                     </tr>",e+="                                 </thead>",e+="                                 <tbody></tbody>",e+="                             </table>",e+="                         </div>",e+="                     </div>",e+="                 </div>",e+='                 <div class="modal-footer">',e+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+d.options.formatCancel()+"</button>",e+='                     <button type="button" class="btn btn-primary">'+d.options.formatSort()+"</button>",e+="                 </div>",e+="             </div>",e+="         </div>",e+="     </div>",f("body").append(f(e)),d.$sortModal=f(k);var c=d.$sortModal.find("tbody > tr");if(d.$sortModal.off("click","#add").on("click","#add",function(){var m=d.$sortModal.find(".multi-sort-name:first option").length,l=d.$sortModal.find("tbody tr").length;m>l&&(l++,d.addLevel(),d.setButtonStates())}),d.$sortModal.off("click","#delete").on("click","#delete",function(){var m=d.$sortModal.find(".multi-sort-name:first option").length,l=d.$sortModal.find("tbody tr").length;l>1&&m>=l&&(l--,d.$sortModal.find("tbody tr:last").remove(),d.setButtonStates())}),d.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var t=d.$sortModal.find("tbody > tr"),q=d.$sortModal.find("div.alert"),s=[],p=[];d.options.sortPriority=f.map(t,function(u){var n=f(u),m=n.find(".multi-sort-name").val(),v=n.find(".multi-sort-order").val();return s.push(m),{sortName:m,sortOrder:v}});for(var l=s.sort(),r=0;r<s.length-1;r++){l[r+1]==l[r]&&p.push(l[r])}if(p.length>0){0===q.length&&(q='<div class="alert alert-danger" role="alert"><strong>'+d.options.formatDuplicateAlertTitle()+"</strong> "+d.options.formatDuplicateAlertDescription()+"</div>",f(q).insertBefore(d.$sortModal.find(".bars")))}else{if(1===q.length&&f(q).remove(),d.$sortModal.modal("hide"),d.options.sortName="","server"===d.options.sidePagination){var o=d.options.queryParams;return d.options.queryParams=function(m){return m.multiSort=d.options.sortPriority,o(m)},j=!1,void d.initServer(d.options.silentSort)}d.onMultipleSort()}}),(null===d.options.sortPriority||0===d.options.sortPriority.length)&&d.options.sortName&&(d.options.sortPriority=[{sortName:d.options.sortName,sortOrder:d.options.sortOrder}]),null!==d.options.sortPriority&&d.options.sortPriority.length>0){if(c.length<d.options.sortPriority.length&&"object"==typeof d.options.sortPriority){for(var a=0;a<d.options.sortPriority.length;a++){d.addLevel(a,d.options.sortPriority[a])}}}else{d.addLevel(0)}d.setButtonStates()}};f.fn.bootstrapTable.methods.push("multipleSort"),f.extend(f.fn.bootstrapTable.defaults,{showMultiSort:!1,showMultiSortButton:!0,sortPriority:null,onMultipleSort:function(){return !1}}),f.extend(f.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"}),f.extend(f.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"}),f.extend(f.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."},formatSortOrders:function(){return{asc:"Ascending",desc:"Descending"}}}),f.extend(f.fn.bootstrapTable.defaults,f.fn.bootstrapTable.locales);var h=f.fn.bootstrapTable.Constructor,g=h.prototype.initToolbar;h.prototype.initToolbar=function(){this.showToolbar=this.showToolbar||this.options.showMultiSort;var b=this,a="sortModal_"+this.$el.attr("id"),k="#"+a;if(this.$sortModal=f(k),this.sortModalSelector=a,g.apply(this,Array.prototype.slice.apply(arguments)),"server"===b.options.sidePagination&&!j&&null!==b.options.sortPriority){var e=b.options.queryParams;b.options.queryParams=function(l){return l.multiSort=b.options.sortPriority,e(l)}}if(this.options.showMultiSort){var d=this.$toolbar.find(">.btn-group").first(),c=this.$toolbar.find("div.multi-sort");!c.length&&this.options.showMultiSortButton&&(c='  <button class="multi-sort btn btn-default'+(void 0===this.options.iconSize?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+k+'" title="'+this.options.formatMultipleSort()+'">',c+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"></i>',c+="</button>",d.append(c),i(b)),this.$el.on("sort.bs.table",function(){j=!0}),this.$el.on("multiple-sort.bs.table",function(){j=!1}),this.$el.on("load-success.bs.table",function(){j||null===b.options.sortPriority||"object"!=typeof b.options.sortPriority||"server"===b.options.sidePagination||b.onMultipleSort()}),this.$el.on("column-switch.bs.table",function(m,l){for(var n=0;n<b.options.sortPriority.length;n++){b.options.sortPriority[n].sortName===l&&b.options.sortPriority.splice(n,1)}b.assignSortableArrows(),b.$sortModal.remove(),i(b)}),this.$el.on("reset-view.bs.table",function(){j||null===b.options.sortPriority||"object"!=typeof b.options.sortPriority||b.assignSortableArrows()})}},h.prototype.multipleSort=function(){var a=this;j||null===a.options.sortPriority||"object"!=typeof a.options.sortPriority||"server"===a.options.sidePagination||a.onMultipleSort()},h.prototype.onMultipleSort=function(){var a=this,c=function(e,d){return e>d?1:d>e?-1:0},b=function(e,p){for(var m=[],q=[],o=0;o<a.options.sortPriority.length;o++){var n="desc"===a.options.sortPriority[o].sortOrder?-1:1,l=e[a.options.sortPriority[o].sortName],d=p[a.options.sortPriority[o].sortName];(void 0===l||null===l)&&(l=""),(void 0===d||null===d)&&(d=""),f.isNumeric(l)&&f.isNumeric(d)&&(l=parseFloat(l),d=parseFloat(d)),"string"!=typeof l&&(l=l.toString()),m.push(n*c(l,d)),q.push(n*c(d,l))}return c(m,q)};this.data.sort(function(e,d){return b(e,d)}),this.initBody(),this.assignSortableArrows(),this.trigger("multiple-sort")},h.prototype.addLevel=function(a,d){var c=0===a?this.options.formatSortBy():this.options.formatThenBy();this.$sortModal.find("tbody").append(f("<tr>").append(f("<td>").text(c)).append(f("<td>").append(f('<select class="form-control multi-sort-name">'))).append(f("<td>").append(f('<select class="form-control multi-sort-order">'))));var b=this.$sortModal.find(".multi-sort-name").last(),e=this.$sortModal.find(".multi-sort-order").last();f.each(this.columns,function(m,n){return n.sortable===!1||n.visible===!1?!0:void b.append('<option value="'+n.field+'">'+n.title+"</option>")}),f.each(this.options.formatSortOrders(),function(m,n){e.append('<option value="'+m+'">'+n+"</option>")}),void 0!==d&&(b.find('option[value="'+d.sortName+'"]').attr("selected",!0),e.find('option[value="'+d.sortOrder+'"]').attr("selected",!0))},h.prototype.assignSortableArrows=function(){for(var d=this,b=d.$header.find("th"),a=0;a<b.length;a++){for(var c=0;c<d.options.sortPriority.length;c++){f(b[a]).data("field")===d.options.sortPriority[c].sortName&&f(b[a]).find(".sortable").removeClass("desc asc").addClass(d.options.sortPriority[c].sortOrder)}}},h.prototype.setButtonStates=function(){var b=this.$sortModal.find(".multi-sort-name:first option").length,a=this.$sortModal.find("tbody tr").length;a==b&&this.$sortModal.find("#add").attr("disabled","disabled"),a>1&&this.$sortModal.find("#delete").removeAttr("disabled"),b>a&&this.$sortModal.find("#add").removeAttr("disabled"),1==a&&this.$sortModal.find("#delete").attr("disabled","disabled")}}(jQuery);