(function(f){var i=false;var j=function(e){var l=e.sortModalSelector,a="#"+l;if(!f(a).hasClass("modal")){var d='  <div class="modal fade" id="'+l+'" tabindex="-1" role="dialog" aria-labelledby="'+l+'Label" aria-hidden="true">';d+='         <div class="modal-dialog">';d+='             <div class="modal-content">';d+='                 <div class="modal-header">';d+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';d+='                     <h4 class="modal-title" id="'+l+'Label">'+e.options.formatMultipleSort()+"</h4>";d+="                 </div>";d+='                 <div class="modal-body">';d+='                     <div class="bootstrap-table">';d+='                         <div class="fixed-table-toolbar">';d+='                             <div class="bars">';d+='                                 <div id="toolbar">';d+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+e.options.iconsPrefix+" "+e.options.icons.plus+'"></i> '+e.options.formatAddLevel()+"</button>";d+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+e.options.iconsPrefix+" "+e.options.icons.minus+'"></i> '+e.options.formatDeleteLevel()+"</button>";d+="                                 </div>";d+="                             </div>";d+="                         </div>";d+='                         <div class="fixed-table-container">';d+='                             <table id="multi-sort" class="table">';d+="                                 <thead>";d+="                                     <tr>";d+="                                         <th></th>";d+='                                         <th><div class="th-inner">'+e.options.formatColumn()+"</div></th>";d+='                                         <th><div class="th-inner">'+e.options.formatOrder()+"</div></th>";d+="                                     </tr>";d+="                                 </thead>";d+="                                 <tbody></tbody>";d+="                             </table>";d+="                         </div>";d+="                     </div>";d+="                 </div>";d+='                 <div class="modal-footer">';d+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+e.options.formatCancel()+"</button>";d+='                     <button type="button" class="btn btn-primary">'+e.options.formatSort()+"</button>";d+="                 </div>";d+="             </div>";d+="         </div>";d+="     </div>";f("body").append(f(d));e.$sortModal=f(a);var c=e.$sortModal.find("tbody > tr");e.$sortModal.off("click","#add").on("click","#add",function(){var k=e.$sortModal.find(".multi-sort-name:first option").length,o=e.$sortModal.find("tbody tr").length;if(o<k){o++;e.addLevel();e.setButtonStates()}});e.$sortModal.off("click","#delete").on("click","#delete",function(){var k=e.$sortModal.find(".multi-sort-name:first option").length,o=e.$sortModal.find("tbody tr").length;if(o>1&&o<=k){o--;e.$sortModal.find("tbody tr:last").remove();e.setButtonStates()}});e.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var k=e.$sortModal.find("tbody > tr"),t=e.$sortModal.find("div.alert"),v=[],u=[];e.options.sortPriority=f.map(k,function(n){var m=f(n),o=m.find(".multi-sort-name").val(),p=m.find(".multi-sort-order").val();v.push(o);return{sortName:o,sortOrder:p}});var x=v.sort();for(var w=0;w<v.length-1;w++){if(x[w+1]==x[w]){u.push(x[w])}}if(u.length>0){if(t.length===0){t='<div class="alert alert-danger" role="alert"><strong>'+e.options.formatDuplicateAlertTitle()+"</strong> "+e.options.formatDuplicateAlertDescription()+"</div>";f(t).insertBefore(e.$sortModal.find(".bars"))}}else{if(t.length===1){f(t).remove()}e.$sortModal.modal("hide");e.options.sortName="";if(e.options.sidePagination==="server"){var y=e.options.queryParams;e.options.queryParams=function(m){m.multiSort=e.options.sortPriority;return y(m)};i=false;e.initServer(e.options.silentSort);return}e.onMultipleSort()}});if(e.options.sortPriority===null||e.options.sortPriority.length===0){if(e.options.sortName){e.options.sortPriority=[{sortName:e.options.sortName,sortOrder:e.options.sortOrder}]}}if(e.options.sortPriority!==null&&e.options.sortPriority.length>0){if(c.length<e.options.sortPriority.length&&typeof e.options.sortPriority==="object"){for(var b=0;b<e.options.sortPriority.length;b++){e.addLevel(b,e.options.sortPriority[b])}}}else{e.addLevel(0)}e.setButtonStates()}};f.fn.bootstrapTable.methods.push("multipleSort");f.extend(f.fn.bootstrapTable.defaults,{showMultiSort:false,showMultiSortButton:true,sortPriority:null,onMultipleSort:function(){return false}});f.extend(f.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"});f.extend(f.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"});f.extend(f.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."},formatSortOrders:function(){return{asc:"Ascending",desc:"Descending"}}});f.extend(f.fn.bootstrapTable.defaults,f.fn.bootstrapTable.locales);var h=f.fn.bootstrapTable.Constructor,g=h.prototype.initToolbar;h.prototype.initToolbar=function(){this.showToolbar=this.showToolbar||this.options.showMultiSort;var a=this,d="sortModal_"+this.$el.attr("id"),e="#"+d;this.$sortModal=f(e);this.sortModalSelector=d;g.apply(this,Array.prototype.slice.apply(arguments));if(a.options.sidePagination==="server"&&!i&&a.options.sortPriority!==null){var c=a.options.queryParams;a.options.queryParams=function(k){k.multiSort=a.options.sortPriority;return c(k)}}if(this.options.showMultiSort){var l=this.$toolbar.find(">.btn-group").first(),b=this.$toolbar.find("div.multi-sort");if(!b.length&&this.options.showMultiSortButton){b='  <button class="multi-sort btn btn-default'+(this.options.iconSize===undefined?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+e+'" title="'+this.options.formatMultipleSort()+'">';b+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"></i>';b+="</button>";l.append(b);j(a)}this.$el.on("sort.bs.table",function(){i=true});this.$el.on("multiple-sort.bs.table",function(){i=false});this.$el.on("load-success.bs.table",function(){if(!i&&a.options.sortPriority!==null&&typeof a.options.sortPriority==="object"&&a.options.sidePagination!=="server"){a.onMultipleSort()}});this.$el.on("column-switch.bs.table",function(k,o){for(var p=0;p<a.options.sortPriority.length;p++){if(a.options.sortPriority[p].sortName===o){a.options.sortPriority.splice(p,1)}}a.assignSortableArrows();a.$sortModal.remove();j(a)});this.$el.on("reset-view.bs.table",function(){if(!i&&a.options.sortPriority!==null&&typeof a.options.sortPriority==="object"){a.assignSortableArrows()}})}};h.prototype.multipleSort=function(){var a=this;if(!i&&a.options.sortPriority!==null&&typeof a.options.sortPriority==="object"&&a.options.sidePagination!=="server"){a.onMultipleSort()}};h.prototype.onMultipleSort=function(){var c=this;var a=function(e,d){return e>d?1:e<d?-1:0};var b=function(u,v){var s=[],t=[];for(var r=0;r<c.options.sortPriority.length;r++){var d=c.options.sortPriority[r].sortOrder==="desc"?-1:1,q=u[c.options.sortPriority[r].sortName],e=v[c.options.sortPriority[r].sortName];if(q===undefined||q===null){q=""}if(e===undefined||e===null){e=""}if(f.isNumeric(q)&&f.isNumeric(e)){q=parseFloat(q);e=parseFloat(e)}if(typeof q!=="string"){q=q.toString()}s.push(d*a(q,e));t.push(d*a(e,q))}return a(s,t)};this.data.sort(function(d,e){return b(d,e)});this.initBody();this.assignSortableArrows();this.trigger("multiple-sort")};h.prototype.addLevel=function(b,a){var d=b===0?this.options.formatSortBy():this.options.formatThenBy();this.$sortModal.find("tbody").append(f("<tr>").append(f("<td>").text(d)).append(f("<td>").append(f('<select class="form-control multi-sort-name">'))).append(f("<td>").append(f('<select class="form-control multi-sort-order">'))));var e=this.$sortModal.find(".multi-sort-name").last(),c=this.$sortModal.find(".multi-sort-order").last();f.each(this.columns,function(m,n){if(n.sortable===false||n.visible===false){return true}e.append('<option value="'+n.field+'">'+n.title+"</option>")});f.each(this.options.formatSortOrders(),function(n,m){c.append('<option value="'+n+'">'+m+"</option>")});if(a!==undefined){e.find('option[value="'+a.sortName+'"]').attr("selected",true);c.find('option[value="'+a.sortOrder+'"]').attr("selected",true)}};h.prototype.assignSortableArrows=function(){var a=this,d=a.$header.find("th");for(var b=0;b<d.length;b++){for(var c=0;c<a.options.sortPriority.length;c++){if(f(d[b]).data("field")===a.options.sortPriority[c].sortName){f(d[b]).find(".sortable").removeClass("desc asc").addClass(a.options.sortPriority[c].sortOrder)}}}};h.prototype.setButtonStates=function(){var b=this.$sortModal.find(".multi-sort-name:first option").length,a=this.$sortModal.find("tbody tr").length;if(a==b){this.$sortModal.find("#add").attr("disabled","disabled")}if(a>1){this.$sortModal.find("#delete").removeAttr("disabled")}if(a<b){this.$sortModal.find("#add").removeAttr("disabled")}if(a==1){this.$sortModal.find("#delete").attr("disabled","disabled")}}})(jQuery);