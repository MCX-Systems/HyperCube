!function(b){var c=!1,d=function(h){var j=h.sortModalSelector,f="#"+j;if(!b(f).hasClass("modal")){var g='  <div class="modal fade" id="'+j+'" tabindex="-1" role="dialog" aria-labelledby="'+j+'Label" aria-hidden="true">';g+='         <div class="modal-dialog">',g+='             <div class="modal-content">',g+='                 <div class="modal-header">',g+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',g+='                     <h4 class="modal-title" id="'+j+'Label">'+h.options.formatMultipleSort()+"</h4>",g+="                 </div>",g+='                 <div class="modal-body">',g+='                     <div class="bootstrap-table">',g+='                         <div class="fixed-table-toolbar">',g+='                             <div class="bars">',g+='                                 <div id="toolbar">',g+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+h.options.iconsPrefix+" "+h.options.icons.plus+'"></i> '+h.options.formatAddLevel()+"</button>",g+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+h.options.iconsPrefix+" "+h.options.icons.minus+'"></i> '+h.options.formatDeleteLevel()+"</button>",g+="                                 </div>",g+="                             </div>",g+="                         </div>",g+='                         <div class="fixed-table-container">',g+='                             <table id="multi-sort" class="table">',g+="                                 <thead>",g+="                                     <tr>",g+="                                         <th></th>",g+='                                         <th><div class="th-inner">'+h.options.formatColumn()+"</div></th>",g+='                                         <th><div class="th-inner">'+h.options.formatOrder()+"</div></th>",g+="                                     </tr>",g+="                                 </thead>",g+="                                 <tbody></tbody>",g+="                             </table>",g+="                         </div>",g+="                     </div>",g+="                 </div>",g+='                 <div class="modal-footer">',g+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+h.options.formatCancel()+"</button>",g+='                     <button type="button" class="btn btn-primary">'+h.options.formatSort()+"</button>",g+="                 </div>",g+="             </div>",g+="         </div>",g+="     </div>",b("body").append(b(g)),h.$sortModal=b(f);var i=h.$sortModal.find("tbody > tr");if(h.$sortModal.off("click","#add").on("click","#add",function(){var o=h.$sortModal.find(".multi-sort-name:first option").length,k=h.$sortModal.find("tbody tr").length;o>k&&(k++,h.addLevel(),h.setButtonStates())}),h.$sortModal.off("click","#delete").on("click","#delete",function(){var o=h.$sortModal.find(".multi-sort-name:first option").length,k=h.$sortModal.find("tbody tr").length;k>1&&o>=k&&(k--,h.$sortModal.find("tbody tr:last").remove(),h.setButtonStates())}),h.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var n=h.$sortModal.find("tbody > tr"),v=h.$sortModal.find("div.alert"),y=[],k=[];h.options.sortPriority=b.map(n,function(p){var q=b(p),r=q.find(".multi-sort-name").val(),o=q.find(".multi-sort-order").val();return y.push(r),{sortName:r,sortOrder:o}});for(var m=y.sort(),u=0;u<y.length-1;u++){m[u+1]==m[u]&&k.push(m[u])}if(k.length>0){0===v.length&&(v='<div class="alert alert-danger" role="alert"><strong>'+h.options.formatDuplicateAlertTitle()+"</strong> "+h.options.formatDuplicateAlertDescription()+"</div>",b(v).insertBefore(h.$sortModal.find(".bars")))}else{if(1===v.length&&b(v).remove(),h.$sortModal.modal("hide"),h.options.sortName="","server"===h.options.sidePagination){var w=h.options.queryParams;return h.options.queryParams=function(o){return o.multiSort=h.options.sortPriority,w(o)},c=!1,void h.initServer(h.options.silentSort)}h.onMultipleSort()}}),(null===h.options.sortPriority||0===h.options.sortPriority.length)&&h.options.sortName&&(h.options.sortPriority=[{sortName:h.options.sortName,sortOrder:h.options.sortOrder}]),null!==h.options.sortPriority&&h.options.sortPriority.length>0){if(i.length<h.options.sortPriority.length&&"object"==typeof h.options.sortPriority){for(var l=0;l<h.options.sortPriority.length;l++){h.addLevel(l,h.options.sortPriority[l])}}}else{h.addLevel(0)}h.setButtonStates()}};b.fn.bootstrapTable.methods.push("multipleSort"),b.extend(b.fn.bootstrapTable.defaults,{showMultiSort:!1,showMultiSortButton:!0,sortPriority:null,onMultipleSort:function(){return !1}}),b.extend(b.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"}),b.extend(b.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"}),b.extend(b.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."},formatSortOrders:function(){return{asc:"Ascending",desc:"Descending"}}}),b.extend(b.fn.bootstrapTable.defaults,b.fn.bootstrapTable.locales);var e=b.fn.bootstrapTable.Constructor,a=e.prototype.initToolbar;e.prototype.initToolbar=function(){this.showToolbar=this.showToolbar||this.options.showMultiSort;var j=this,l="sortModal_"+this.$el.attr("id"),f="#"+l;if(this.$sortModal=b(f),this.sortModalSelector=l,a.apply(this,Array.prototype.slice.apply(arguments)),"server"===j.options.sidePagination&&!c&&null!==j.options.sortPriority){var g=j.options.queryParams;j.options.queryParams=function(k){return k.multiSort=j.options.sortPriority,g(k)}}if(this.options.showMultiSort){var h=this.$toolbar.find(">.btn-group").first(),i=this.$toolbar.find("div.multi-sort");!i.length&&this.options.showMultiSortButton&&(i='  <button class="multi-sort btn btn-default'+(void 0===this.options.iconSize?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+f+'" title="'+this.options.formatMultipleSort()+'">',i+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"></i>',i+="</button>",h.append(i),d(j)),this.$el.on("sort.bs.table",function(){c=!0}),this.$el.on("multiple-sort.bs.table",function(){c=!1}),this.$el.on("load-success.bs.table",function(){c||null===j.options.sortPriority||"object"!=typeof j.options.sortPriority||"server"===j.options.sidePagination||j.onMultipleSort()}),this.$el.on("column-switch.bs.table",function(q,k){for(var o=0;o<j.options.sortPriority.length;o++){j.options.sortPriority[o].sortName===k&&j.options.sortPriority.splice(o,1)}j.assignSortableArrows(),j.$sortModal.remove(),d(j)}),this.$el.on("reset-view.bs.table",function(){c||null===j.options.sortPriority||"object"!=typeof j.options.sortPriority||j.assignSortableArrows()})}},e.prototype.multipleSort=function(){var f=this;c||null===f.options.sortPriority||"object"!=typeof f.options.sortPriority||"server"===f.options.sidePagination||f.onMultipleSort()},e.prototype.onMultipleSort=function(){var h=this,f=function(i,j){return i>j?1:j>i?-1:0},g=function(k,s){for(var u=[],r=[],i=0;i<h.options.sortPriority.length;i++){var t="desc"===h.options.sortPriority[i].sortOrder?-1:1,j=k[h.options.sortPriority[i].sortName],v=s[h.options.sortPriority[i].sortName];(void 0===j||null===j)&&(j=""),(void 0===v||null===v)&&(v=""),b.isNumeric(j)&&b.isNumeric(v)&&(j=parseFloat(j),v=parseFloat(v)),"string"!=typeof j&&(j=j.toString()),u.push(t*f(j,v)),r.push(t*f(v,j))}return f(u,r)};this.data.sort(function(i,j){return g(i,j)}),this.initBody(),this.assignSortableArrows(),this.trigger("multiple-sort")},e.prototype.addLevel=function(j,g){var h=0===j?this.options.formatSortBy():this.options.formatThenBy();this.$sortModal.find("tbody").append(b("<tr>").append(b("<td>").text(h)).append(b("<td>").append(b('<select class="form-control multi-sort-name">'))).append(b("<td>").append(b('<select class="form-control multi-sort-order">'))));var i=this.$sortModal.find(".multi-sort-name").last(),f=this.$sortModal.find(".multi-sort-order").last();b.each(this.columns,function(l,k){return k.sortable===!1||k.visible===!1?!0:void i.append('<option value="'+k.field+'">'+k.title+"</option>")}),b.each(this.options.formatSortOrders(),function(l,k){f.append('<option value="'+l+'">'+k+"</option>")}),void 0!==g&&(i.find('option[value="'+g.sortName+'"]').attr("selected",!0),f.find('option[value="'+g.sortOrder+'"]').attr("selected",!0))},e.prototype.assignSortableArrows=function(){for(var f=this,h=f.$header.find("th"),i=0;i<h.length;i++){for(var g=0;g<f.options.sortPriority.length;g++){b(h[i]).data("field")===f.options.sortPriority[g].sortName&&b(h[i]).find(".sortable").removeClass("desc asc").addClass(f.options.sortPriority[g].sortOrder)}}},e.prototype.setButtonStates=function(){var f=this.$sortModal.find(".multi-sort-name:first option").length,g=this.$sortModal.find("tbody tr").length;g==f&&this.$sortModal.find("#add").attr("disabled","disabled"),g>1&&this.$sortModal.find("#delete").removeAttr("disabled"),f>g&&this.$sortModal.find("#add").removeAttr("disabled"),1==g&&this.$sortModal.find("#delete").attr("disabled","disabled")}}(jQuery);