!function(r){function q(d){var c=d.$header;return d.options.height&&(c=d.$tableHeader),c}function p(b){if(!r.isEmptyObject(b.filterColumnsPartial)){var a=q(b);r.each(b.columns,function(d,c){var s=b.filterColumnsPartial[c.field];if(c.filter){if(c.filter.setFilterValue){var i=a.find("[data-field="+c.field+"] .filter");c.filter.setFilterValue(i,c.field,s)}else{var h=a.find("[data-filter-field="+c.field+"]");switch(c.filter.type){case"input":h.val(s);case"select":h.val(s).trigger("change")}}}})}}function o(a,u){var t,s,i=!1,h=0;r.each(a.columns,function(f,e){if(t="hidden",s=null,e.visible){if(e.filter){var d=e.filter["class"]?" "+e.filter["class"]:"";if(s=r('<div style="margin: 0px 2px 2px 2px;" class="filter'+d+'">'),e.searchable&&(i=!0,t="visible"),e.filter.template){s.append(e.filter.template(a,e,t))}else{var c=r(a.options.filterTemplate[e.filter.type.toLowerCase()](a,e,t));switch(e.filter.type){case"input":var b=!0;c.off("compositionstart").on("compositionstart",function(){b=!1}),c.off("compositionend").on("compositionend",function(v){b=!0;var g=r(this);clearTimeout(h),h=setTimeout(function(){a.onColumnSearch(v,e.field,g.val())},a.options.searchTimeOut)}),c.off("keyup").on("keyup",function(v){if(b){var g=r(this);clearTimeout(h),h=setTimeout(function(){a.onColumnSearch(v,e.field,g.val())},a.options.searchTimeOut)}}),c.off("mouseup").on("mouseup",function(w){var v=r(this),g=v.val();""!==g&&setTimeout(function(){var x=v.val();""===x&&(clearTimeout(h),h=setTimeout(function(){a.onColumnSearch(w,e.field,x)},a.options.searchTimeOut))},1)});break;case"select":c.on("select2:select",function(g){a.onColumnSearch(g,e.field,r(this).val())}),c.on("select2:unselecting",function(v){var g=r(this);v.preventDefault(),g.val(null).trigger("change"),a.searchText=void 0,a.onColumnSearch(v,e.field,g.val())})}s.append(c)}}else{s=r('<div class="no-filter"></div>')}r.each(u.children().children(),function(g,v){return v=r(v),v.data("field")===e.field?(v.find(".fht-cell").append(s),!1):void 0})}}),i||u.find(".filter").hide()}function n(b){var a=q(b);r.each(b.columns,function(d,c){if(c.filter&&"select"===c.filter.type){var h=a.find('select[data-filter-field="'+c.field+'"]');if(h.length>0&&!h.data().select2){var g={placeholder:"",allowClear:!0,data:c.filter.data,dropdownParent:b.$el.closest(".bootstrap-table")};h.select2(g)}}})}r.extend(r.fn.bootstrapTable.defaults,{filter:!1,filterValues:{},filterTemplate:{input:function(e,d,f){return'<input type="text" class="form-control" data-filter-field="'+d.field+'" style="width: 100%; visibility:'+f+'">'},select:function(e,d,f){return'<select data-filter-field="'+d.field+'" style="width: 100%; visibility:'+f+'"></select>'}},onColumnSearch:function(){return !1}}),r.extend(r.fn.bootstrapTable.COLUMN_DEFAULTS,{filter:void 0}),r.extend(r.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"});var m=r.fn.bootstrapTable.Constructor,l=m.prototype.init,k=m.prototype.initHeader,j=m.prototype.initSearch;m.prototype.init=function(){if(this.options.filter){var a=this;a.options.filterTemplate&&(a.options.filterTemplate=r.extend({},r.fn.bootstrapTable.defaults.filterTemplate,a.options.filterTemplate)),r.isEmptyObject(a.options.filterValues)||(a.filterColumnsPartial=a.options.filterValues,a.options.filterValues={}),this.$el.on("reset-view.bs.table",function(){a.options.height&&(a.$tableHeader.find("select").length>0||a.$tableHeader.find("input").length>0||o(a,a.$tableHeader))}).on("post-header.bs.table",function(){var b=0;n(a),clearTimeout(b),b=setTimeout(function(){p(a)},a.options.searchTimeOut-1000)}).on("column-switch.bs.table",function(){p(a)})}l.apply(this,Array.prototype.slice.apply(arguments))},m.prototype.initHeader=function(){k.apply(this,Array.prototype.slice.apply(arguments)),this.options.filter&&o(this,this.$header)},m.prototype.initSearch=function(){var a=this,d=a.filterColumnsPartial;"client"===a.options.sidePagination&&(this.data=r.grep(this.data,function(v,u){for(var t in d){var s=a.columns[a.fieldsColumnsIndex[t]],c=d[t].toLowerCase(),b=v[t];if(b=r.fn.bootstrapTable.utils.calculateObjectValue(a.header,a.header.formatters[r.inArray(t,a.header.fields)],[b,v,u],b),s.filterStrictSearch){if(-1===r.inArray(t,a.header.fields)||"string"!=typeof b&&"number"!=typeof b||b.toString().toLowerCase()!==c.toString().toLowerCase()){return !1}}else{if(-1===r.inArray(t,a.header.fields)||"string"!=typeof b&&"number"!=typeof b||-1===(b+"").toLowerCase().indexOf(c)){return !1}}}return !0})),j.apply(this,Array.prototype.slice.apply(arguments))},m.prototype.onColumnSearch=function(a,f,e){r.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),e?this.filterColumnsPartial[f]=e:delete this.filterColumnsPartial[f],this.options.pageNumber=1,this.onSearch(a),this.trigger("column-search",f,e)},m.prototype.setSelect2Data=function(s,i){var h=this,b=q(h),a=b.find('select[data-filter-field="'+s+'"]');a.empty(),a.select2({data:i,placeholder:"",allowClear:!0,dropdownParent:h.$el.closest(".bootstrap-table")}),r.each(this.columns,function(d,c){return c.field===s?(c.filter.data=i,!1):void 0})},m.prototype.setFilterValues=function(b){this.filterColumnsPartial=b},r.fn.bootstrapTable.methods.push("setSelect2Data"),r.fn.bootstrapTable.methods.push("setFilterValues")}(jQuery);