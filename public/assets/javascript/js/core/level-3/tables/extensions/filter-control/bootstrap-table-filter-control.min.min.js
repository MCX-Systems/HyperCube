(function(X){var O=X.fn.bootstrapTable.utils.sprintf,N=X.fn.bootstrapTable.utils.objectKeys;var aa=function(a){return a.get(a.length-1).options};var W=function(b,a){var d=aa(b);for(var c=0;c<d.length;c++){if(d[c].value!==""){if(!a.hasOwnProperty(d[c].value)){b.find(O("option[value='%s']",d[c].value)).hide()}else{b.find(O("option[value='%s']",d[c].value)).show()}}}};var Q=function(b,c,a){c=X.trim(c);b=X(b.get(b.length-1));if(!F(b,c)){b.append(X("<option></option>").attr("value",c).text(X("<div />").html(a).text()))}};var ae=function(a){a=X(a.get(a.length-1));var b=a.find("option:gt(0)");b.sort(function(c,d){c=X(c).text().toLowerCase();d=X(d).text().toLowerCase();if(X.isNumeric(c)&&X.isNumeric(d)){c=parseFloat(c);d=parseFloat(d)}return c>d?1:c<d?-1:0});a.find("option:gt(0)").remove();a.append(b)};var F=function(a,b){var d=aa(a);for(var c=0;c<d.length;c++){if(d[c].value===b.toString()){return true}}return false};var G=function(a){a.$tableHeader.css("height","77px")};var Y=function(b){var a=b.$header;if(b.options.height){a=b.$tableHeader}return a};var V=function(b){var a="select, input";if(b.options.height){a="table select, table input"}return a};var T=function(b){if(X.fn.bootstrapTable.utils.isIEBrowser()){if(X(b).is("input[type=text]")){var a=0;if("selectionStart" in b){a=b.selectionStart}else{if("selection" in document){b.focus();var d=document.selection.createRange();var c=document.selection.createRange().text.length;d.moveStart("character",-b.value.length);a=d.text.length-c}}return a}else{return -1}}else{return -1}};var D=function(a){X(a).val(a.value)};var K=function(c){var a=Y(c),b=V(c);c.options.valuesFilterControl=[];a.find(b).each(function(){c.options.valuesFilterControl.push({field:X(this).closest("[data-field]").data("field"),value:X(this).val(),position:T(X(this).get(0))})})};var E=function(d){var c=null,e=[],a=Y(d),b=V(d);if(d.options.valuesFilterControl.length>0){a.find(b).each(function(g,f){c=X(this).closest("[data-field]").data("field");e=X.grep(d.options.valuesFilterControl,function(h){return h.field===c});if(e.length>0){X(this).val(e[0].value);D(X(this).get(0),e[0].position)}})}};var M=function H(){var a=[],b=document.cookie.match(/(?:bs.table.)(\w*)/g);if(b){X.each(b,function(c,d){if(/./.test(d)){d=d.split(".").pop()}if(X.inArray(d,a)===-1){a.push(d)}});return a}};var ab=function(c){var b=c.data,d=c.pageTo<c.options.data.length?c.options.data.length:c.pageTo,e=function(h){return h.filterControl&&h.filterControl.toLowerCase()==="select"&&h.searchable},g=function(h){return h.filterData===undefined||h.filterData.toLowerCase()==="column"},f=function(h){return h&&h.length>0};var a=c.options.pagination?(c.options.sidePagination==="server"?c.pageTo:c.options.totalRows):c.pageTo;X.each(c.header.fields,function(n,i){var o=c.columns[c.fieldsColumnsIndex[i]],k=X(".bootstrap-table-filter-control-"+L(o.field));if(e(o)&&g(o)&&f(k)){if(k.get(k.length-1).options.length===0){Q(k,"","")}var j={};for(var l=0;l<a;l++){var p=b[l][i],m=X.fn.bootstrapTable.utils.calculateObjectValue(c.header,c.header.formatters[n],[p,b[l],l],p);j[m]=p}for(var h in j){Q(k,j[h],h)}ae(k);if(c.options.hideUnusedSelectOptions){W(k,j)}}})};var L=function(a){return String(a).replace(/(:|\.|\[|\]|,)/g,"\\$1")};var J=function(c,a){var b=false,e,d;X.each(c.columns,function(m,l){e="hidden";d=[];if(!l.visible){return}if(!l.filterControl){d.push('<div class="no-filter-control"></div>')}else{d.push('<div class="filter-control">');var j=l.filterControl.toLowerCase();if(l.searchable&&c.options.filterTemplate[j]){b=true;e="visible";d.push(c.options.filterTemplate[j](c,l.field,e,l.filterControlPlaceholder?l.filterControlPlaceholder:"","filter-control-"+m))}}X.each(a.children().children(),function(o,n){n=X(n);if(n.data("field")===l.field){n.find(".fht-cell").append(d.join(""));return false}});if(l.filterData!==undefined&&l.filterData.toLowerCase()!=="column"){var h=ac(Z,l.filterData.substring(0,l.filterData.indexOf(":")));var i,k;if(h!==null){i=l.filterData.substring(l.filterData.indexOf(":")+1,l.filterData.length);k=X(".bootstrap-table-filter-control-"+L(l.field));Q(k,"","");h(i,k)}else{throw new SyntaxError('Error. You should use any of these allowed filter data methods: var, json, url. Use like this: var: {key: "value"}')}var g,f;switch(h){case"url":X.ajax({url:i,dataType:"json",success:function(n){for(var o in n){Q(k,o,n[o])}ae(k)}});break;case"var":g=window[i];for(f in g){Q(k,f,g[f])}ae(k);break;case"jso":g=JSON.parse(i);for(f in g){Q(k,f,g[f])}ae(k);break}}});if(b){a.off("keyup","input").on("keyup","input",function(f){if(c.options.searchOnEnterKey&&f.keyCode!==13){return}if(X.inArray(f.keyCode,[37,38,39,40])>-1){return}clearTimeout(f.currentTarget.timeoutId||0);f.currentTarget.timeoutId=setTimeout(function(){c.onColumnSearch(f)},c.options.searchTimeOut)});a.off("change","select").on("change","select",function(f){if(c.options.searchOnEnterKey&&f.keyCode!==13){return}if(X.inArray(f.keyCode,[37,38,39,40])>-1){return}clearTimeout(f.currentTarget.timeoutId||0);f.currentTarget.timeoutId=setTimeout(function(){c.onColumnSearch(f)},c.options.searchTimeOut)});a.off("mouseup","input").on("mouseup","input",function(g){var f=X(this),h=f.val();if(h===""){return}setTimeout(function(){var i=f.val();if(i===""){clearTimeout(g.currentTarget.timeoutId||0);g.currentTarget.timeoutId=setTimeout(function(){c.onColumnSearch(g)},c.options.searchTimeOut)}},1)});if(a.find(".date-filter-control").length>0){X.each(c.columns,function(g,f){if(f.filterControl!==undefined&&f.filterControl.toLowerCase()==="datepicker"){a.find(".date-filter-control.bootstrap-table-filter-control-"+f.field).datepicker(f.filterDatepickerOptions).on("changeDate",function(h){X(O("#%s",h.currentTarget.id)).val(h.currentTarget.value);X(h.currentTarget).keyup()})}})}}else{a.find(".filterControl").hide()}};var U=function(a){a=a===undefined?"left":a.toLowerCase();switch(a){case"left":return"ltr";case"right":return"rtl";case"auto":return"auto";default:return"ltr"}};var Z={"var":function(d,a){var c=window[d];for(var b in c){Q(a,b,c[b])}ae(a)},url:function(b,a){X.ajax({url:b,dataType:"json",success:function(c){for(var d in c){Q(a,d,c[d])}ae(a)}})},json:function(d,a){var c=JSON.parse(d);for(var b in c){Q(a,b,c[b])}ae(a)}};var ac=function(a,d){var b=Object.keys(a);for(var c=0;c<b.length;c++){if(b[c]===d){return a[d]}}return null};X.extend(X.fn.bootstrapTable.defaults,{filterControl:false,onColumnSearch:function(b,a){return false},filterShowClear:false,alignmentSelectControlOptions:undefined,filterTemplate:{input:function(c,b,d,a){return O('<input type="text" class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" placeholder="%s">',b,d,a)},select:function(b,a,c){return O('<select class="form-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s" dir="%s"></select>',a,c,U(b.options.alignmentSelectControlOptions))},datepicker:function(b,a,c){return O('<input type="text" class="form-control date-filter-control bootstrap-table-filter-control-%s" style="width: 100%; visibility: %s">',a,c)}},disableControlWhenSearch:false,searchOnEnterKey:false,valuesFilterControl:[]});X.extend(X.fn.bootstrapTable.columnDefaults,{filterControl:undefined,filterData:undefined,filterDatepickerOptions:undefined,filterStrictSearch:false,filterStartsWithSearch:false,filterControlPlaceholder:""});X.extend(X.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":"onColumnSearch"});X.extend(X.fn.bootstrapTable.defaults.icons,{clear:"glyphicon-trash icon-clear"});X.extend(X.fn.bootstrapTable.locales,{formatClearFilters:function(){return"Clear Filters"}});X.extend(X.fn.bootstrapTable.defaults,X.fn.bootstrapTable.locales);X.fn.bootstrapTable.methods.push("triggerSearch");var P=X.fn.bootstrapTable.Constructor,R=P.prototype.init,ad=P.prototype.initToolbar,S=P.prototype.initHeader,I=P.prototype.initBody,af=P.prototype.initSearch;P.prototype.init=function(){if(this.options.filterControl){var a=this;if(!Object.keys){N()}this.options.valuesFilterControl=[];this.$el.on("reset-view.bs.table",function(){if(!a.options.height){return}if(a.$tableHeader.find("select").length>0||a.$tableHeader.find("input").length>0){return}J(a,a.$tableHeader)}).on("post-header.bs.table",function(){E(a)}).on("post-body.bs.table",function(){if(a.options.height){G(a)}}).on("column-switch.bs.table",function(){E(a)}).on("load-success.bs.table",function(){a.EnableControls(true)}).on("load-error.bs.table",function(){a.EnableControls(true)})}R.apply(this,Array.prototype.slice.apply(arguments))};P.prototype.initToolbar=function(){this.showToolbar=this.showToolbar||this.options.filterControl&&this.options.filterShowClear;ad.apply(this,Array.prototype.slice.apply(arguments));if(this.options.filterControl&&this.options.filterShowClear){var b=this.$toolbar.find(">.btn-group"),a=b.find(".filter-show-clear");if(!a.length){a=X([O('<button class="btn btn-%s filter-show-clear" ',this.options.buttonsClass),O('type="button" title="%s">',this.options.formatClearFilters()),O('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.clear),"</button>"].join("")).appendTo(b);a.off("click").on("click",X.proxy(this.clearFilterControl,this))}}};P.prototype.initHeader=function(){S.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.filterControl){return}J(this,this.$header)};P.prototype.initBody=function(){I.apply(this,Array.prototype.slice.apply(arguments));ab(this)};P.prototype.initSearch=function(){af.apply(this,Array.prototype.slice.apply(arguments));if(this.options.sidePagination==="server"){return}var a=this;var b=X.isEmptyObject(a.filterColumnsPartial)?null:a.filterColumnsPartial;a.data=b?X.grep(a.data,function(d,e){for(var f in b){var g=a.columns[a.fieldsColumnsIndex[f]];var h=b[f].toLowerCase();var c=d[f];if(g&&g.searchFormatter){c=X.fn.bootstrapTable.utils.calculateObjectValue(a.header,a.header.formatters[X.inArray(f,a.header.fields)],[c,d,e],c)}if(X.inArray(f,a.header.fields)!==-1){if(typeof c==="string"||typeof c==="number"){if(g.filterStrictSearch){if(c.toString().toLowerCase()===h.toString().toLowerCase()){return true}}else{if(g.filterStartsWithSearch){if((c+"").toLowerCase().indexOf(h)===0){return true}}else{if((c+"").toLowerCase().indexOf(h)!==-1){return true}}}}}}return false}):a.data};P.prototype.initColumnSearch=function(b){K(this);if(b){this.filterColumnsPartial=b;this.updatePagination();for(var a in b){this.trigger("column-search",a,b[a])}}};P.prototype.onColumnSearch=function(b){if(X.inArray(b.keyCode,[37,38,39,40])>-1){return}K(this);var a=X.trim(X(b.currentTarget).val());var c=X(b.currentTarget).closest("[data-field]").data("field");if(X.isEmptyObject(this.filterColumnsPartial)){this.filterColumnsPartial={}}if(a){this.filterColumnsPartial[c]=a}else{delete this.filterColumnsPartial[c]}this.searchText+="randomText";this.options.pageNumber=1;this.EnableControls(false);this.onSearch(b);this.trigger("column-search",c,a)};P.prototype.clearFilterControl=function(){if(this.options.filterControl&&this.options.filterShowClear){var d=this,e=M(),a=Y(d),f=a.closest("table"),h=a.find(V(d)),g=d.$toolbar.find(".search input"),c=0;X.each(d.options.valuesFilterControl,function(i,j){j.value=""});E(d);if(h.length>0){this.filterColumnsPartial={};X(h[0]).trigger(h[0].tagName==="INPUT"?"keyup":"change")}else{return}if(g.length>0){d.resetSearch()}if(d.options.sortName!==f.data("sortName")||d.options.sortOrder!==f.data("sortOrder")){var b=a.find(O('[data-field="%s"]',X(h[0]).closest("table").data("sortName")));if(b.length>0){d.onSort(f.data("sortName"),f.data("sortName"));X(b).find(".sortable").trigger("click")}}clearTimeout(c);c=setTimeout(function(){if(e&&e.length>0){X.each(e,function(i,j){if(d.deleteCookie!==undefined){d.deleteCookie(j)}})}},d.options.searchTimeOut)}};P.prototype.triggerSearch=function(){var a=Y(this),b=V(this);a.find(b).each(function(){var c=X(this);if(c.is("select")){c.change()}else{c.keyup()}})};P.prototype.EnableControls=function(c){if((this.options.disableControlWhenSearch)&&(this.options.sidePagination==="server")){var a=Y(this),b=V(this);if(!c){a.find(b).prop("disabled","disabled")}else{a.find(b).removeProp("disabled")}}}})(jQuery);