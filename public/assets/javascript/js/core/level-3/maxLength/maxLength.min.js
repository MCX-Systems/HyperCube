(function(a){if(!a.event.special.destroyed){a.event.special.destroyed={remove:function(b){if(b.handler){b.handler()}}}}a.fn.extend({maxlength:function(e,h){var r=a("body"),m={showOnReady:false,alwaysShow:false,threshold:10,warningClass:"label label-success",limitReachedClass:"label label-important label-danger",separator:" / ",preText:"",postText:"",showMaxLength:true,placement:"bottom",message:null,showCharsTyped:true,validate:false,utf8:false,appendToParent:true,twoCharLinebreak:true,customMaxAttribute:null,allowOverMax:false};if(a.isFunction(e)&&!h){h=e;e={}}e=a.extend(m,e);function c(u){var v=u.charCodeAt();return !v?0:v<128?1:v<2048?2:3}function o(u){return u.split("").map(c).concat(0).reduce(function(v,w){return v+w})}function d(u){var w=u.val();if(e.twoCharLinebreak){w=w.replace(/\r(?!\n)|\n(?!\r)/g,"\r\n")}else{w=w.replace(new RegExp("\r?\n","g"),"\n")}var v=0;if(e.utf8){v=o(w)}else{v=w.length}return v}function i(v,x){var z=v.val();if(e.twoCharLinebreak){z=z.replace(/\r(?!\n)|\n(?!\r)/g,"\r\n");if(z[z.length-1]==="\n"){x-=z.length%2}}if(e.utf8){var y=z.split("").map(c);for(var u=0,w=o(z)-x;u<w;u+=y.pop()){}x-=(x-y.length)}v.val(z.substr(0,x))}function g(w,u,x){var v=true;if(!e.alwaysShow&&(x-d(w)>u)){v=false}return v}function f(u,v){var w=v-d(u);return w}function l(u,v){v.css({display:"block"});u.trigger("maxlength.shown")}function p(u,v){if(e.alwaysShow){return}v.css({display:"none"});u.trigger("maxlength.hidden")}function t(x,v,w){var u="";if(e.message){if(typeof e.message==="function"){u=e.message(x,v)}else{u=e.message.replace("%charsTyped%",w).replace("%charsRemaining%",v-w).replace("%charsTotal%",v)}}else{if(e.preText){u+=e.preText}if(!e.showCharsTyped){u+=v-w}else{u+=w}if(e.showMaxLength){u+=e.separator+v}if(e.postText){u+=e.postText}}return u}function s(v,u,w,x){if(x){x.html(t(u.val(),w,(w-v)));if(v>0){if(g(u,e.threshold,w)){l(u,x.removeClass(e.limitReachedClass).addClass(e.warningClass))}else{p(u,x)}}else{l(u,x.removeClass(e.warningClass).addClass(e.limitReachedClass))}}if(e.customMaxAttribute){if(v<0){u.addClass("overmax")}else{u.removeClass("overmax")}}}function q(u){var v=u[0];return a.extend({},(typeof v.getBoundingClientRect==="function")?v.getBoundingClientRect():{width:v.offsetWidth,height:v.offsetHeight},u.offset())}function b(w,x){if(!w||!x){return}var v=["top","bottom","left","right","position"];var u={};a.each(v,function(z,y){var A=e.placement[y];if(typeof A!=="undefined"){u[y]=A}});x.css(u);return}function j(u,y){var A=q(u);if(a.type(e.placement)==="function"){e.placement(u,y,A);return}if(a.isPlainObject(e.placement)){b(e.placement,y);return}var x=u.outerWidth(),w=y.outerWidth(),v=y.width(),z=y.height();if(e.appendToParent){A.top-=u.parent().offset().top;A.left-=u.parent().offset().left}switch(e.placement){case"bottom":y.css({top:A.top+A.height,left:A.left+A.width/2-v/2});break;case"top":y.css({top:A.top-z,left:A.left+A.width/2-v/2});break;case"left":y.css({top:A.top+A.height/2-z/2,left:A.left-v});break;case"right":y.css({top:A.top+A.height/2-z/2,left:A.left+A.width});break;case"bottom-right":y.css({top:A.top+A.height,left:A.left+A.width});break;case"top-right":y.css({top:A.top-z,left:A.left+x});break;case"top-left":y.css({top:A.top-z,left:A.left-w});break;case"bottom-left":y.css({top:A.top+u.outerHeight(),left:A.left-w});break;case"centered-right":y.css({top:A.top+(z/2),left:A.left+x-w-3});break;case"bottom-right-inside":y.css({top:A.top+A.height,left:A.left+A.width-w});break;case"top-right-inside":y.css({top:A.top-z,left:A.left+x-w});break;case"top-left-inside":y.css({top:A.top-z,left:A.left});break;case"bottom-left-inside":y.css({top:A.top+u.outerHeight(),left:A.left});break}}function k(){return e.placement==="bottom-right-inside"||e.placement==="top-right-inside"||typeof e.placement==="function"||(e.message&&typeof e.message==="function")}function n(v){var u=v.attr("maxlength")||e.customMaxAttribute;if(e.customMaxAttribute&&!e.allowOverMax){var w=v.attr(e.customMaxAttribute);if(!u||w<u){u=w}}if(!u){u=v.attr("size")}return u}return this.each(function(){var v=a(this),w,x;a(window).resize(function(){if(x){j(v,x)}});function u(){var z=t(v.val(),w,"0");w=n(v);if(!x){x=a('<span class="bootstrap-maxlength"></span>').css({display:"none",position:"absolute",whiteSpace:"nowrap",zIndex:1099}).html(z)}if(v.is("textarea")){v.data("maxlenghtsizex",v.outerWidth());v.data("maxlenghtsizey",v.outerHeight());v.mouseup(function(){if(v.outerWidth()!==v.data("maxlenghtsizex")||v.outerHeight()!==v.data("maxlenghtsizey")){j(v,x)}v.data("maxlenghtsizex",v.outerWidth());v.data("maxlenghtsizey",v.outerHeight())})}if(e.appendToParent){v.parent().append(x);v.parent().css("position","relative")}else{r.append(x)}var y=f(v,n(v));s(y,v,w,x);j(v,x)}if(e.showOnReady){v.ready(function(){u()})}else{v.focus(function(){u()})}v.on("maxlength.reposition",function(){j(v,x)});v.on("destroyed",function(){if(x){x.remove()}});v.on("blur",function(){if(x&&!e.showOnReady){x.remove()}});v.on("input",function(){var z=n(v),A=f(v,z),y=true;if(e.validate&&A<0){i(v,z);y=false}else{s(A,v,w,x)}if(k()){j(v,x)}return y})})}})}(jQuery));