(function(){var b=(function(){var C=tinymce.util.Tools.resolve("tinymce.PluginManager");var F=tinymce.util.Tools.resolve("tinymce.Env");var z=function(c){return c.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)};var r=function(c){return c.getParam("default_link_target","")};var y={getAutoLinkPattern:z,getDefaultLinkTarget:r};var a=function(c,d){return c===d||c===" "||c.charCodeAt(0)===160};var s=function(c){E(c,-1,"(")};var x=function(c){E(c,0,"")};var B=function(c){E(c,-1,"")};var D=function(d,c){if(c<0){c=0}if(d.nodeType===3){var e=d.data.length;if(c>e){c=e}}return c};var v=function(d,e,c){if(e.nodeType!==1||e.hasChildNodes()){d.setStart(e,D(e,c))}else{d.setStartBefore(e)}};var w=function(d,e,c){if(e.nodeType!==1||e.hasChildNodes()){d.setEnd(e,D(e,c))}else{d.setEndAfter(e)}};var E=function(g,e,q){var d,k,m,o,f,p,i,l,h,c;var j=y.getAutoLinkPattern(g);var n=y.getDefaultLinkTarget(g);if(g.selection.getNode().tagName==="A"){return}d=g.selection.getRng(true).cloneRange();if(d.startOffset<5){l=d.endContainer.previousSibling;if(!l){if(!d.endContainer.firstChild||!d.endContainer.firstChild.nextSibling){return}l=d.endContainer.firstChild.nextSibling}h=l.length;v(d,l,h);w(d,l,h);if(d.endOffset<5){return}k=d.endOffset;o=l}else{o=d.endContainer;if(o.nodeType!==3&&o.firstChild){while(o.nodeType!==3&&o.firstChild){o=o.firstChild}if(o.nodeType===3){v(d,o,0);w(d,o,o.nodeValue.length)}}if(d.endOffset===1){k=2}else{k=d.endOffset-1-e}}m=k;do{v(d,o,k>=2?k-2:0);w(d,o,k>=1?k-1:0);k-=1;c=d.toString()}while(c!==" "&&c!==""&&c.charCodeAt(0)!==160&&k-2>=0&&c!==q);if(a(d.toString(),q)){v(d,o,k);w(d,o,m);k+=1}else{if(d.startOffset===0){v(d,o,0);w(d,o,m)}else{v(d,o,k);w(d,o,m)}}p=d.toString();if(p.charAt(p.length-1)==="."){w(d,o,m-1)}p=d.toString().trim();i=p.match(j);if(i){if(i[1]==="www."){i[1]="http://www."}else{if(/@$/.test(i[1])&&!/^mailto:/.test(i[1])){i[1]="mailto:"+i[1]}}f=g.selection.getBookmark();g.selection.setRng(d);g.execCommand("createlink",false,i[1]+i[2]);if(n){g.dom.setAttrib(g.selection.getNode(),"target",n)}g.selection.moveToBookmark(f);g.nodeChanged()}};var A=function(c){var d;c.on("keydown",function(e){if(e.keyCode===13){return B(c)}});if(F.ie){c.on("focus",function(){if(!d){d=true;try{c.execCommand("AutoUrlDetect",false,true)}catch(e){}}});return}c.on("keypress",function(e){if(e.keyCode===41){return s(c)}});c.on("keyup",function(e){if(e.keyCode===32){return x(c)}})};var u={setup:A};C.add("autolink",function(c){u.setup(c)});function t(){}return t}())})();