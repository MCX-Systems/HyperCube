!function(){var l5,lH,lR,lM,lQ,lZ=tinymce.util.Tools.resolve("tinymce.PluginManager"),lC=function(){for(var b=[],a=0;a<arguments.length;a++){b[a]=arguments[a]}},lD=function(b,a){return function(){for(var d=[],c=0;c<arguments.length;c++){d[c]=arguments[c]}return b(a.apply(null,arguments))}},mW=function(a){return function(){return a}},lG=function(a){return a},mA=function(c){for(var d=[],b=1;b<arguments.length;b++){d[b-1]=arguments[b]}for(var a=new Array(arguments.length-1),f=1;f<arguments.length;f++){a[f-1]=arguments[f]}return function(){for(var i=[],g=0;g<arguments.length;g++){i[g]=arguments[g]}for(var k=new Array(arguments.length),h=0;h<k.length;h++){k[h]=arguments[h]}var j=a.concat(k);return c.apply(null,j)}},lT=function(a){return function(){for(var c=[],b=0;b<arguments.length;b++){c[b]=arguments[b]}return !a.apply(null,arguments)}},md=function(a){return a()},l8=mW(!1),lV=mW(!0),l3=l8,lJ=lV,l6=function(){return l2},l2=(lM={fold:function(b,a){return b()},is:l3,isSome:l3,isNone:lJ,getOr:lR=function(a){return a},getOrThunk:lH=function(a){return a()},getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:lR,orThunk:lH,map:l6,ap:l6,each:function(){},bind:l6,flatten:l6,exists:l3,forall:lJ,filter:l6,equals:l5=function(a){return a.isNone()},equals_:l5,toArray:function(){return[]},toString:mW("none()")},Object.freeze&&Object.freeze(lM),lM),l0=function(f){var c=function(){return f},a=function(){return d},b=function(g){return g(f)},d={fold:function(h,g){return g(f)},is:function(g){return f===g},isSome:lJ,isNone:l3,getOr:c,getOrThunk:c,getOrDie:c,getOrNull:c,getOrUndefined:c,or:a,orThunk:a,map:function(g){return l0(g(f))},ap:function(g){return g.fold(l6,function(h){return l0(h(f))})},each:function(g){g(f)},bind:b,flatten:c,exists:b,forall:b,filter:function(g){return g(f)?d:l2},equals:function(g){return g.is(f)},equals_:function(h,g){return h.fold(l3,function(i){return g(f,i)})},toArray:function(){return[f]},toString:function(){return"some("+f+")"}};return d},mz={some:l0,none:l6,from:function(a){return null===a||a===undefined?l2:l0(a)}},lP=function(a){return function(b){return function(d){if(null===d){return"null"}var c=typeof d;return"object"===c&&Array.prototype.isPrototypeOf(d)?"array":"object"===c&&String.prototype.isPrototypeOf(d)?"string":c}(b)===a}},lF=lP("string"),l9=lP("array"),lE=lP("boolean"),mx=lP("function"),mG=lP("number"),mV=(lQ=Array.prototype.indexOf)===undefined?function(b,a){return mh(b,a)}:function(b,a){return lQ.call(b,a)},mT=function(b,a){return -1<mV(b,a)},mE=function(b,a){return mp(b,a).isSome()},mZ=function(d,b){for(var g=d.length,c=new Array(g),f=0;f<g;f++){var a=d[f];c[f]=b(a,f,d)}return c},lW=function(c,a){for(var d=0,b=c.length;d<b;d++){a(c[d],d,c)}},mD=function(d,b){for(var g=[],c=0,f=d.length;c<f;c++){var a=d[c];b(a,c,d)&&g.push(a)}return g},mN=function(b,a,c){return function(f,d){for(var g=f.length-1;0<=g;g--){d(f[g],g,f)}}(b,function(d){c=a(c,d)}),c},mY=function(b,a,c){return lW(b,function(d){c=a(c,d)}),c},mI=function(c,a){for(var f=0,b=c.length;f<b;f++){var d=c[f];if(a(d,f,c)){return mz.some(d)}}return mz.none()},mp=function(c,a){for(var d=0,b=c.length;d<b;d++){if(a(c[d],d,c)){return mz.some(d)}}return mz.none()},mh=function(c,a){for(var d=0,b=c.length;d<b;++d){if(c[d]===a){return d}}return -1},mJ=Array.prototype.push,lN=function(c){for(var a=[],d=0,b=c.length;d<b;++d){if(!Array.prototype.isPrototypeOf(c[d])){throw new Error("Arr.flatten item "+d+" was not an array, input: "+c)}mJ.apply(a,c[d])}return a},mS=function(b,a){var c=mZ(b,a);return lN(c)},lY=function(c,a){for(var d=0,b=c.length;d<b;++d){if(!0!==a(c[d],d,c)){return !1}}return !0},lB=Array.prototype.slice,mP=function(b){var a=lB.call(b,0);return a.reverse(),a},mv=(mx(Array.from)&&Array.from,Object.keys),mq=function(d,b){for(var g=mv(d),c=0,f=g.length;c<f;c++){var a=g[c];b(d[a],a,d)}},mQ=function(b,a){return mk(b,function(d,c,f){return{k:c,v:a(d,c,f)}})},mk=function(b,c){var a={};return mq(b,function(f,d){var g=c(f,d,b);a[g.k]=g.v}),a},mm=function(){for(var a=[],b=0;b<arguments.length;b++){a[b]=arguments[b]}return function(){for(var f=[],d=0;d<arguments.length;d++){f[d]=arguments[d]}if(a.length!==f.length){throw new Error('Wrong number of arguments to struct. Expected "['+a.length+']", got '+f.length+" arguments")}var c={};return lW(a,function(h,g){c[h]=mW(f[g])}),c}},mL=function(a){return a.slice(0).sort()},mM=function(b,a){throw new Error("All required keys ("+mL(b).join(", ")+") were not specified. Specified keys were: "+mL(a).join(", ")+".")},nd=function(a){throw new Error("Unsupported keys for object: "+mL(a).join(", "))},mC=function(a,b){if(!l9(b)){throw new Error("The "+a+" fields must be an array. Was: "+b+".")}lW(b,function(c){if(!lF(c)){throw new Error("The value "+c+" in the "+a+" fields was not a string.")}})},mj=function(a){var b=mL(a);mI(b,function(d,c){return c<b.length-1&&d===b[c+1]}).each(function(c){throw new Error("The field: "+c+" occurs more than once in the combined fields: ["+b.join(", ")+"].")})},ld=function(c,b){var a=c.concat(b);if(0===a.length){throw new Error("You must specify at least one required or optional field.")}return mC("required",c),mC("optional",b),mj(a),function(d){var h=mv(d);lY(c,function(i){return mT(h,i)})||mM(c,h);var g=mD(h,function(i){return !mT(a,i)});0<g.length&&nd(g);var f={};return lW(c,function(i){f[i]=mW(d[i])}),lW(b,function(i){f[i]=mW(Object.prototype.hasOwnProperty.call(d,i)?mz.some(d[i]):mz.none())}),f}},hx=mm("width","height"),jd=mm("rows","columns"),ik=mm("row","column"),iZ=mm("x","y"),km=mm("element","rowspan","colspan"),gZ=mm("element","rowspan","colspan","isNew"),nb={dimensions:hx,grid:jd,address:ik,coords:iZ,extended:mm("element","rowspan","colspan","row","column"),detail:km,detailnew:gZ,rowdata:mm("element","cells","section"),elementnew:mm("element","isNew"),rowdatanew:mm("element","cells","section","isNew"),rowcells:mm("cells","section"),rowdetails:mm("details","section"),bounds:mm("startRow","startCol","finishRow","finishCol")},l7=function(a){if(null===a||a===undefined){throw new Error("Node cannot be null or undefined")}return{dom:mW(a)}},jK={fromHtml:function(b,a){var c=(a||document).createElement("div");if(c.innerHTML=b,!c.hasChildNodes()||1<c.childNodes.length){throw console.error("HTML does not have a single root node",b),"HTML must have a single root node"}return l7(c.childNodes[0])},fromTag:function(b,a){var c=(a||document).createElement(b);return l7(c)},fromText:function(b,a){var c=(a||document).createTextNode(b);return l7(c)},fromDom:l7,fromPoint:function(c,a,d){var b=c.dom();return mz.from(b.elementFromPoint(a,d)).map(l7)}},kZ={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE},hU=kZ.ELEMENT,ly=kZ.DOCUMENT,jy=function(a){return a.nodeType!==hU&&a.nodeType!==ly||0===a.childElementCount},kN={all:function(b,a){var c=a===undefined?document:a.dom();return jy(c)?[]:mZ(c.querySelectorAll(b),jK.fromDom)},is:function(b,a){var c=b.dom();if(c.nodeType!==hU){return !1}if(c.matches!==undefined){return c.matches(a)}if(c.msMatchesSelector!==undefined){return c.msMatchesSelector(a)}if(c.webkitMatchesSelector!==undefined){return c.webkitMatchesSelector(a)}if(c.mozMatchesSelector!==undefined){return c.mozMatchesSelector(a)}throw new Error("Browser lacks native selectors")},one:function(b,a){var c=a===undefined?document:a.dom();return jy(c)?mz.none():mz.from(c.querySelector(b)).map(jK.fromDom)}},kC=function(c,a){for(var f=[],b=function(g){return f.push(g),a(g)},d=a(c);(d=d.bind(b)).isSome();){}return f},iN="undefined"!=typeof window?window:Function("return this;")(),gC=function(b,a){return function(f,c){for(var g=c!==undefined&&null!==c?c:iN,d=0;d<f.length&&g!==undefined&&null!==g;++d){g=g[f[d]]}return g}(b.split("."),a)},mU=function(b,a){var c=gC(b,a);if(c===undefined||null===c){throw b+" not available on this browser"}return c},f5=function(){return mU("Node")},fd=function(b,a,c){return 0!=(b.compareDocumentPosition(a)&c)},fJ=function(b,a){return fd(b,a,f5().DOCUMENT_POSITION_CONTAINED_BY)},g8=function(c){var a,b=!1;return function(){for(var f=[],d=0;d<arguments.length;d++){f[d]=arguments[d]}return b||(b=!0,a=c.apply(null,f)),a}},cD=function(c,a){var d=function(h,f){for(var i=0;i<h.length;i++){var g=h[i];if(g.test(f)){return g}}return undefined}(c,a);if(!d){return{major:0,minor:0}}var b=function(f){return Number(a.replace(d,"$"+f))};return b5(b(1),b(2))},cm=function(){return b5(0,0)},b5=function(b,a){return{major:b,minor:a}},dx={nu:b5,detect:function(b,a){var c=String(a).toLowerCase();return 0===b.length?cm():cD(b,c)},unknown:cm},gL="Firefox",gj=function(b,a){return function(){return a===b}},db=function(b){var a=b.current;return{current:a,version:b.version,isEdge:gj("Edge",a),isChrome:gj("Chrome",a),isIE:gj("IE",a),isOpera:gj("Opera",a),isFirefox:gj(gL,a),isSafari:gj("Safari",a)}},h3={unknown:function(){return db({current:undefined,version:dx.unknown()})},nu:db,edge:mW("Edge"),chrome:mW("Chrome"),ie:mW("IE"),opera:mW("Opera"),firefox:mW(gL),safari:mW("Safari")},jV="Windows",cZ="Android",eC="Solaris",hG="FreeBSD",dI=function(b,a){return function(){return a===b}},bg=function(b){var a=b.current;return{current:a,version:b.version,isWindows:dI(jV,a),isiOS:dI("iOS",a),isAndroid:dI(cZ,a),isOSX:dI("OSX",a),isLinux:dI("Linux",a),isSolaris:dI(eC,a),isFreeBSD:dI(hG,a)}},aq={unknown:function(){return bg({current:undefined,version:dx.unknown()})},nu:bg,windows:mW(jV),ios:mW("iOS"),android:mW(cZ),linux:mW("Linux"),osx:mW("OSX"),solaris:mW(eC),freebsd:mW(hG)},dT=function(b,a){var c=String(a).toLowerCase();return mI(b,function(d){return d.search(c)})},iC=function(a,b){return dT(a,b).map(function(d){var c=dx.detect(d.versionRegexes,b);return{current:d.name,version:c}})},fS=function(a,b){return dT(a,b).map(function(d){var c=dx.detect(d.versionRegexes,b);return{current:d.name,version:c}})},j6=function(b,a){return -1!==b.indexOf(a)},eP=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,eY=function(a){return function(b){return j6(b,a)}},bU=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return j6(a,"edge/")&&j6(a,"chrome")&&j6(a,"safari")&&j6(a,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,eP],search:function(a){return j6(a,"chrome")&&!j6(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return j6(a,"msie")||j6(a,"trident")}},{name:"Opera",versionRegexes:[eP,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:eY("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:eY("firefox")},{name:"Safari",versionRegexes:[eP,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(j6(a,"safari")||j6(a,"mobile/"))&&j6(a,"applewebkit")}}],bA=[{name:"Windows",search:eY("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return j6(a,"iphone")||j6(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:eY("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:eY("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:eY("linux"),versionRegexes:[]},{name:"Solaris",search:eY("sunos"),versionRegexes:[]},{name:"FreeBSD",search:eY("freebsd"),versionRegexes:[]}],fw={browsers:mW(bU),oses:mW(bA)},aQ=function(z){var E,k,b,j,v,D,C,B,q,y,F,A=fw.browsers(),p=fw.oses(),x=iC(A,z).fold(h3.unknown,h3.nu),w=fS(p,z).fold(aq.unknown,aq.nu);return{browser:x,os:w,deviceType:(k=x,b=z,j=(E=w).isiOS()&&!0===/ipad/i.test(b),v=E.isiOS()&&!j,D=E.isAndroid()&&3===E.version.major,C=E.isAndroid()&&4===E.version.major,B=j||D||C&&!0===/mobile/i.test(b),q=E.isiOS()||E.isAndroid(),y=q&&!B,F=k.isSafari()&&E.isiOS()&&!1===/safari/i.test(b),{isiPad:mW(j),isiPhone:mW(v),isTablet:mW(B),isPhone:mW(y),isTouch:mW(q),isAndroid:E.isAndroid,isiOS:E.isiOS,isWebView:mW(F)})}},a1={detect:g8(function(){var a=navigator.userAgent;return aQ(a)})},d4=function(b,a){return b.dom()===a.dom()},ek=a1.detect().browser.isIE()?function(b,a){return fJ(b.dom(),a.dom())}:function(c,a){var d=c.dom(),b=a.dom();return d!==b&&d.contains(b)},bJ={eq:d4,isEqualNode:function(b,a){return b.dom().isEqualNode(a.dom())},member:function(b,a){return mE(a,mA(d4,b))},contains:ek,is:kN.is},cO=function(b){var a=b.dom();return mz.from(a.parentNode).map(jK.fromDom)},aF=function(b){var a=b.dom();return mz.from(a.previousSibling).map(jK.fromDom)},k3=function(b){var a=b.dom();return mz.from(a.nextSibling).map(jK.fromDom)},hb=function(b){var a=b.dom();return mZ(a.childNodes,jK.fromDom)},i3=function(b,a){var c=b.dom().childNodes;return mz.from(c[a]).map(jK.fromDom)},h5=mm("element","offset"),iR={owner:function(a){return jK.fromDom(a.dom().ownerDocument)},defaultView:function(b){var a=b.dom().ownerDocument.defaultView;return jK.fromDom(a)},documentElement:function(a){return jK.fromDom(a.dom().ownerDocument.documentElement)},parent:cO,findIndex:function(a){return cO(a).bind(function(c){var b=hb(c);return mp(b,function(d){return bJ.eq(a,d)})})},parents:function(f,c){for(var h=mx(c)?c:mW(!1),d=f.dom(),g=[];null!==d.parentNode&&d.parentNode!==undefined;){var b=d.parentNode,a=jK.fromDom(b);if(g.push(a),!0===h(a)){break}d=b}return g},siblings:function(a){return cO(a).map(hb).map(function(b){return mD(b,function(c){return !bJ.eq(a,c)})}).getOr([])},prevSibling:aF,offsetParent:function(b){var a=b.dom();return mz.from(a.offsetParent).map(jK.fromDom)},prevSiblings:function(a){return mP(kC(a,aF))},nextSibling:k3,nextSiblings:function(a){return kC(a,k3)},children:hb,child:i3,firstChild:function(a){return i3(a,0)},lastChild:function(a){return i3(a,a.dom().childNodes.length-1)},childNodesCount:function(a){return a.dom().childNodes.length},hasChildNodes:function(a){return a.dom().hasChildNodes()},leaf:function(b,a){var c=hb(b);return 0<c.length&&a<c.length?h5(c[a],0):h5(b,a)}},kb=function(b,a,c){return mS(iR.children(b),function(d){return kN.is(d,a)?c(d)?[d]:[]:kb(d,a,c)})},gN={firstLayer:function(b,a){return kb(b,a,mW(!0))},filterFirstLayer:kb},m2=function(a){return a.dom().nodeName.toLowerCase()},lK=function(a){return a.dom().nodeType},jC=function(a){return function(b){return lK(b)===a}},kR=jC(kZ.ELEMENT),hI=jC(kZ.TEXT),lk=jC(kZ.DOCUMENT),jk={name:m2,type:lK,value:function(a){return a.dom().nodeValue},isElement:kR,isText:hI,isDocument:lk,isComment:function(a){return lK(a)===kZ.COMMENT||"#comment"===m2(a)}},kG=function(b,a,c){if(!(lF(c)||lE(c)||mG(c))){throw console.error("Invalid call to Attr.set. Key ",a,":: Value ",c,":: Element ",b),new Error("Attribute value was not simple")}b.setAttribute(a,c+"")},kv=function(b,a,c){kG(b.dom(),a,c)},iG=function(b,a){var c=b.dom().getAttribute(a);return null===c?undefined:c},gm=function(b,a){var c=b.dom();return !(!c||!c.hasAttribute)&&c.hasAttribute(a)},my={clone:function(a){return mY(a.dom().attributes,function(c,b){return c[b.name]=b.value,c},{})},set:kv,setAll:function(b,a){var c=b.dom();mq(a,function(f,d){kG(c,d,f)})},get:iG,has:gm,remove:function(b,a){b.dom().removeAttribute(a)},hasNone:function(b){var a=b.dom().attributes;return a===undefined||null===a||0===a.length},transfer:function(c,a,b){jk.isElement(c)&&jk.isElement(a)&&lW(b,function(g){var d,h,f;h=a,gm(d=c,f=g)&&!gm(h,f)&&kv(h,f,iG(d,f))})}},fU=g8(function(){return e0(jK.fromDom(document))}),e0=function(b){var a=b.dom().body;if(null===a||a===undefined){throw"Body is not available yet"}return jK.fromDom(a)},fy={body:fU,getBody:e0,inBody:function(b){var a=jk.isText(b)?b.dom().parentNode:b.dom();return a!==undefined&&null!==a&&a.ownerDocument.body.contains(a)}},gY=function(b,a){var c=[];return lW(iR.children(b),function(d){a(d)&&(c=c.concat([d])),c=c.concat(gY(d,a))}),c},cw={all:function(a){return gY(fy.body(),a)},ancestors:function(b,a,c){return mD(iR.parents(b,c),a)},siblings:function(b,a){return mD(iR.siblings(b),a)},children:function(b,a){return mD(iR.children(b),a)},descendants:gY},b9={all:function(a){return kN.all(a)},ancestors:function(b,a,c){return cw.ancestors(b,function(d){return kN.is(d,a)},c)},siblings:function(b,a){return cw.siblings(b,function(c){return kN.is(c,a)})},children:function(b,a){return cw.children(b,function(c){return kN.is(c,a)})},descendants:function(b,a){return kN.all(a,b)}};function bY(c,a,f,b,d){return c(f,b)?mz.some(f):mx(d)&&d(f)?mz.none():a(f,b,d)}var dj,gB,f4,c3,hT,jO=function(d,b,g){for(var c=d.dom(),f=mx(g)?g:mW(!1);c.parentNode;){c=c.parentNode;var a=jK.fromDom(c);if(b(a)){return mz.some(a)}if(f(a)){break}}return mz.none()},cS=function(b,a){return mI(b.dom().childNodes,lD(a,jK.fromDom)).map(jK.fromDom)},ev=function(b,a){var c=function(f){for(var d=0;d<f.childNodes.length;d++){if(a(jK.fromDom(f.childNodes[d]))){return mz.some(jK.fromDom(f.childNodes[d]))}var g=c(f.childNodes[d]);if(g.isSome()){return g}}return mz.none()};return c(b.dom())},hw={first:function(a){return ev(fy.body(),a)},ancestor:jO,closest:function(b,a,c){return bY(function(d){return a(d)},jO,b,a,c)},sibling:function(a,c){var b=a.dom();return b.parentNode?cS(jK.fromDom(b.parentNode),function(d){return !bJ.eq(a,d)&&c(d)}):mz.none()},child:cS,descendant:ev},dB=function(b,a,c){return hw.ancestor(b,function(d){return kN.is(d,a)},c)},a5={first:function(a){return kN.one(a)},ancestor:dB,sibling:function(b,a){return hw.sibling(b,function(c){return kN.is(c,a)})},child:function(b,a){return hw.child(b,function(c){return kN.is(c,a)})},descendant:function(b,a){return kN.one(a,b)},closest:function(b,a,c){return bY(kN.is,dB,b,a,c)}},ad=function(c,a,d){var b=d!==undefined?d:mW(!1);return b(a)?mz.none():mT(c,jk.name(a))?mz.some(a):a5.ancestor(a,c.join(","),function(f){return kN.is(f,"table")||b(f)})},dM=function(a,b){return iR.parent(b).map(function(c){return b9.children(c,a)})},iv=mA(dM,"th,td"),fI=mA(dM,"tr"),jZ=function(b,a){return parseInt(my.get(b,a),10)},eE={cell:function(b,a){return ad(["td","th"],b,a)},firstCell:function(a){return a5.descendant(a,"th,td")},cells:function(a){return gN.firstLayer(a,"th,td")},neighbourCells:iv,table:function(b,a){return a5.closest(b,"table",a)},row:function(b,a){return ad(["tr"],b,a)},rows:function(a){return gN.firstLayer(a,"tr")},notCell:function(b,a){return ad(["caption","tr","tbody","tfoot","thead"],b,a)},neighbourRows:fI,attr:jZ,grid:function(c,a,f){var b=jZ(c,a),d=jZ(c,f);return nb.grid(b,d)}},eO=function(b){var a=eE.rows(b);return mZ(a,function(f){var c=f,g=iR.parent(c).map(function(i){var h=jk.name(i);return"tfoot"===h||"thead"===h||"tbody"===h?h:"tbody"}).getOr("tbody"),d=mZ(eE.cells(f),function(i){var h=my.has(i,"rowspan")?parseInt(my.get(i,"rowspan"),10):1,j=my.has(i,"colspan")?parseInt(my.get(i,"colspan"),10):1;return nb.detail(i,h,j)});return nb.rowdata(c,d,g)})},bL=function(a,b){return mZ(a,function(d){var c=mZ(eE.cells(d),function(g){var f=my.has(g,"rowspan")?parseInt(my.get(g,"rowspan"),10):1,h=my.has(g,"colspan")?parseInt(my.get(g,"colspan"),10):1;return nb.detail(g,f,h)});return nb.rowdata(d,c,b.section())})},bm=function(b,a){return b+","+a},fb=function(b,a){var c=mS(b.all(),function(d){return d.cells()});return mD(c,a)},aJ={generate:function(g){var d={},a=[],h=g.length,b=0;lW(g,function(i,j){var f=[];lW(i.cells(),function(s,p){for(var w=0;d[bm(j,w)]!==undefined;){w++}for(var q=nb.extended(s.element(),s.rowspan(),s.colspan(),j,w),v=0;v<s.colspan();v++){for(var m=0;m<s.rowspan();m++){var l=w+v,k=bm(j+m,l);d[k]=q,b=Math.max(b,l+1)}}f.push(q)}),a.push(nb.rowdata(i.element(),f,i.section()))});var c=nb.grid(h,b);return{grid:mW(c),access:mW(d),all:mW(a)}},getAt:function(c,a,d){var b=c.access()[bm(a,d)];return b!==undefined?mz.some(b):mz.none()},findItem:function(c,a,d){var b=fb(c,function(f){return d(a,f.element())});return 0<b.length?mz.some(b[0]):mz.none()},filterItems:fb,justCells:function(b){var a=mZ(b.all(),function(c){return c.cells()});return lN(a)}},aU=function(a){return a.style!==undefined},dX=function(b,a,c){if(!lF(c)){throw console.error("Invalid call to CSS.set. Property ",a,":: Value ",c,":: Element ",b),new Error("CSS value must be a string: "+c)}aU(b)&&b.style.setProperty(a,c)},d8=function(b,a){aU(b)&&b.style.removeProperty(a)},bz=function(c,a,d){var b=c.dom();dX(b,a,d)},cH=function(b,a){return aU(b)?b.style.getPropertyValue(a):""},ay=function(c,a){var d=c.dom(),b=cH(d,a);return mz.from(b).filter(function(f){return 0<f.length})},k7={copy:function(c,a){var d=c.dom(),b=a.dom();aU(d)&&aU(b)&&(b.style.cssText=d.style.cssText)},set:bz,preserve:function(c,a){var d=my.get(c,"style"),b=a(c);return(d===undefined?my.remove:my.set)(c,"style",d),b},setAll:function(b,a){var c=b.dom();mq(a,function(f,d){dX(c,d,f)})},setOptions:function(b,a){var c=b.dom();mq(a,function(f,d){f.fold(function(){d8(c,d)},function(g){dX(c,d,g)})})},remove:function(b,a){var c=b.dom();d8(c,a),my.has(b,"style")&&""===my.get(b,"style").replace(/^\s+|\s+$/g,"")&&my.remove(b,"style")},get:function(c,a){var f=c.dom(),b=window.getComputedStyle(f).getPropertyValue(a),d=""!==b||fy.inBody(c)?b:cH(f,a);return null===d?undefined:d},getRaw:ay,getAllRaw:function(c){var a={},f=c.dom();if(aU(f)){for(var b=0;b<f.style.length;b++){var d=f.style.item(b);a[d]=f.style[d]}}return a},isValidValue:function(c,a,d){var b=jK.fromTag(c);return bz(b,a,d),ay(b,a).isSome()},reflow:function(a){return a.dom().offsetWidth},transfer:function(a,c,b){jk.isElement(a)&&jk.isElement(c)&&lW(b,function(f){var d,g;d=c,ay(a,g=f).each(function(h){ay(d,g).isNone()&&bz(d,g,h)})})}},hm=function(a,b){iR.parent(a).each(function(c){c.dom().insertBefore(b.dom(),a.dom())})},i7=function(b,a){b.dom().appendChild(a.dom())},id={before:hm,after:function(b,a){iR.nextSibling(b).fold(function(){iR.parent(b).each(function(c){i7(c,a)})},function(c){hm(c,a)})},prepend:function(a,b){iR.firstChild(a).fold(function(){i7(a,b)},function(c){a.dom().insertBefore(b.dom(),c.dom())})},append:i7,appendAt:function(b,a,c){iR.child(b,c).fold(function(){i7(b,a)},function(d){hm(d,a)})},wrap:function(b,a){hm(b,a),i7(a,b)}},iV={before:function(a,b){lW(b,function(c){id.before(a,c)})},after:function(a,b){lW(b,function(d,c){var f=0===c?a:b[c-1];id.after(f,d)})},prepend:function(a,b){lW(b.slice().reverse(),function(c){id.prepend(a,c)})},append:function(a,b){lW(b,function(c){id.append(a,c)})}},gT=function(b){var a=b.dom();null!==a.parentNode&&a.parentNode.removeChild(a)},m6={empty:function(a){a.dom().textContent="",lW(iR.children(a),function(b){gT(b)})},remove:gT,unwrap:function(b){var a=iR.children(b);0<a.length&&iV.before(b,a),gT(b)}},lU=mm("minRow","minCol","maxRow","maxCol"),jG=function(G,k){var z,C,w,j,J,I,B,y,F,q,H=function(a){return kN.is(a.element(),k)},A=eO(G),E=aJ.generate(A),D=(C=H,w=(z=E).grid().columns(),j=z.grid().rows(),J=w,B=I=0,mq(z.access(),function(d){if(C(d)){var a=d.row(),g=a+d.rowspan()-1,c=d.column(),f=c+d.colspan()-1;a<j?j=a:I<g&&(I=g),c<J?J=c:B<f&&(B=f)}}),lU(j,J,I,B)),x="th:not("+k+"),td:not("+k+")",b=gN.filterFirstLayer(G,"th,td",function(a){return kN.is(a,x)});return lW(b,m6.remove),function(K,O,h,d){for(var g,p,N,M=O.grid().columns(),L=O.grid().rows(),m=0;m<L;m++){for(var v=!1,P=0;P<M;P++){m<h.minRow()||m>h.maxRow()||P<h.minCol()||P>h.maxCol()||(aJ.getAt(O,m,P).filter(d).isNone()?(g=v,p=K[m].element(),N=jK.fromTag("td"),id.append(N,jK.fromTag("br")),(g?id.append:id.prepend)(p,N)):v=!0)}}}(A,E,D,H),y=G,F=D,q=mD(gN.firstLayer(y,"tr"),function(a){return 0===a.dom().childElementCount}),lW(q,m6.remove),F.minCol()!==F.maxCol()&&F.minRow()!==F.maxRow()||lW(gN.firstLayer(y,"th,td"),function(a){my.remove(a,"rowspan"),my.remove(a,"colspan")}),my.remove(y,"width"),my.remove(y,"height"),k7.remove(y,"width"),k7.remove(y,"height"),G},kV=function(b,a){return jK.fromDom(b.dom().cloneNode(a))},hO=function(a){return kV(a,!0)},lq=function(c,a){var d=jK.fromTag(a),b=my.clone(c);return my.setAll(d,b),d},js=function(a){return kV(a,!1)},kJ=hO,ky=function(c,a){var d=lq(c,a),b=iR.children(hO(c));return iV.append(d,b),d},iJ=(dj=jk.isText,gB="text",f4=function(a){return dj(a)?mz.from(a.dom().nodeValue):mz.none()},c3=a1.detect().browser,{get:function(a){if(!dj(a)){throw new Error("Can only get "+gB+" value of a "+gB+" node")}return hT(a).getOr("")},getOption:hT=c3.isIE()&&10===c3.version.major?function(b){try{return f4(b)}catch(a){return mz.none()}}:f4,set:function(b,a){if(!dj(b)){throw new Error("Can only set raw "+gB+" value of a "+gB+" node")}b.dom().nodeValue=a}}),gw={get:function(a){return iJ.get(a)},getOption:function(a){return iJ.getOption(a)},set:function(b,a){iJ.set(b,a)}},mH=function(a){return"img"===jk.name(a)?1:gw.getOption(a).fold(function(){return iR.children(a).length},function(b){return b.length})},fZ=["img","br"],e5=mH,fD=function(a){return gw.getOption(a).filter(function(b){return 0!==b.trim().length||-1<b.indexOf("\xa0")}).isSome()||mT(fZ,jk.name(a))},g4=function(c,b){var a=function(g){for(var d=iR.children(g),i=d.length-1;0<=i;i--){var f=d[i];if(b(f)){return mz.some(f)}var h=a(f);if(h.isSome()){return h}}return mz.none()};return a(c)},cz={first:function(a){return hw.descendant(a,fD)},last:function(a){return g4(a,fD)}},cg=function(){var a=jK.fromTag("td");return id.append(a,jK.fromTag("br")),a},b1=function(c,a,d){var b=ky(c,a);return mq(d,function(g,f){null===g?my.remove(b,f):my.set(b,f,g)}),b},dp=function(a){return a},gH=function(a){return function(){return jK.fromTag("tr",a.dom())}},gb=function(d,b,a){return{row:gH(b),cell:function(k){var j,l,h,g=iR.owner(k.element()),m=jK.fromTag(jk.name(k.element()),g.dom()),f=a.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=0<f.length?(j=k.element(),l=m,h=f,cz.first(j).map(function(o){var i=h.join(","),p=b9.ancestors(o,i,function(n){return bJ.eq(n,j)});return mN(p,function(r,q){var s=js(q);return my.remove(s,"contenteditable"),id.append(r,s),s},l)}).getOr(l)):m;return id.append(c,jK.fromTag("br")),k7.copy(k.element(),m),k7.remove(m,"height"),1!==k.colspan()&&k7.remove(k.element(),"width"),d(k.element(),m),m},replace:b1,gap:cg}},c6=function(a){return{row:gH(a),cell:cg,replace:dp,gap:cg}},hZ=function(b,a){var c=(a||document).createElement("div");return c.innerHTML=b,iR.children(jK.fromDom(c))},jR=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function cV(){return{up:mW({selector:a5.ancestor,closest:a5.closest,predicate:hw.ancestor,all:iR.parents}),down:mW({selector:b9.descendants,predicate:cw.descendants}),styles:mW({get:k7.get,getRaw:k7.getRaw,set:k7.set,remove:k7.remove}),attrs:mW({get:my.get,set:my.set,remove:my.remove,copyTo:function(b,a){var c=my.clone(b);my.setAll(a,c)}}),insert:mW({before:id.before,after:id.after,afterAll:iV.after,append:id.append,appendAll:iV.append,prepend:id.prepend,wrap:id.wrap}),remove:mW({unwrap:m6.unwrap,remove:m6.remove}),create:mW({nu:jK.fromTag,clone:function(a){return jK.fromDom(a.dom().cloneNode(!1))},text:jK.fromText}),query:mW({comparePosition:function(b,a){return b.dom().compareDocumentPosition(a.dom())},prevSibling:iR.prevSibling,nextSibling:iR.nextSibling}),property:mW({children:iR.children,name:jk.name,parent:iR.parent,isText:jk.isText,isComment:jk.isComment,isElement:jk.isElement,getText:gw.get,setText:gw.set,isBoundary:function(a){return !!jk.isElement(a)&&("body"===jk.name(a)||mT(jR,jk.name(a)))},isEmptyTag:function(a){return !!jk.isElement(a)&&mT(["br","img","hr","input"],jk.name(a))}}),eq:bJ.eq,is:bJ.is}}var ey=mm("left","right"),hC=function(c,a,d){var b=c.property().children(a);return mp(b,mA(c.eq,d)).map(function(f){return{before:mW(b.slice(0,f)),after:mW(b.slice(f+1))}})},dE=function(c,a,b){return hC(c,a,b).map(function(f){var d=c.create().clone(a);return c.insert().appendAll(d,f.before().concat([b])),c.insert().appendAll(a,f.after()),c.insert().before(a,d),ey(d,a)})},a8=function(c,a,b){return hC(c,a,b).map(function(f){var d=c.create().clone(a);return c.insert().appendAll(d,f.after()),c.insert().after(a,d),ey(a,d)})},aj=function(f,h,d,b){var g=mm("first","second","splits"),j=function(c,a,i){var k=g(c,mz.none(),i);return d(c)?g(c,a,i):f.property().parent(c).bind(function(e){return b(f,e,c).map(function(m){var l=[{first:m.left,second:m.right}],o=d(e)?e:m.left();return j(o,mz.some(m.right()),i.concat(l))}).getOr(k)})};return j(h,mz.none(),[])},dP=function(b,d,c,a){var f=d(b,c);return mN(a,function(h,g){var i=d(b,g);return iy(b,h,i)},f)},iy=function(a,b,c){return b.bind(function(d){return c.filter(mA(a.eq,d))})},fO=function(c,a,d){return 0<d.length?dP(c,a,(b=d)[0],b.slice(1)):mz.none();var b},j2=function(b,a){return mA(b.eq,a)},eJ=function(v,m,g,b){var d=b!==undefined?b:mW(!1),j=[m].concat(v.up().all(m)),s=[g].concat(v.up().all(g)),q=function(a){return mp(a,d).fold(function(){return a},function(c){return a.slice(0,c+1)})},p=q(j),h=q(s),k=mI(p,function(a){return mE(h,j2(v,a))});return{firstpath:mW(p),secondpath:mW(h),shared:mW(k)}},eU=function(a,c,d){var b=eJ(a,c,d);return b.shared().bind(function(f){return function(p,k,m,j){var h=p.property().children(k);if(p.eq(k,m[0])){return mz.some([m[0]])}if(p.eq(k,j[0])){return mz.some([j[0]])}var q=function(s){var i=mP(s),u=mp(i,j2(p,k)).getOr(-1),o=u<i.length-1?i[u+1]:i[u];return mp(h,j2(p,o))},l=q(m),g=q(j);return l.bind(function(e){return g.map(function(o){var i=Math.min(e,o),r=Math.max(e,o);return h.slice(i,r+1)})})}(a,f,b.firstpath(),b.secondpath())})},bQ=eJ,bs=function(b,a,c){return fO(b,a,c)},fm=function(b,a,c){return eU(b,a,c)},aM=function(c,a,d,b){return bQ(c,a,d,b)},aX=function(b,a,c){return dE(b,a,c)},d0=function(b,a,c){return a8(b,a,c)},ed=function(c,a,d,b){return aj(c,a,d,b)},bF=cV(),cK={sharedOne:function(b,a){return bs(bF,function(d,c){return b(c)},a)},subset:function(b,a){return fm(bF,b,a)},ancestors:function(b,a,c){return aM(bF,b,a,c)},breakToLeft:function(b,a){return aX(bF,b,a)},breakToRight:function(b,a){return d0(bF,b,a)},breakPath:function(c,a,b){return ed(bF,c,a,function(f,d,g){return b(d,g)})}},aB=function(b,a){return a.column()>=b.startCol()&&a.column()+a.colspan()-1<=b.finishCol()&&a.row()>=b.startRow()&&a.row()+a.rowspan()-1<=b.finishRow()},k5=function(d,b){var g=b.column(),c=b.column()+b.colspan()-1,f=b.row(),a=b.row()+b.rowspan()-1;return g<=d.finishCol()&&c>=d.startCol()&&f<=d.finishRow()&&a>=d.startRow()},hh=function(d,b){for(var g=!0,c=mA(aB,b),f=b.startRow();f<=b.finishRow();f++){for(var a=b.startCol();a<=b.finishCol();a++){g=g&&aJ.getAt(d,f,a).exists(c)}}return g?mz.some(b):mz.none()},i5=function(c,a,f){var b=aJ.findItem(c,a,bJ.eq),d=aJ.findItem(c,f,bJ.eq);return b.bind(function(e){return d.map(function(h){return g=e,i=h,nb.bounds(Math.min(g.row(),i.row()),Math.min(g.column(),i.column()),Math.max(g.row()+g.rowspan()-1,i.row()+i.rowspan()-1),Math.max(g.column()+g.colspan()-1,i.column()+i.colspan()-1));var g,i})})},h8=i5,iT=function(a,b,c){return i5(a,b,c).bind(function(d){return hh(a,d)})},kg=function(b,c,d,a){return aJ.findItem(b,c,bJ.eq).bind(function(g){var f=0<d?g.row()+g.rowspan()-1:g.row(),h=0<a?g.column()+g.colspan()-1:g.column();return aJ.getAt(b,f+d,h+a).map(function(i){return i.element()})})},gQ=function(c,b,a){return h8(c,b,a).map(function(f){var d=aJ.filterItems(c,mA(k5,f));return mZ(d,function(g){return g.element()})})},m4=function(b,a){return aJ.findItem(b,a,function(d,c){return bJ.contains(c,d)}).bind(function(c){return c.element()})},lO=function(b){var a=eO(b);return aJ.generate(a)},jE=function(c,a,b){return eE.table(c).bind(function(f){var d=lO(f);return kg(d,c,a,b)})},kT=function(c,a,d){var b=lO(c);return gQ(b,a,d)},hL=function(h,f,k,g,j){var d=lO(h),c=bJ.eq(h,k)?f:m4(d,f),b=bJ.eq(h,j)?g:m4(d,g);return gQ(d,c,b)},lp=function(c,a,d){var b=lO(c);return iT(b,a,d)},jp=function(b,a){return a5.ancestor(b,"table")},kH=ld(["boxes","start","finish"],[]),kw=function(d,f,e){var b=function(a){return function(c){return e(c)||bJ.eq(c,a)}};return bJ.eq(d,f)?mz.some(kH({boxes:mz.some([d]),start:d,finish:f})):jp(d).bind(function(a){return jp(f).bind(function(g){if(bJ.eq(a,g)){return mz.some(kH({boxes:kT(a,d,f),start:d,finish:f}))}if(bJ.contains(a,g)){var h=0<(c=b9.ancestors(f,"td,th",b(a))).length?c[c.length-1]:f;return mz.some(kH({boxes:hL(a,d,a,f,g),start:d,finish:h}))}if(bJ.contains(g,a)){var c,j=0<(c=b9.ancestors(d,"td,th",b(g))).length?c[c.length-1]:d;return mz.some(kH({boxes:hL(g,d,a,f,g),start:d,finish:j}))}return cK.ancestors(d,f).shared().bind(function(i){return a5.closest(i,"table",e).bind(function(m){var k=b9.ancestors(f,"td,th",b(m)),q=0<k.length?k[k.length-1]:f,l=b9.ancestors(d,"td,th",b(m)),p=0<l.length?l[l.length-1]:d;return mz.some(kH({boxes:hL(m,d,a,f,g),start:p,finish:q}))})})})})},iH=kw,gq=function(b,a){var c=b9.descendants(b,a);return 0<c.length?mz.some(c):mz.none()},mB=function(f,c,h,d,g){return(b=f,a=g,mI(b,function(i){return kN.is(i,a)})).bind(function(i){return jE(i,c,h).bind(function(k){return j=k,l=d,a5.ancestor(j,"table").bind(function(m){return a5.descendant(m,l).bind(function(n){return kw(n,j).bind(function(e){return e.boxes().map(function(o){return{boxes:mW(o),start:mW(e.start()),finish:mW(e.finish())}})})})});var j,l})});var b,a},fW=function(c,a,b){return a5.descendant(c,a).bind(function(d){return a5.descendant(c,b).bind(function(e){return cK.sharedOne(jp,[d,e]).map(function(f){return{first:mW(d),last:mW(e),table:mW(f)}})})})},e2=function(b,a){return gq(b,a)},fA=function(c,b,a){return fW(c,b,a).bind(function(h){var g=function(i){return bJ.eq(c,i)},d=a5.ancestor(h.first(),"thead,tfoot,tbody,table",g),f=a5.ancestor(h.last(),"thead,tfoot,tbody,table",g);return d.bind(function(e){return f.bind(function(i){return bJ.eq(e,i)?lp(h.table(),h.first(),h.last()):mz.none()})})})},g0="data-mce-selected",cx="data-mce-first-selected",cb="data-mce-last-selected",bZ={selected:mW(g0),selectedSelector:mW("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:mW("[data-mce-selected]"),firstSelected:mW(cx),firstSelectedSelector:mW("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:mW(cb),lastSelectedSelector:mW("td[data-mce-last-selected],th[data-mce-last-selected]")},dk=function(c){if(!l9(c)){throw new Error("cases must be an array")}if(0===c.length){throw new Error("there must be at least one case")}var b=[],d={};return lW(c,function(h,g){var f=mv(h);if(1!==f.length){throw new Error("one and only one name per case")}var j=f[0],a=h[j];if(d[j]!==undefined){throw new Error("duplicate key detected:"+j)}if("cata"===j){throw new Error("cannot have a case named cata (sorry)")}if(!l9(a)){throw new Error("case arguments must be an array")}b.push(j),d[j]=function(){var k=arguments.length;if(k!==a.length){throw new Error("Wrong number of arguments to case "+j+". Expected "+a.length+" ("+a+"), got "+k)}for(var l=new Array(k),i=0;i<l.length;i++){l[i]=arguments[i]}return{fold:function(){if(arguments.length!==c.length){throw new Error("Wrong number of arguments to fold. Expected "+c.length+", got "+arguments.length)}return arguments[g].apply(null,l)},match:function(n){var m=mv(n);if(b.length!==m.length){throw new Error("Wrong number of arguments to match. Expected: "+b.join(",")+"\nActual: "+m.join(","))}if(!lY(b,function(o){return mT(m,o)})){throw new Error("Not all branches were specified when using match. Specified: "+m.join(", ")+"\nRequired: "+b.join(", "))}return n[j].apply(null,l)},log:function(m){console.log(m,{constructors:b,constructor:j,params:l})}}}}),d},gD=dk([{none:[]},{multiple:["elements"]},{single:["selection"]}]),f6={cata:function(c,a,d,b){return c.fold(a,d,b)},none:gD.none,multiple:gD.multiple,single:gD.single},c4=function(b,a){return f6.cata(a.get(),mW([]),lG,mW([b]))},hV=function(b,a){return f6.cata(a.get(),mz.none,function(c,d){return 0===c.length?mz.none():fA(b,bZ.firstSelectedSelector(),bZ.lastSelectedSelector()).bind(function(f){return 1<c.length?mz.some({bounds:mW(f),cells:mW(c)}):mz.none()})},mz.none)},jP=function(b,a){var c=c4(b,a);return 0<c.length&&lY(c,function(d){return my.has(d,"rowspan")&&1<parseInt(my.get(d,"rowspan"),10)||my.has(d,"colspan")&&1<parseInt(my.get(d,"colspan"),10)})?mz.some(c):mz.none()},cT=c4,ew=function(a){return{element:mW(a),mergable:mz.none,unmergable:mz.none,selection:mW([a])}},hy=mm("element","clipboard","generators"),dC={noMenu:ew,forMenu:function(b,a,c){return{element:mW(c),mergable:mW(hV(a,b)),unmergable:mW(jP(c,b)),selection:mW(cT(c,b))}},notCell:function(a){return ew(a)},paste:hy,pasteRows:function(c,a,f,b,d){return{element:mW(f),mergable:mz.none,unmergable:mz.none,selection:mW(cT(f,c)),clipboard:mW(b),generators:mW(d)}}},a6=function(d,f,g,b){d.on("BeforeGetContent",function(a){!0===a.selection&&f6.cata(f.get(),lC,function(h){var c;a.preventDefault(),(c=h,eE.table(c[0]).map(kJ).map(function(i){return[jG(i,bZ.attributeSelector())]})).each(function(i){a.content=mZ(i,function(k){return j=k,d.selection.serializer.serialize(j.dom(),{});var j}).join("")})},lC)}),d.on("BeforeSetContent",function(a){!0===a.selection&&!0===a.paste&&mz.from(d.dom.getParent(d.selection.getStart(),"th,td")).each(function(h){var c=jK.fromDom(h);eE.table(c).bind(function(i){var k=mD(hZ(a.content),function(n){return"meta"!==jk.name(n)});if(1===k.length&&"table"===jk.name(k[0])){a.preventDefault();var m=jK.fromDom(d.getDoc()),j=c6(m),l=dC.paste(c,k[0],j);g.pasteCells(i,l).each(function(n){d.selection.setRng(n),d.focus(),b.clear(i)})}})})})};function ag(b,d){var c=function(g){var f=d(g);if(f<=0||null===f){var h=k7.get(g,b);return parseFloat(h)||0}return f},a=function(g,f){return mY(f,function(j,h){var k=k7.get(g,h),i=k===undefined?0:parseInt(k,10);return isNaN(i)?j:j+i},0)};return{set:function(g,f){if(!mG(f)&&!f.match(/^[0-9]+$/)){throw b+".set accepts only positive integer values. Value was "+f}var h=g.dom();aU(h)&&(h.style[b]=f+"px")},get:c,getOuter:c,aggregate:a,max:function(h,f,i){var g=a(h,i);return g<f?f-g:0}}}var dN=ag("height",function(b){var a=b.dom();return fy.inBody(b)?a.getBoundingClientRect().height:a.offsetHeight}),iw=function(a){return dN.get(a)},fK=function(a){return dN.getOuter(a)},j0=ag("width",function(a){return a.dom().offsetWidth}),eG=function(a){return j0.get(a)},eQ=function(a){return j0.getOuter(a)},bN=a1.detect(),bp=function(d,b,g){return c=k7.get(d,b),f=g,a=parseFloat(c),isNaN(a)?f:a;var c,f,a},fg=function(f){return bN.browser.isIE()||bN.browser.isEdge()?(h=bp(c=f,"padding-top",0),d=bp(c,"padding-bottom",0),g=bp(c,"border-top-width",0),b=bp(c,"border-bottom-width",0),a=c.dom().getBoundingClientRect().height,"border-box"===k7.get(c,"box-sizing")?a:a-h-d-(g+b)):bp(f,"height",iw(f));var c,h,d,g,b,a},aK=/(\d+(\.\d+)?)(\w|%)*/,aV=/(\d+(\.\d+)?)%/,dY=/(\d+(\.\d+)?)px|em/,d9=function(b,a){k7.set(b,"height",a+"px")},bB=function(v,A,h,b){var g,p,z,y,x,k,q,B,w,j=parseInt(v,10);return B=k="%",w=(q=v).length-k.length,""!==B&&(q.length<B.length||q.substr(w,w+B.length)!==B)||"table"===jk.name(A)?j:(g=A,p=j,z=h,y=b,x=eE.table(g).map(function(c){var a=z(c);return Math.floor(p/100*a)}).getOr(p),y(g,x),x)},cI=function(b){var a,c=(a=b,k7.getRaw(a,"height").getOrThunk(function(){return fg(a)+"px"}));return c?bB(c,b,iw,d9):iw(b)},az=function(b,a){return my.has(b,a)?parseInt(my.get(b,a),10):1},k6=function(a){return k7.getRaw(a,"width").fold(function(){return mz.from(my.get(a,"width"))},function(b){return mz.some(b)})},hk=function(b,a){return b/a.pixelWidth()*100},i6={percentageBasedSizeRegex:mW(aV),pixelBasedSizeRegex:mW(dY),setPixelWidth:function(b,a){k7.set(b,"width",a+"px")},setPercentageWidth:function(b,a){k7.set(b,"width",a+"%")},setHeight:d9,getPixelWidth:function(a,b){return k6(a).fold(function(){return eG(a)},function(c){return function(h,f,k){if(dY.test(f)){var g=dY.exec(f);return parseInt(g[1],10)}if(aV.test(f)){var j=aV.exec(f),d=parseFloat(j[1]);return d/100*k.pixelWidth()}return eG(h)}(a,c,b)})},getPercentageWidth:function(a,b){return k6(a).fold(function(){var c=eG(a);return hk(c,b)},function(c){return function(g,d,i){if(aV.test(d)){var f=aV.exec(d);return parseFloat(f[1])}var h=eG(g);return hk(h,i)}(a,c,b)})},getGenericWidth:function(a){return k6(a).bind(function(c){if(aK.test(c)){var b=aK.exec(c);return mz.some({width:mW(b[1]),unit:mW(b[3])})}return mz.none()})},setGenericWidth:function(b,a,c){k7.set(b,"width",a+c)},getHeight:function(b){return c="rowspan",cI(a=b)/az(a,c);var a,c},getRawWidth:k6},ib=function(b,a){i6.getGenericWidth(b).each(function(d){var c=d.width()/2;i6.setGenericWidth(b,c,d.unit()),i6.setGenericWidth(a,c,d.unit())})},iU=function(b,a){var c=a||jK.fromDom(document.documentElement);return hw.ancestor(b,mA(bJ.eq,c)).isSome()},kh=function(b){var a=b.dom();return a===a.window&&b instanceof Window?b:jk.isDocument(b)?a.defaultView||a.parentWindow:null},gS=function(b,a){return{left:mW(b),top:mW(a),translate:function(d,c){return gS(b+d,a+c)}}},m5=gS,lS=function(b,a){return b!==undefined?b:a!==undefined?a:0},jF=function(d){var b,g=d.dom(),c=g.ownerDocument,f=c.body,a=jK.fromDom(c.documentElement);return f===g?m5(f.offsetLeft,f.offsetTop):iU(d,a)?(b=g.getBoundingClientRect(),m5(b.left,b.top)):m5(0,0)},kU=function(h){var m=h.dom().ownerDocument,f=m.body,b=kh(jK.fromDom(m)),d=m.documentElement,g=lS(b.pageYOffset,d.scrollTop),l=lS(b.pageXOffset,d.scrollLeft),k=lS(d.clientTop,f.clientTop),j=lS(d.clientLeft,f.clientLeft);return jF(h).translate(l-j,g-k)},hN=mm("row","y"),jq=mm("col","x"),kI=function(a){return kU(a).left()+eQ(a)},kx=function(a){return kU(a).left()},iI=function(b,a){return jq(b,kx(a))},gv=function(b,a){return jq(b,kI(a))},mF=function(a){return kU(a).top()},fY=function(f,a,b){if(0===b.length){return[]}var c=mZ(b.slice(1),function(h,g){return h.map(function(i){return f(g,i)})}),d=b[b.length-1].map(function(g){return a(b.length-1,g)});return c.concat([d])},e4={delta:lG,positions:mA(fY,function(b,a){return hN(b,mF(a))},function(b,a){return hN(b,mF(a)+fK(a))}),edge:mF},fC={delta:lG,edge:kx,positions:mA(fY,iI,gv)},g3={height:e4,rtl:{delta:function(b,a){return -b},edge:kI,positions:mA(fY,gv,iI)},ltr:fC},cy={ltr:g3.ltr,rtl:g3.rtl};function cd(a){var b=function(c){return a(c).isRtl()?cy.rtl:cy.ltr};return{delta:function(d,c){return b(c).delta(d,c)},edge:function(c){return b(c).edge(c)},positions:function(d,c){return b(c).positions(d,c)}}}var b0,dm=function(b){var a=eO(b);return aJ.generate(a).grid()},gG=function(b){var a=b,c=function(){return a};return{get:c,set:function(d){a=d},clone:function(){return gG(c())}}},f9=function(b,c,a){if(0===c.length){throw new Error("You must specify at least one required field.")}return mC("required",c),mj(c),function(d){var g=mv(d);lY(c,function(h){return mT(g,h)})||mM(c,g),b(c,g);var f=mD(c,function(h){return !a.validate(d[h],h)});return 0<f.length&&function(i,h){throw new Error("All values need to be of type: "+h+". Keys ("+mL(i).join(", ")+") were not.")}(f,a.label),d}},c5=function(a,b){var c=mD(b,function(d){return !mT(a,d)});0<c.length&&nd(c)},hY=function(a){return f9(c5,a,{validate:mx,label:"function"})},jQ=function(b){var a=my.has(b,"colspan")?parseInt(my.get(b,"colspan"),10):1,c=my.has(b,"rowspan")?parseInt(my.get(b,"rowspan"),10):1;return{element:mW(b),colspan:mW(a),rowspan:mW(c)}},cU=hY(["cell","row","replace","gap"]),ex=function(f,g){cU(f);var j=gG(mz.none()),h=g!==undefined?g:jQ,d=function(i){var a,k=h(i);return a=k,f.cell(a)},c=function(i){var a=d(i);return j.get().isNone()&&j.set(mz.some(a)),b=mz.some({item:i,replacement:a}),a},b=mz.none();return{getOrInit:function(a,e){return b.fold(function(){return c(a)},function(i){return e(a,i.item)?i.replacement:c(a)})},cursor:j.get}},hB=function(c,b){return function(f){var e=gG(mz.none());cU(f);var d=[],a=function(h){var g=f.replace(h,b,{scope:c});return d.push({item:h,sub:g}),e.get().isNone()&&e.set(mz.some(g)),g};return{replaceOrInit:function(g,j){return(h=g,i=j,mI(d,function(k){return i(k.item,h)})).fold(function(){return a(g)},function(k){return j(g,k.item)?k.sub:a(g)});var h,i},cursor:e.get}}},dD=function(b){cU(b);var a=gG(mz.none());return{combine:function(c){return a.get().isNone()&&a.set(mz.some(c)),function(){var d=b.cell({element:mW(c),colspan:mW(1),rowspan:mW(1)});return k7.remove(d,"width"),k7.remove(c,"width"),d}},cursor:a.get}},a7=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],ah=function(b,a){var c=b.property().name(a);return mT(a7,c)},dO=function(b,a){return mT(["br","img","hr","input"],b.property().name(a))},ix=ah,fN=function(b,a){var c=b.property().name(a);return mT(["ol","ul"],c)},j1=dO,eI=cV(),eT=function(a){return ix(eI,a)},bP=function(a){return fN(eI,a)},bq=function(a){return j1(eI,a)},fk=function(d){var b,a=function(g){return"br"===jk.name(g)},f=function(e){return cz.last(e).bind(function(i){var h,g=(h=i,iR.nextSibling(h).map(function(j){return !!eT(j)||(bq(j)?"img"!==jk.name(j):void 0)}).getOr(!1));return iR.parent(i).map(function(k){return !0===g||(j=k,"li"===jk.name(j)||hw.ancestor(j,bP).isSome())||a(i)||eT(k)&&!bJ.eq(e,k)?[]:[jK.fromTag("br")];var j})}).getOr([])},c=0===(b=mS(d,function(h){var g=iR.children(h);return lY(g,function(i){return a(i)||jk.isText(i)&&0===gw.get(i).trim().length})?[]:g.concat(f(h))})).length?[jK.fromTag("br")]:b;m6.empty(d[0]),iV.append(d[0],c)},aL=Object.prototype.hasOwnProperty,aW=(b0=function(b,a){return a},function(){for(var d=new Array(arguments.length),b=0;b<d.length;b++){d[b]=arguments[b]}if(0===d.length){throw new Error("Can't merge zero objects")}for(var g={},c=0;c<d.length;c++){var f=d[c];for(var a in f){aL.call(f,a)&&(g[a]=b0(g[a],f[a]))}}return g}),dZ=function(c){for(var a=[],d=function(f){a.push(f)},b=0;b<c.length;b++){c[b].each(d)}return a},eb=function(c,a){for(var d=0;d<c.length;d++){var b=a(c[d],d);if(b.isSome()){return b}}return mz.none()},bE=function(b,a){return nb.rowcells(a,b.section())},cJ=function(b,a){return b.cells()[a]},aA={addCell:function(f,c,h){var d=f.cells(),g=d.slice(0,c),b=d.slice(c),a=g.concat([h]).concat(b);return bE(f,a)},setCells:bE,mutateCell:function(b,a,c){b.cells()[a]=c},getCell:cJ,getCellElement:function(b,a){return cJ(b,a).element()},mapCells:function(c,a){var d=c.cells(),b=mZ(d,a);return nb.rowcells(b,c.section())},cellLength:function(a){return a.cells().length}},k9=function(b,a){if(0===b.length){return 0}var c=b[0];return mp(b,function(d){return !a(c.element(),d.element())}).fold(function(){return b.length},function(d){return d})},hq=function(m,w,g,b){var d,j,v,q,p=(d=m,j=w,d[j]).cells().slice(g),h=k9(p,b),k=(v=m,q=g,mZ(v,function(a){return aA.getCell(a,q)})).slice(w),x=k9(k,b);return{colspan:mW(h),rowspan:mW(x)}},i9=function(c,b){var a=mZ(c,function(f,d){return mZ(f.cells(),function(h,g){return !1})});return mZ(c,function(g,f){var d=mS(g.cells(),function(i,h){if(!1===a[f][h]){var j=hq(c,f,h,b);return function(p,l,s,m){for(var q=p;q<p+s;q++){for(var k=l;k<l+m;k++){a[q][k]=!0}}}(f,h,j.rowspan(),j.colspan()),[nb.detailnew(i.element(),j.rowspan(),j.colspan(),i.isNew())]}return[]});return nb.rowdetails(d,g.section())})},ih=function(h,m,f){for(var b=[],d=0;d<h.grid().rows();d++){for(var g=[],l=0;l<h.grid().columns();l++){var k=aJ.getAt(h,d,l).map(function(a){return nb.elementnew(a.element(),f)}).getOrThunk(function(){return nb.elementnew(m.gap(),!0)});g.push(k)}var j=nb.rowcells(g,h.all()[d].section());b.push(j)}return b},iX=function(c,a,d,b){d===b?my.remove(c,a):my.set(c,a,d)},kk=function(j,h){var f=[],c=[],d=function(i,a){var l;0<i.length?function(p,m){var q=a5.child(j,m).getOrThunk(function(){var n=jK.fromTag(m,iR.owner(j).dom());return id.append(j,n),n});m6.empty(q);var o=mZ(p,function(r){r.isNew()&&f.push(r.element());var n=r.element();return m6.empty(n),lW(r.cells(),function(s){s.isNew()&&c.push(s.element()),iX(s.element(),"colspan",s.colspan(),1),iX(s.element(),"rowspan",s.rowspan(),1),id.append(n,s.element())}),n});iV.append(q,o)}(i,a):(l=a,a5.child(j,l).each(m6.remove))},k=[],g=[],b=[];return lW(h,function(a){switch(a.section()){case"thead":k.push(a);break;case"tbody":g.push(a);break;case"tfoot":b.push(a)}}),d(k,"thead"),d(g,"tbody"),d(b,"tfoot"),{newRows:mW(f),newCells:mW(c)}},gV=function(a){return mZ(a,function(b){var c=js(b.element());return lW(b.cells(),function(f){var d=kJ(f.element());iX(d,"colspan",f.colspan(),1),iX(d,"rowspan",f.rowspan(),1),id.append(c,d)}),c})},m8=function(c,a){for(var d=[],b=0;b<c;b++){d.push(a(b))}return d},l1=function(c,a){for(var d=[],b=c;b<a;b++){d.push(b)}return d},jI=function(a,d){if(d<0||d>=a.length-1){return mz.none()}var c=a[d].fold(function(){var f=mP(a.slice(0,d));return eb(f,function(h,g){return h.map(function(i){return{value:i,delta:g+1}})})},function(f){return mz.some({value:f,delta:0})}),b=a[d+1].fold(function(){var f=a.slice(d+1);return eb(f,function(h,g){return h.map(function(i){return{value:i,delta:g+1}})})},function(f){return mz.some({value:f,delta:1})});return c.bind(function(e){return b.map(function(g){var f=g.delta+e.delta;return Math.abs(g.value-e.value)/f})})},kX=function(c,a,d){var b=c();return mI(b,a).orThunk(function(){return mz.from(b[0]).orThunk(d)}).map(function(f){return f.element()})},hQ=function(d){var c=d.grid(),a=l1(0,c.columns()),b=l1(0,c.rows());return mZ(a,function(e){return kX(function(){return mS(b,function(f){return aJ.getAt(d,f,e).filter(function(g){return g.column()===e}).fold(mW([]),function(g){return[g]})})},function(f){return 1===f.colspan()},function(){return aJ.getAt(d,0,e)})})},lw=function(d){var c=d.grid(),a=l1(0,c.rows()),b=l1(0,c.columns());return mZ(a,function(e){return kX(function(){return mS(b,function(f){return aJ.getAt(d,e,f).filter(function(g){return g.row()===e}).fold(mW([]),function(g){return[g]})})},function(f){return 1===f.rowspan()},function(){return aJ.getAt(d,e,0)})})},jw=function(d,b,g,c,f){var a=jK.fromTag("div");return k7.setAll(a,{position:"absolute",left:b-c/2+"px",top:g+"px",height:f+"px",width:c+"px"}),my.setAll(a,{"data-column":d,role:"presentation"}),a},kL=function(d,b,g,c,f){var a=jK.fromTag("div");return k7.setAll(a,{position:"absolute",left:b+"px",top:g-f/2+"px",height:f+"px",width:c+"px"}),my.setAll(a,{"data-row":d,role:"presentation"}),a},kA=function(b){var a=b.replace(/\./g,"-");return{resolve:function(c){return a+"-"+c}}},iL={resolve:kA("ephox-snooker").resolve},gy=function(b,a){var c=my.get(b,a);return c===undefined||""===c?[]:c.split(" ")},mO=gy,f1=function(c,a,d){var b=gy(c,a).concat([d]);return my.set(c,a,b.join(" ")),!0},e7=function(c,a,d){var b=mD(gy(c,a),function(f){return f!==d});return 0<b.length?my.set(c,a,b.join(" ")):my.remove(c,a),!1},fF=function(a){return mO(a,"class")},g6=function(b,a){return f1(b,"class",a)},cB=function(b,a){return e7(b,"class",a)},cj=fF,b3=g6,dv=cB,gJ=function(b,a){return mT(fF(b),a)?cB(b,a):g6(b,a)},gg=function(a){return a.dom().classList!==undefined},c8=function(b,a){return gg(b)&&b.dom().classList.contains(a)},h1={add:function(b,a){gg(b)?b.dom().classList.add(a):b3(b,a)},remove:function(b,a){var c;gg(b)?b.dom().classList.remove(a):dv(b,a),0===(gg(c=b)?c.dom().classList:cj(c)).length&&my.remove(c,"class")},toggle:function(b,a){return gg(b)?b.dom().classList.toggle(a):gJ(b,a)},toggler:function(j,q){var f,b,d,h,p,m,k=gg(j),g=j.dom().classList;return f=function(){k?g.remove(q):dv(j,q)},b=function(){k?g.add(q):b3(j,q)},d=c8(j,q),h=d||!1,{on:p=function(){b(),h=!0},off:m=function(){f(),h=!1},toggle:function(){(h?m:p)()},isOn:function(){return h}}},has:c8},jT=iL.resolve("resizer-bar"),cX=iL.resolve("resizer-rows"),eA=iL.resolve("resizer-cols"),hE=function(b){var a=b9.descendants(b.parent(),"."+jT);lW(a,m6.remove)},dG=function(d,b,a){var c=d.origin();lW(b,function(g,f){g.each(function(i){var h=a(c,i);h1.add(h,jT),id.append(d.parent(),h)})})},bb=function(B,G,q,b,k,x){var F,E,D,w,A=kU(G),H=0<q.length?k.positions(q,G):[];F=B,E=H,D=A,w=eQ(G),dG(F,E,function(c,a){var d=kL(a.row(),D.left()-c.left(),a.y()-c.top(),w,7);return h1.add(d,cX),d});var C,v,z,y,j=0<b.length?x.positions(b,G):[];C=B,v=j,z=A,y=fK(G),dG(C,v,function(c,a){var d=jw(a.col(),a.x()-c.left(),z.top()-c.top(),7,y);return h1.add(d,eA),d})},am=function(b,a){var c=b9.descendants(b.parent(),"."+jT);lW(c,a)},dR={refresh:function(h,f,k,g){hE(h);var j=eO(f),d=aJ.generate(j),c=lw(d),b=hQ(d);bb(h,f,c,b,k,g)},hide:function(a){am(a,function(b){k7.set(b,"display","none")})},show:function(a){am(a,function(b){k7.set(b,"display","block")})},destroy:hE,isRowBar:function(a){return h1.has(a,cX)},isColBar:function(a){return h1.has(a,eA)}},iA=function(b,a){return mZ(b,function(d){var c,f=(c=d.details(),eb(c,function(g){return iR.parent(g.element()).map(function(i){var h=iR.parent(i).isNone();return nb.elementnew(i,h)})}).getOrThunk(function(){return nb.elementnew(a.row(),!0)}));return nb.rowdatanew(f.element(),d.details(),d.section(),f.isNew())})},fQ=function(b,a){var c=i9(b,bJ.eq);return iA(c,a)},j4=function(b,a){var c=lN(mZ(b.all(),function(d){return d.cells()}));return mI(c,function(d){return bJ.eq(a,d.element())})},eL=function(d,h,b,g,e){return function(m,j,k,l,f){var c=eO(j),a=aJ.generate(c);return h(a,k).map(function(p){var i=ih(a,l,!1),q=d(i,p,bJ.eq,e(l)),o=fQ(q.grid(),l);return{grid:mW(o),cursor:q.cursor}}).fold(function(){return mz.none()},function(n){var i=kk(j,n.grid());return b(j,n.grid(),f),g(j),dR.refresh(m,j,g3.height,f),mz.some({cursor:n.cursor,newRows:i.newRows,newCells:i.newCells})})}},eW=fQ,bS=function(a,b){return eE.cell(b.element()).bind(function(c){return j4(a,c)})},bw=function(a,c){var d=mZ(c.selection(),function(f){return eE.cell(f).bind(function(g){return j4(a,g)})}),b=dZ(d);return 0<b.length?mz.some(b):mz.none()},fq=function(a,b){return eE.cell(b.element()).bind(function(c){return j4(a,c).map(function(d){return aW(d,{generators:b.generators,clipboard:b.clipboard})})})},aO=function(a,c){var d=mZ(c.selection(),function(f){return eE.cell(f).bind(function(g){return j4(a,g)})}),b=dZ(d);return 0<b.length?mz.some(aW({cells:b},{generators:c.generators,clipboard:c.clipboard})):mz.none()},aZ=function(b,a){return a.mergable()},d2=function(b,a){return a.unmergable()},eh=function(a){return{is:function(b){return a===b},isValue:lV,isError:l8,getOr:mW(a),getOrThunk:mW(a),getOrDie:mW(a),or:function(b){return eh(a)},orThunk:function(b){return eh(a)},fold:function(c,b){return b(a)},map:function(b){return eh(b(a))},each:function(b){b(a)},bind:function(b){return b(a)},exists:function(b){return b(a)},forall:function(b){return b(a)},toOption:function(){return mz.some(a)}}},bH=function(a){return{is:l8,isValue:l8,isError:lV,getOr:lG,getOrThunk:function(b){return b()},getOrDie:function(){return b=String(a),function(){throw new Error(b)}();var b},or:function(b){return b},orThunk:function(b){return b()},fold:function(c,b){return c(a)},map:function(b){return bH(a)},each:lC,bind:function(b){return bH(a)},exists:l8,forall:lV,toOption:mz.none}},cM={value:eh,error:bH},aD=function(b,a){return mZ(b,function(){return nb.elementnew(a.cell(),!0)})},k2=function(a,b,c){return a.concat(m8(b,function(d){return aA.setCells(a[a.length-1],aD(a[a.length-1].cells(),c))}))},g9=function(b,a,c){return mZ(b,function(d){return aA.setCells(d,d.cells().concat(aD(l1(0,a),c)))})},i2=function(f,c,h){if(f.row()>=c.length||f.column()>aA.cellLength(c[0])){return cM.error("invalid start address out of table bounds, row: "+f.row()+", column: "+f.column())}var d=c.slice(f.row()),g=d[0].cells().slice(f.column()),b=aA.cellLength(h[0]),a=h.length;return cM.value({rowDelta:mW(d.length-a),colDelta:mW(g.length-b)})},h4=function(c,a){var d=aA.cellLength(c[0]),b=aA.cellLength(a[0]);return{rowDelta:mW(0),colDelta:mW(d-b)}},iQ=function(c,a,d){var b=a.colDelta()<0?g9:lG;return(a.rowDelta()<0?k2:lG)(b(c,Math.abs(a.colDelta()),d),Math.abs(a.rowDelta()),d)},j9=function(d,b,g,c){if(0===d.length){return d}for(var f=b.startRow();f<=b.finishRow();f++){for(var a=b.startCol();a<=b.finishCol();a++){aA.mutateCell(d[f],a,nb.elementnew(c(),!1))}}return d},gM=function(h,f,k,g){for(var j=!0,d=0;d<h.length;d++){for(var c=0;c<aA.cellLength(h[0]);c++){var b=k(aA.getCellElement(h[d],c),f);!0===b&&!1===j?aA.mutateCell(h[d],c,nb.elementnew(g(),!0)):!0===b&&(j=!1)}}return h},m1=function(g,d,b,k){if(0<d&&d<g.length){var h=g[d-1].cells(),f=(j=b,mY(h,function(c,a){return mE(c,function(i){return j(i.element(),a.element())})?c:c.concat([a])},[]));lW(f,function(i){for(var a=mz.none(),m=d;m<g.length;m++){for(var c=0;c<aA.cellLength(g[0]);c++){var l=g[m].cells()[c];b(l.element(),i.element())&&(a.isNone()&&(a=mz.some(k())),a.each(function(n){aA.mutateCell(g[m],c,nb.elementnew(n,!0))}))}}})}var j;return g},lI=function(e,c,d,b,a){return i2(e,c,d).map(function(g){var f=iQ(c,g,b);return function(J,x,C,z,B){for(var F,q,N,L,E,I,y,K=J.row(),D=J.column(),H=K+C.length,G=D+aA.cellLength(C[0]),A=K;A<H;A++){for(var k=D;k<G;k++){F=x,q=A,N=k,L=B,I=E=void 0,E=aA.getCell(F[q],N),I=mA(L,E.element()),y=F[q],1<F.length&&1<aA.cellLength(y)&&(0<N&&I(aA.getCellElement(y,N-1))||N<y.length-1&&I(aA.getCellElement(y,N+1))||0<q&&I(aA.getCellElement(F[q-1],N))||q<F.length-1&&I(aA.getCellElement(F[q+1],N)))&&gM(x,aA.getCellElement(x[A],k),B,z.cell);var M=aA.getCellElement(C[A-K],k-D),j=z.replace(M);aA.mutateCell(x[A],k,nb.elementnew(j,!0))}}return x}(e,f,d,b,a)})},jB=function(h,m,f,b,d){m1(m,h,d,b.cell);var g=h4(f,m),l=iQ(f,g,b),k=h4(m,l),j=iQ(m,k,b);return j.slice(0,h).concat(l).concat(j.slice(h,j.length))},kQ=function(k,g,h,j,f){var d=k.slice(0,g),c=k.slice(g),b=aA.mapCells(k[h],function(i,a){return 0<g&&g<k.length&&j(aA.getCellElement(k[g-1],a),aA.getCellElement(k[g],a))?aA.getCell(k[g],a):nb.elementnew(f(i.element(),j),!0)});return d.concat([b]).concat(c)},hH=function(c,f,b,d,a){return mZ(c,function(h){var g=0<f&&f<aA.cellLength(h)&&d(aA.getCellElement(h,f-1),aA.getCellElement(h,f))?aA.getCell(h,f):nb.elementnew(a(aA.getCellElement(h,b),d),!0);return aA.addCell(h,f,g)})},lj=function(g,f,h,d,c){var b=h+1;return mZ(g,function(i,a){var j=a===f?nb.elementnew(c(aA.getCellElement(i,h),d),!0):aA.getCell(i,h);return aA.addCell(i,b,j)})},jj=function(h,m,f,b,d){var g=m+1,l=h.slice(0,g),k=h.slice(g),j=aA.mapCells(h[m],function(c,a){return a===f?nb.elementnew(d(c.element(),b),!0):c});return l.concat([j]).concat(k)},kF=function(b,a,c){return b.slice(0,a).concat(b.slice(c+1))},ks=function(c,d,b){var a=mZ(c,function(g){var f=g.cells().slice(0,d).concat(g.cells().slice(b+1));return nb.rowcells(f,g.section())});return mD(a,function(f){return 0<f.cells().length})},iF=function(b,d,a,c){return mZ(b,function(f){return aA.mapCells(f,function(h){return g=h,mE(d,function(i){return a(g.element(),i.element())})?nb.elementnew(c(h.element(),a),!0):h;var g})})},gk=function(c,a,d,b){return aA.getCellElement(c[a],d)!==undefined&&0<a&&b(aA.getCellElement(c[a-1],d),aA.getCellElement(c[a],d))},mw=function(b,a,c){return 0<a&&c(aA.getCellElement(b,a-1),aA.getCellElement(b,a))},fT=function(f,b,d,c){var a=mS(f,function(h,g){return gk(f,g,b,d)||mw(h,b,d)?[]:[aA.getCell(h,b)]});return iF(f,a,d,c)},eZ=function(g,c,f,d){var b=g[c],a=mS(b.cells(),function(i,h){return gk(g,c,h,f)||mw(b,h,f)?[]:[i]});return iF(g,a,f,d)},fx=function(a){return{fold:a}},gX=function(){return fx(function(c,a,f,b,d){return c()})},cv=function(a){return fx(function(d,b,g,c,f){return b(a)})},b8=function(b,a){return fx(function(f,c,h,d,g){return h(b,a)})},bX=function(d,c,b){return fx(function(g,a,i,f,h){return f(d,c,b)})},dh=function(b,a){return fx(function(f,c,h,d,g){return g(b,a)})},gA=function(m,w,j,v){var g,b,q=m.slice(0),d=(b=w,0===(g=m).length?gX():1===g.length?cv(0):0===b?b8(0,1):b===g.length-1?dh(b-1,b):0<b&&b<g.length-1?bX(b-1,b,b+1):gX()),p=function(a){return mZ(a,mW(0))},h=mW(p(q)),k=function(f,a){if(0<=j){var l=Math.max(v.minCellWidth(),q[a]-j);return p(q.slice(0,f)).concat([j,l-q[a]]).concat(p(q.slice(a+1)))}var c=Math.max(v.minCellWidth(),q[f]+j),i=q[f]-c;return p(q.slice(0,f)).concat([c-q[f],i]).concat(p(q.slice(a+1)))},x=k;return d.fold(h,function(a){return v.singleColumnWidth(q[a],j)},x,function(c,a,f){return k(a,f)},function(c,a){if(0<=j){return p(q.slice(0,a)).concat([j])}var f=Math.max(v.minCellWidth(),q[a]+j);return p(q.slice(0,a)).concat([f-q[a]])})},f3=function(b,a){return my.has(b,a)&&1<parseInt(my.get(b,a),10)},c2={hasColspan:function(a){return f3(a,"colspan")},hasRowspan:function(a){return f3(a,"rowspan")},minWidth:mW(10),minHeight:mW(10),getInt:function(b,a){return parseInt(k7.get(b,a),10)}},hS=function(b,a,c){return k7.getRaw(b,a).fold(function(){return c(b)+"px"},function(d){return d})},jN=function(a){return hS(a,"width",i6.getPixelWidth)},cR=function(a){return hS(a,"height",i6.getHeight)},eq=function(f,c,h,d,g){var b=hQ(f),a=mZ(b,function(i){return i.map(c.edge)});return mZ(b,function(j,i){return j.filter(lT(c2.hasColspan)).fold(function(){var k=jI(a,i);return d(k)},function(k){return h(k,g)})})},hv=function(a){return a.map(function(b){return b+"px"}).getOr("")},dA=function(d,b,g,c){var f=lw(d),a=mZ(f,function(h){return h.map(b.edge)});return mZ(f,function(i,h){return i.filter(lT(c2.hasRowspan)).fold(function(){var j=jI(a,h);return c(j)},function(j){return g(j)})})},a4={getRawWidths:function(b,a){return eq(b,a,jN,hv)},getPixelWidths:function(b,a,c){return eq(b,a,i6.getPixelWidth,function(d){return d.getOrThunk(c.minCellWidth)},c)},getPercentageWidths:function(b,a,c){return eq(b,a,i6.getPercentageWidth,function(d){return d.fold(function(){return c.minCellWidth()},function(f){return f/c.pixelWidth()*100})},c)},getPixelHeights:function(b,a){return dA(b,a,i6.getHeight,function(c){return c.getOrThunk(c2.minHeight)})},getRawHeights:function(b,a){return dA(b,a,cR,hv)}},ab=function(c,a,f){for(var b=0,d=c;d<a;d++){b+=f[d]!==undefined?f[d]:0}return b},dL=function(b,c){var a=aJ.justCells(b);return mZ(a,function(f){var d=ab(f.column(),f.column()+f.colspan(),c);return{element:f.element,width:mW(d),colspan:f.colspan}})},iq=function(b,c){var a=aJ.justCells(b);return mZ(a,function(f){var d=ab(f.row(),f.row()+f.rowspan(),c);return{element:f.element,height:mW(d),rowspan:f.rowspan}})},fH=function(a,b){return mZ(a.all(),function(d,c){return{element:d.element,height:mW(b[c])}})},jY=function(b){var a=parseInt(b,10),c=lG;return{width:mW(a),pixelWidth:mW(a),getWidths:a4.getPixelWidths,getCellDelta:c,singleColumnWidth:function(f,d){return[Math.max(c2.minWidth(),f+d)-f]},minCellWidth:c2.minWidth,setElementWidth:i6.setPixelWidth,setTableWidth:function(g,d,h){var f=mN(d,function(j,i){return j+i},0);i6.setPixelWidth(g,f)}}},eD=function(h,m){if(i6.percentageBasedSizeRegex().test(m)){var f=i6.percentageBasedSizeRegex().exec(m);return d=f[1],g=h,l=parseFloat(d),k=eG(g),{width:mW(l),pixelWidth:mW(k),getWidths:a4.getPercentageWidths,getCellDelta:function(a){return a/k*100},singleColumnWidth:function(c,a){return[100-c]},minCellWidth:function(){return c2.minWidth()/k*100},setElementWidth:i6.setPercentageWidth,setTableWidth:function(i,a,o){var c=l+o;i6.setPercentageWidth(i,c)}}}if(i6.pixelBasedSizeRegex().test(m)){var b=i6.pixelBasedSizeRegex().exec(m);return jY(b[1])}var d,g,l,k,j=eG(h);return jY(j)},eN=function(a){return i6.getRawWidth(a).fold(function(){var b=eG(a);return jY(b)},function(b){return eD(a,b)})},bK=function(a){return aJ.generate(a)},bk=function(b){var a=eO(b);return bK(a)},e9=function(m,v,g,b){var d=eN(m),j=d.getCellDelta(v),s=bk(m),q=d.getWidths(s,b,d),p=gA(q,g,j,d),h=mZ(p,function(c,a){return c+q[a]}),k=dL(s,h);lW(k,function(a){d.setElementWidth(a.element(),a.width())}),g===s.grid().columns()-1&&d.setTableWidth(m,h,j)},aI=function(j,f,b,q){var d=bk(j),h=a4.getPixelHeights(d,q),p=mZ(h,function(c,a){return b===a?Math.max(f+c,c2.minHeight()):c}),m=iq(d,p),k=fH(d,p);lW(k,function(a){i6.setHeight(a.element(),a.height())}),lW(m,function(a){i6.setHeight(a.element(),a.height())});var g=mN(p,function(c,a){return c+a},0);i6.setHeight(j,g)},aT=function(h,f,k){var g=eN(h),j=bK(f),d=g.getWidths(j,k,g),c=dL(j,d);lW(c,function(a){g.setElementWidth(a.element(),a.width())});var b=mN(d,function(i,a){return a+i},0);0<c.length&&g.setElementWidth(h,b)},dW=function(a){0===eE.cells(a).length&&m6.remove(a)},d7=mm("grid","cursor"),by=function(b,a,c){return cG(b,a,c).orThunk(function(){return cG(b,0,0)})},cG=function(b,a,c){return mz.from(b[a]).bind(function(d){return mz.from(d.cells()[c]).bind(function(f){return mz.from(f.element())})})},ax=function(b,a,c){return d7(b,cG(b,a,c))},lh=function(a){return mY(a,function(c,b){return mE(c,function(d){return d.row()===b.row()})?c:c.concat([b])},[]).sort(function(c,b){return c.row()-b.row()})},hA=function(a){return mY(a,function(c,b){return mE(c,function(d){return d.column()===b.column()})?c:c.concat([b])},[]).sort(function(c,b){return c.column()-b.column()})},jh=function(c,a,f){var b=bL(c,f),d=aJ.generate(b);return ih(d,a,!0)},ip=aT,i1={insertRowBefore:eL(function(f,c,h,d){var g=c.row(),b=c.row(),a=kQ(f,b,g,h,d.getOrInit);return ax(a,b,c.column())},bS,lC,lC,ex),insertRowsBefore:eL(function(h,f,k,g){var j=f[0].row(),d=f[0].row(),c=lh(f),b=mY(c,function(i,a){return kQ(i,d,j,k,g.getOrInit)},h);return ax(b,d,f[0].column())},bw,lC,lC,ex),insertRowAfter:eL(function(f,c,h,d){var g=c.row(),b=c.row()+c.rowspan(),a=kQ(f,b,g,h,d.getOrInit);return ax(a,b,c.column())},bS,lC,lC,ex),insertRowsAfter:eL(function(h,f,k,g){var j=lh(f),d=j[j.length-1].row(),c=j[j.length-1].row()+j[j.length-1].rowspan(),b=mY(j,function(i,a){return kQ(i,c,d,k,g.getOrInit)},h);return ax(b,c,f[0].column())},bw,lC,lC,ex),insertColumnBefore:eL(function(f,c,h,d){var g=c.column(),b=c.column(),a=hH(f,b,g,h,d.getOrInit);return ax(a,c.row(),b)},bS,ip,lC,ex),insertColumnsBefore:eL(function(h,f,k,g){var j=hA(f),d=j[0].column(),c=j[0].column(),b=mY(j,function(i,a){return hH(i,c,d,k,g.getOrInit)},h);return ax(b,f[0].row(),c)},bw,ip,lC,ex),insertColumnAfter:eL(function(f,c,h,d){var g=c.column(),b=c.column()+c.colspan(),a=hH(f,b,g,h,d.getOrInit);return ax(a,c.row(),b)},bS,ip,lC,ex),insertColumnsAfter:eL(function(h,f,k,g){var j=f[f.length-1].column(),d=f[f.length-1].column()+f[f.length-1].colspan(),c=hA(f),b=mY(c,function(i,a){return hH(i,d,j,k,g.getOrInit)},h);return ax(b,f[0].row(),d)},bw,ip,lC,ex),splitCellIntoColumns:eL(function(c,a,f,b){var d=lj(c,a.row(),a.column(),f,b.getOrInit);return ax(d,a.row(),a.column())},bS,ip,lC,ex),splitCellIntoRows:eL(function(c,a,f,b){var d=jj(c,a.row(),a.column(),f,b.getOrInit);return ax(d,a.row(),a.column())},bS,lC,lC,ex),eraseColumns:eL(function(f,c,h,d){var g=hA(c),b=ks(f,g[0].column(),g[g.length-1].column()),a=by(b,c[0].row(),c[0].column());return d7(b,a)},bw,ip,dW,ex),eraseRows:eL(function(f,c,h,d){var g=lh(c),b=kF(f,g[0].row(),g[g.length-1].row()),a=by(b,c[0].row(),c[0].column());return d7(b,a)},bw,lC,dW,ex),makeColumnHeader:eL(function(c,a,f,b){var d=fT(c,a.column(),f,b.replaceOrInit);return ax(d,a.row(),a.column())},bS,lC,lC,hB("row","th")),unmakeColumnHeader:eL(function(c,a,f,b){var d=fT(c,a.column(),f,b.replaceOrInit);return ax(d,a.row(),a.column())},bS,lC,lC,hB(null,"td")),makeRowHeader:eL(function(c,a,f,b){var d=eZ(c,a.row(),f,b.replaceOrInit);return ax(d,a.row(),a.column())},bS,lC,lC,hB("col","th")),unmakeRowHeader:eL(function(c,a,f,b){var d=eZ(c,a.row(),f,b.replaceOrInit);return ax(d,a.row(),a.column())},bS,lC,lC,hB(null,"td")),mergeCells:eL(function(d,b,g,c){var f=b.cells();fk(f);var a=j9(d,b.bounds(),g,mW(f[0]));return d7(a,mz.from(f[0]))},aZ,lC,lC,dD),unmergeCells:eL(function(c,a,f,b){var d=mN(a,function(h,g){return gM(h,g,f,b.combine(g))},c);return d7(d,mz.from(a[0]))},d2,ip,lC,dD),pasteCells:eL(function(j,f,q,b){var d,h,p,m,k=(d=f.clipboard(),h=f.generators(),p=eO(d),m=aJ.generate(p),ih(m,h,!0)),g=nb.address(f.row(),f.column());return lI(g,j,k,f.generators(),q).fold(function(){return d7(j,mz.some(f.element()))},function(c){var a=by(c,f.row(),f.column());return d7(c,a)})},fq,ip,lC,ex),pasteRowsBefore:eL(function(h,m,f,b){var d=h[m.cells[0].row()],g=m.cells[0].row(),l=jh(m.clipboard(),m.generators(),d),k=jB(g,h,l,m.generators(),f),j=by(k,m.cells[0].row(),m.cells[0].column());return d7(k,j)},aO,lC,lC,ex),pasteRowsAfter:eL(function(h,m,f,b){var d=h[m.cells[0].row()],g=m.cells[m.cells.length-1].row()+m.cells[m.cells.length-1].rowspan(),l=jh(m.clipboard(),m.generators(),d),k=jB(g,h,l,m.generators(),f),j=by(k,m.cells[0].row(),m.cells[0].column());return d7(k,j)},aO,lC,lC,ex)},kq=function(a){return jK.fromDom(a.getBody())},g2=function(a){return a.getBoundingClientRect().width},nh=function(a){return a.getBoundingClientRect().height},mg=function(a){return function(b){return bJ.eq(b,kq(a))}},jM=function(a){return/^[0-9]+$/.test(a)&&(a+="px"),a},k1=function(b){var a=b9.descendants(b,"td[data-mce-style],th[data-mce-style]");my.remove(b,"data-mce-style"),lW(a,function(c){my.remove(c,"data-mce-style")})},hX=function(a){return"rtl"===k7.get(a,"direction")?"rtl":"ltr"},lA={onDirection:function(a,b){return function(c){return"rtl"===hX(c)?b:a}},getDirection:hX},jA={isRtl:mW(!1)},kP={isRtl:mW(!0)},kE={directionAt:function(a){return"rtl"===lA.getDirection(a)?kP:jA}},iP=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],gF={"border-collapse":"collapse",width:"100%"},m0={border:"1"},f8=function(a){return a.getParam("table_cell_advtab",!0,"boolean")},fj=function(a){return a.getParam("table_row_advtab",!0,"boolean")},fM=function(a){return a.getParam("table_advtab",!0,"boolean")},hj=function(a){return a.getParam("table_style_by_css",!1,"boolean")},cF=function(a){return a.getParam("table_cell_class_list",[],"array")},cq=function(a){return a.getParam("table_row_class_list",[],"array")},b7=function(a){return a.getParam("table_class_list",[],"array")},dz=function(a){return !1===a.getParam("table_responsive_width")},gR=function(b,a){return b.fire("newrow",{node:a})},gs=function(b,a){return b.fire("newcell",{node:a})},dg=function(c,a,d,b){c.fire("ObjectResizeStart",{target:a,width:d,height:b})},h9=function(c,a,d,b){c.fire("ObjectResized",{target:a,width:d,height:b})},jX=function(d,g){var a,h=function(f){return"table"===jk.name(kq(f))},b=(a=d.getParam("table_clone_elements"),lF(a)?mz.some(a.split(/[ ,]/)):Array.isArray(a)?mz.some(a):mz.none()),c=function(i,f,j,e){return function(p,l){k1(p);var s=e(),m=jK.fromDom(d.getDoc()),q=cd(kE.directionAt),k=gb(j,m,b);return f(p)?i(s,p,l,k,q).bind(function(n){return lW(n.newRows(),function(o){gR(d,o.dom())}),lW(n.newCells(),function(o){gs(d,o.dom())}),n.cursor().map(function(r){var o=d.dom.createRng();return o.setStart(r.dom(),0),o.setEnd(r.dom(),0),o})}):mz.none()}};return{deleteRow:c(i1.eraseRows,function(i){var f=dm(i);return !1===h(d)||1<f.rows()},lC,g),deleteColumn:c(i1.eraseColumns,function(i){var f=dm(i);return !1===h(d)||1<f.columns()},lC,g),insertRowsBefore:c(i1.insertRowsBefore,lV,lC,g),insertRowsAfter:c(i1.insertRowsAfter,lV,lC,g),insertColumnsBefore:c(i1.insertColumnsBefore,lV,ib,g),insertColumnsAfter:c(i1.insertColumnsAfter,lV,ib,g),mergeCells:c(i1.mergeCells,lV,lC,g),unmergeCells:c(i1.unmergeCells,lV,lC,g),pasteRowsBefore:c(i1.pasteRowsBefore,lV,lC,g),pasteRowsAfter:c(i1.pasteRowsAfter,lV,lC,g),pasteCells:c(i1.pasteCells,lV,lC,g)}},c1=function(c,a,b){var f=eO(c),d=aJ.generate(f);return bw(d,a).map(function(h){var g=ih(d,b,!1).slice(h[0].row(),h[h.length-1].row()+h[h.length-1].rowspan()),i=eW(g,b);return gV(i)})},eH=tinymce.util.Tools.resolve("tinymce.util.Tools"),hM=function(b,a,c){c&&b.formatter.apply("align"+c,{},a)},dK=function(b,a,c){c&&b.formatter.apply("valign"+c,{},a)},bj=function(a,b){eH.each("left center right".split(" "),function(c){a.formatter.remove("align"+c,{},b)})},aw=function(a,b){eH.each("top middle bottom".split(" "),function(c){a.formatter.remove("valign"+c,{},b)})},dV=function(d,c,b){var a;return a=function(h,f){for(var i=0;i<f.length;i++){var g=d.getStyle(f[i],b);if(void 0===h&&(h=g),h!==g){return""}}return h}(a,d.select("td,th",c))},iE=function(d,b){var g=d.dom,c=b.control.rootControl,f=c.toJSON(),a=g.parseStyle(f.style);a["border-style"]=f.borderStyle,a["border-color"]=f.borderColor,a["background-color"]=f.backgroundColor,a.width=f.width?jM(f.width):"",a.height=f.height?jM(f.height):"",c.find("#style").value(g.serializeStyle(g.parseStyle(g.serializeStyle(a))))},fX=function(d,b){var g=d.dom,c=b.control.rootControl,f=c.toJSON(),a=g.parseStyle(f.style);c.find("#borderStyle").value(a["border-style"]||""),c.find("#borderColor").value(a["border-color"]||""),c.find("#backgroundColor").value(a["background-color"]||""),c.find("#width").value(a.width||""),c.find("#height").value(a.height||"")},j8={createStyleForm:function(b){var a=function(){var c=b.getParam("color_picker_callback");if(c){return function(d){return c.call(b,function(f){d.control.value(f).fire("change")},d.control.value())}}};return{title:"Advanced",type:"form",defaults:{onchange:mA(iE,b)},items:[{label:"Style",name:"style",type:"textbox",onchange:mA(fX,b)},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:mA(iE,b),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:a()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:a()}]}]}},buildListItems:function(c,b,a){var d=function(f,g){return g=g||[],eH.each(f,function(i){var h={text:i.text||i.title};i.menu?h.menu=d(i.menu):(h.value=i.value,b&&b(h)),g.push(h)}),g};return d(c,a||[])},updateStyleField:iE,extractAdvancedStyles:function(c,a){var d=c.parseStyle(c.getAttrib(a,"style")),b={};return d["border-style"]&&(b.borderStyle=d["border-style"]),d["border-color"]&&(b.borderColor=d["border-color"]),d["background-color"]&&(b.backgroundColor=d["background-color"]),b.style=c.serializeStyle(d),b},updateAdvancedFields:fX,syncAdvancedStyleFields:function(b,a){a.control.rootControl.find("#style")[0].getEl().isEqualNode(document.activeElement)?fX(b,a):iE(b,a)}},eS=function(g,j,h){var f,d=g.dom;function b(c,a,i){(1===j.length||i)&&d.setAttrib(c,a,i)}function k(c,a,i){(1===j.length||i)&&d.setStyle(c,a,i)}f8(g)&&j8.syncAdvancedStyleFields(g,h),f=h.control.rootControl.toJSON(),g.undoManager.transact(function(){eH.each(j,function(c){var a,i;b(c,"scope",f.scope),1===j.length?b(c,"style",f.style):(a=c,i=f.style,delete a.dataset.mceStyle,a.style.cssText+=";"+i),b(c,"class",f["class"]),k(c,"width",jM(f.width)),k(c,"height",jM(f.height)),f.type&&c.nodeName.toLowerCase()!==f.type&&(c=d.rename(c,f.type)),1===j.length&&(bj(g,c),aw(g,c)),f.align&&hM(g,c,f.align),f.valign&&dK(g,c,f.valign)}),g.focus()})},e3=function(q){var j,f,b,d=[];if(d=q.dom.select("td[data-mce-selected],th[data-mce-selected]"),j=q.dom.getParent(q.selection.getStart(),"td,th"),!d.length&&j&&d.push(j),j=j||d[0]){var h,p,m,k;1<d.length?f={width:"",height:"",scope:"","class":"",align:"",valign:"",style:"",type:j.nodeName.toLowerCase()}:(p=j,m=(h=q).dom,k={width:m.getStyle(p,"width")||m.getAttrib(p,"width"),height:m.getStyle(p,"height")||m.getAttrib(p,"height"),scope:m.getAttrib(p,"scope"),"class":m.getAttrib(p,"class"),type:p.nodeName.toLowerCase(),style:"",align:"",valign:""},eH.each("left center right".split(" "),function(a){h.formatter.matchNode(p,"align"+a)&&(k.align=a)}),eH.each("top middle bottom".split(" "),function(a){h.formatter.matchNode(p,"valign"+a)&&(k.valign=a)}),f8(h)&&eH.extend(k,j8.extractAdvancedStyles(m,p)),f=k),0<cF(q).length&&(b={name:"class",type:"listbox",label:"Class",values:j8.buildListItems(cF(q),function(a){a.value&&(a.textStyle=function(){return q.formatter.getCssText({block:"td",classes:[a.value]})})})});var g={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:mA(j8.updateStyleField,q)},{label:"Height",name:"height",onchange:mA(j8.updateStyleField,q)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},b]};f8(q)?q.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:f,body:[{title:"General",type:"form",items:g},j8.createStyleForm(q)],onsubmit:mA(eS,q,d)}):q.windowManager.open({title:"Cell properties",data:f,body:g,onsubmit:mA(eS,q,d)})}};function bW(j,c,l,k){var a=j.dom;function i(f,d,g){(1===c.length||g)&&a.setAttrib(f,d,g)}fj(j)&&j8.syncAdvancedStyleFields(j,k);var b=k.control.rootControl.toJSON();j.undoManager.transact(function(){eH.each(c,function(p){var w,g,d,f,m,v,s,q,h;i(p,"scope",b.scope),i(p,"style",b.style),i(p,"class",b["class"]),w=p,g="height",d=jM(b.height),(1===c.length||d)&&a.setStyle(w,g,d),b.type!==p.parentNode.nodeName.toLowerCase()&&(f=j.dom,m=p,v=b.type,s=f.getParent(m,"table"),q=m.parentNode,(h=f.select(v,s)[0])||(h=f.create(v),s.firstChild?"CAPTION"===s.firstChild.nodeName?f.insertAfter(h,s.firstChild):s.insertBefore(h,s.firstChild):s.appendChild(h)),h.appendChild(m),q.hasChildNodes()||f.remove(q)),b.align!==l.align&&(bj(j,p),hM(j,p,b.align))}),j.focus()})}var bD=function(y){var p,h,b,g,k,x,w,v,j,m,z=y.dom,q=[];p=z.getParent(y.selection.getStart(),"table"),h=z.getParent(y.selection.getStart(),"td,th"),eH.each(p.rows,function(a){eH.each(a.cells,function(c){if(z.getAttrib(c,"data-mce-selected")||c===h){return q.push(a),!1}})}),(b=q[0])&&(1<q.length?k={height:"",scope:"",style:"","class":"",align:"",type:b.parentNode.nodeName.toLowerCase()}:(v=b,j=(w=y).dom,m={height:j.getStyle(v,"height")||j.getAttrib(v,"height"),scope:j.getAttrib(v,"scope"),"class":j.getAttrib(v,"class"),align:"",style:"",type:v.parentNode.nodeName.toLowerCase()},eH.each("left center right".split(" "),function(a){w.formatter.matchNode(v,"align"+a)&&(m.align=a)}),fj(w)&&eH.extend(m,j8.extractAdvancedStyles(j,v)),k=m),0<cq(y).length&&(g={name:"class",type:"listbox",label:"Class",values:j8.buildListItems(cq(y),function(a){a.value&&(a.textStyle=function(){return y.formatter.getCssText({block:"tr",classes:[a.value]})})})}),x={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},g]},fj(y)?y.windowManager.open({title:"Row properties",data:k,bodyType:"tabpanel",body:[{title:"General",type:"form",items:x},j8.createStyleForm(y)],onsubmit:mA(bW,y,q,k)}):y.windowManager.open({title:"Row properties",data:k,body:x,onsubmit:mA(bW,y,q,k)}))},fB=tinymce.util.Tools.resolve("tinymce.Env"),aS={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},a3=function(m,w,g,b,d){void 0===d&&(d=aS);var j=jK.fromTag("table");k7.setAll(j,d.styles),my.setAll(j,d.attributes);var v=jK.fromTag("tbody");id.append(j,v);for(var q=[],p=0;p<m;p++){for(var h=jK.fromTag("tr"),k=0;k<w;k++){var x=p<g||k<b?jK.fromTag("th"):jK.fromTag("td");k<b&&my.set(x,"scope","row"),p<g&&my.set(x,"scope","col"),id.append(x,jK.fromTag("br")),d.percentages&&k7.set(x,"width",100/w+"%"),id.append(h,x)}q.push(h)}return iV.append(v,q),j},d6=function(a){return a.dom().innerHTML},ep=function(b){var a=jK.fromTag("div"),c=jK.fromDom(b.dom().cloneNode(!0));return id.append(a,c),d6(a)},bO=function(b,a){b.selection.select(a.dom(),!0),b.selection.collapse(!0)},cQ=function(d,h,m){var f,b,g=d.getParam("table_default_styles",gF,"object"),l={styles:g,attributes:(b=d,b.getParam("table_default_attributes",m0,"object")),percentages:(f=g.width,lF(f)&&-1!==f.indexOf("%")&&!dz(d))},k=a3(m,h,0,0,l);my.set(k,"data-mce-id","__mce");var j=ep(k);return d.insertContent(j),a5.descendant(kq(d),'table[data-mce-id="__mce"]').map(function(i){var a,o,c;return dz(d)&&k7.set(i,"width",k7.get(i,"width")),my.remove(i,"data-mce-id"),a=d,lW(b9.descendants(i,"tr"),function(n){gR(a,n.dom()),lW(b9.descendants(n,"th,td"),function(p){gs(a,p.dom())})}),o=d,c=i,a5.descendant(c,"td,th").each(mA(bO,o)),i.dom()}).getOr(null)};function aH(c,a,f,b){if("TD"===a.tagName||"TH"===a.tagName){c.setStyle(a,f,b)}else{if(a.children){for(var d=0;d<a.children.length;d++){aH(c,a.children[d],f,b)}}}}var lg=function(d,b,g){var c,f,a=d.dom;fM(d)&&j8.syncAdvancedStyleFields(d,g),!1===(f=g.control.rootControl.toJSON())["class"]&&delete f["class"],d.undoManager.transact(function(){b||(b=cQ(d,f.cols||1,f.rows||1)),function(p,l,s){var m,q=p.dom,k={},j={};if(k["class"]=s["class"],j.height=jM(s.height),q.getAttrib(l,"width")&&!hj(p)?k.width=(m=s.width)?m.replace(/px$/,""):"":j.width=jM(s.width),hj(p)?(j["border-width"]=jM(s.border),j["border-spacing"]=jM(s.cellspacing),eH.extend(k,{"data-mce-border-color":s.borderColor,"data-mce-cell-padding":s.cellpadding,"data-mce-border":s.border})):eH.extend(k,{border:s.border,cellpadding:s.cellpadding,cellspacing:s.cellspacing}),hj(p)&&l.children){for(var h=0;h<l.children.length;h++){aH(q,l.children[h],{"border-width":jM(s.border),"border-color":s.borderColor,padding:jM(s.cellpadding)})}}s.style?eH.extend(j,q.parseStyle(s.style)):j=eH.extend({},q.parseStyle(q.getAttrib(l,"style")),j),k.style=q.serializeStyle(j),q.setAttribs(l,k)}(d,b,f),(c=a.select("caption",b)[0])&&!f.caption&&a.remove(c),!c&&f.caption&&((c=a.create("caption")).innerHTML=fB.ie?"\xa0":'<br data-mce-bogus="1"/>',b.insertBefore(c,b.firstChild)),bj(d,b),f.align&&hM(d,b,f.align),d.focus(),d.addVisual()})},hz=function(A,v){var h,b,g,p,z,y,x,k,q,B,w=A.dom,j={};!0===v?(h=w.getParent(A.selection.getStart(),"table"))&&(x=h,k=(y=A).dom,q={width:k.getStyle(x,"width")||k.getAttrib(x,"width"),height:k.getStyle(x,"height")||k.getAttrib(x,"height"),cellspacing:k.getStyle(x,"border-spacing")||k.getAttrib(x,"cellspacing"),cellpadding:k.getAttrib(x,"data-mce-cell-padding")||k.getAttrib(x,"cellpadding")||dV(y.dom,x,"padding"),border:k.getAttrib(x,"data-mce-border")||k.getAttrib(x,"border")||dV(y.dom,x,"border"),borderColor:k.getAttrib(x,"data-mce-border-color"),caption:!!k.select("caption",x)[0],"class":k.getAttrib(x,"class")},eH.each("left center right".split(" "),function(a){y.formatter.matchNode(x,"align"+a)&&(q.align=a)}),fM(y)&&eH.extend(q,j8.extractAdvancedStyles(k,x)),j=q):(b={label:"Cols",name:"cols"},g={label:"Rows",name:"rows"}),0<b7(A).length&&(j["class"]&&(j["class"]=j["class"].replace(/\s*mce\-item\-table\s*/g,"")),p={name:"class",type:"listbox",label:"Class",values:j8.buildListItems(b7(A),function(a){a.value&&(a.textStyle=function(){return A.formatter.getCssText({block:"table",classes:[a.value]})})})}),z={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:(B=A,B.getParam("table_appearance_options",!0,"boolean")?[b,g,{label:"Width",name:"width",onchange:mA(j8.updateStyleField,A)},{label:"Height",name:"height",onchange:mA(j8.updateStyleField,A)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[b,g,{label:"Width",name:"width",onchange:mA(j8.updateStyleField,A)},{label:"Height",name:"height",onchange:mA(j8.updateStyleField,A)}])},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},p]},fM(A)?A.windowManager.open({title:"Table properties",data:j,bodyType:"tabpanel",body:[{title:"General",type:"form",items:z},j8.createStyleForm(A)],onsubmit:mA(lg,A,h)}):A.windowManager.open({title:"Table properties",data:j,body:z,onsubmit:mA(lg,A,h)})},jg=eH.each,im=function(q,w,p,h,g){var b=mg(q),k=function(){return jK.fromDom(q.dom.getParent(q.selection.getStart(),"th,td"))},x=function(a){return eE.table(a,b)},m=function(a){return{width:g2(a.dom()),height:g2(a.dom())}},e=function(a){var c=k();x(c).each(function(f){var l=dC.forMenu(h,f,c),d=m(f);a(f,l).each(function(u){var i,z,s,y;i=q,z=d,y=m(s=f),z.width===y.width&&z.height===y.height||(dg(i,s.dom(),z.width,z.height),h9(i,s.dom(),y.width,y.height)),q.selection.setRng(u),q.focus(),p.clear(f),k1(f)})})},j=function(a){var c=k();return x(c).bind(function(i){var d=jK.fromDom(q.getDoc()),l=dC.forMenu(h,i,c),f=gb(lC,d,mz.none());return c1(i,l,f)})},v=function(a){g.get().each(function(d){var f=mZ(d,function(i){return kJ(i)}),c=k();x(c).bind(function(i){var o=jK.fromDom(q.getDoc()),s=c6(o),l=dC.pasteRows(h,i,c,f,s);a(i,l).each(function(n){q.selection.setRng(n),q.focus(),p.clear(i)})})})};jg({mceTableSplitCells:function(){e(w.unmergeCells)},mceTableMergeCells:function(){e(w.mergeCells)},mceTableInsertRowBefore:function(){e(w.insertRowsBefore)},mceTableInsertRowAfter:function(){e(w.insertRowsAfter)},mceTableInsertColBefore:function(){e(w.insertColumnsBefore)},mceTableInsertColAfter:function(){e(w.insertColumnsAfter)},mceTableDeleteCol:function(){e(w.deleteColumn)},mceTableDeleteRow:function(){e(w.deleteRow)},mceTableCutRow:function(a){g.set(j()),e(w.deleteRow)},mceTableCopyRow:function(a){g.set(j())},mceTablePasteRowBefore:function(a){v(w.pasteRowsBefore)},mceTablePasteRowAfter:function(a){v(w.pasteRowsAfter)},mceTableDelete:function(){var a=jK.fromDom(q.dom.getParent(q.selection.getStart(),"th,td"));eE.table(a,b).filter(lT(b)).each(function(d){var c=jK.fromText("");id.after(d,c),m6.remove(d);var f=q.dom.createRng();f.setStart(c.dom(),0),f.setEnd(c.dom(),0),q.selection.setRng(f)})}},function(c,a){q.addCommand(a,c)}),jg({mceInsertTable:mA(hz,q),mceTableProps:mA(hz,q,!0),mceTableRowProps:mA(bD,q),mceTableCellProps:mA(e3,q)},function(c,a){q.addCommand(a,function(f,d){c(d)})})},i0=function(b){var a=mz.from(b.dom().documentElement).map(jK.fromDom).getOr(b);return{parent:mW(a),view:mW(b),origin:mW(m5(0,0))}},kp=function(b,a){return{parent:mW(a),view:mW(b),origin:mW(m5(0,0))}};function g1(b){var c=mm.apply(null,b),a=[];return{bind:function(d){if(d===undefined){throw"Event bind error: undefined handler"}a.push(d)},unbind:function(d){a=mD(a,function(f){return f!==d})},trigger:function(){var d=c.apply(null,arguments);lW(a,function(f){f(d)})}}}var ng={create:function(a){return{registry:mQ(a,function(b){return{bind:b.bind,unbind:b.unbind}}),trigger:mQ(a,function(b){return b.trigger})}}},mb={mode:hY(["compare","extract","mutate","sink"]),sink:hY(["element","start","stop","destroy"]),api:hY(["forceDrop","drop","move","delayDrop"])},jL={resolve:kA("ephox-dragster").resolve},k0=function(a,b){return function(q){if(a(q)){var z,j,g,h,m,y,x,w=jK.fromDom(q.target),k=function(){q.stopPropagation()},p=function(){q.preventDefault()},A=lD(p,k),v=(z=w,j=q.clientX,g=q.clientY,h=k,m=p,y=A,x=q,{target:mW(z),x:mW(j),y:mW(g),stop:h,prevent:m,kill:y,raw:mW(x)});b(v)}}},hW=function(d,b,g,c,f){var a=k0(g,c);return d.dom().addEventListener(b,a,f),{unbind:mA(lz,d,b,a,f)}},lz=function(c,a,d,b){c.dom().removeEventListener(a,d,b)},jz=function(c,a,d,b){return hW(c,a,d,b,!1)},kO=function(c,a,d,b){return hW(c,a,d,b,!0)},kD=mW(!0),iO={bind:function(b,a,c){return jz(b,a,kD,c)},capture:function(b,a,c){return kO(b,a,kD,c)}},gE=mb.mode({compare:function(b,a){return m5(a.left()-b.left(),a.top()-b.top())},extract:function(a){return mz.some(m5(a.x(),a.y()))},sink:function(j,q){var f,b,d,h=(f=q,b=aW({layerClass:jL.resolve("blocker")},f),d=jK.fromTag("div"),my.set(d,"role","presentation"),k7.setAll(d,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),h1.add(d,jL.resolve("blocker")),h1.add(d,b.layerClass),{element:function(){return d},destroy:function(){m6.remove(d)}}),p=iO.bind(h.element(),"mousedown",j.forceDrop),m=iO.bind(h.element(),"mouseup",j.drop),k=iO.bind(h.element(),"mousemove",j.move),g=iO.bind(h.element(),"mouseout",j.delayDrop);return mb.sink({element:h.element,start:function(a){id.append(a,h.element())},stop:function(){m6.remove(h.element())},destroy:function(){h.destroy(),m.unbind(),k.unbind(),g.unbind(),p.unbind()}})},mutate:function(b,a){b.mutate(a.left(),a.top())}});function mX(){var b=mz.none(),a=ng.create({move:g1(["info"])});return{onEvent:function(c,d){d.extract(c).each(function(h){var f,i,g;(f=d,i=h,g=b.map(function(j){return f.compare(j,i)}),b=mz.some(i),g).each(function(j){a.trigger.move(j)})})},reset:function(){b=mz.none()},events:a.registry}}function f7(){var b={onEvent:function(f,d){},reset:lC},a=mX(),c=b;return{on:function(){c.reset(),c=a},off:function(){c.reset(),c=b},isOn:function(){return c===a},onEvent:function(f,d){c.onEvent(f,d)},events:a.events}}var fh=function(y,h,p){var b,g,k,x=!1,w=ng.create({start:g1([]),stop:g1([])}),v=f7(),j=function(){q.stop(),v.isOn()&&(v.off(),w.trigger.stop())},m=(b=j,g=200,k=null,{cancel:function(){null!==k&&(clearTimeout(k),k=null)},throttle:function(){for(var c=[],a=0;a<arguments.length;a++){c[a]=arguments[a]}null!==k&&clearTimeout(k),k=setTimeout(function(){b.apply(null,c),k=null},g)}});v.events.move.bind(function(a){h.mutate(y,a.info())});var z=function(a){return function(){var c=Array.prototype.slice.call(arguments,0);if(x){return a.apply(null,c)}}},q=h.sink(mb.api({forceDrop:j,drop:z(j),move:z(function(c,a){m.cancel(),v.onEvent(c,h)}),delayDrop:z(m.throttle)}),p);return{element:q.element,go:function(a){q.start(a),v.on(),w.trigger.start()},on:function(){x=!0},off:function(){x=!1},destroy:function(){q.destroy()},events:w.registry}},fL={transform:function(c,a){var d=a!==undefined?a:{},b=d.mode!==undefined?d.mode:gE;return fh(c,b,a)}};function hg(){var d,a=ng.create({drag:g1(["xDelta","yDelta","target"])}),c=mz.none(),b={mutate:function(g,f){d.trigger.drag(g,f)},events:(d=ng.create({drag:g1(["xDelta","yDelta"])})).registry};return b.events.drag.bind(function(e){c.each(function(f){a.trigger.drag(e.xDelta(),e.yDelta(),f)})}),{assign:function(f){c=mz.some(f)},get:function(){return c},mutate:b.mutate,events:a.registry}}var cE={any:function(a){return a5.first(a).isSome()},ancestor:function(b,a,c){return a5.ancestor(b,a,c).isSome()},sibling:function(b,a){return a5.sibling(b,a).isSome()},child:function(b,a){return a5.child(b,a).isSome()},descendant:function(b,a){return a5.descendant(b,a).isSome()},closest:function(b,a,c){return a5.closest(b,a,c).isSome()}},cp=iL.resolve("resizer-bar-dragging");function b6(c,f){var b=g3.height,a=function(h,z,m){var j=hg(),g=fL.transform(j,{}),y=mz.none(),q=function(l,i){return mz.from(my.get(l,i))};j.events.drag.bind(function(e){q(e.target(),"data-row").each(function(l){var i=c2.getInt(e.target(),"top");k7.set(e.target(),"top",i+e.yDelta()+"px")}),q(e.target(),"data-column").each(function(l){var i=c2.getInt(e.target(),"left");k7.set(e.target(),"left",i+e.xDelta()+"px")})});var x=function(l,i){return c2.getInt(l,i)-parseInt(my.get(l,"data-initial-"+i),10)};g.events.stop.bind(function(){j.get().each(function(e){y.each(function(i){q(e,"data-row").each(function(n){var l=x(e,"top");my.remove(e,"data-initial-top"),v.trigger.adjustHeight(i,l,parseInt(n,10))}),q(e,"data-column").each(function(n){var l=x(e,"left");my.remove(e,"data-initial-left"),v.trigger.adjustWidth(i,l,parseInt(n,10))}),dR.refresh(h,i,m,z)})})});var w=function(l,i){v.trigger.startAdjust(),j.assign(l),my.set(l,"data-initial-"+i,parseInt(k7.get(l,i),10)),h1.add(l,cp),k7.set(l,"opacity","0.2"),g.go(h.parent())},k=iO.bind(h.parent(),"mousedown",function(i){dR.isRowBar(i.target())&&w(i.target(),"top"),dR.isColBar(i.target())&&w(i.target(),"left")}),p=function(i){return bJ.eq(i,h.view())},A=iO.bind(h.view(),"mouseover",function(i){"table"===jk.name(i.target())||cE.closest(i.target(),"table",p)?(y="table"===jk.name(i.target())?mz.some(i.target()):a5.ancestor(i.target(),"table",p)).each(function(l){dR.refresh(h,l,m,z)}):fy.inBody(i.target())&&dR.destroy(h)}),v=ng.create({adjustHeight:g1(["table","delta","row"]),adjustWidth:g1(["table","delta","column"]),startAdjust:g1([])});return{destroy:function(){k.unbind(),A.unbind(),g.destroy(),dR.destroy(h)},refresh:function(i){dR.refresh(h,i,m,z)},on:g.on,off:g.off,hideBars:mA(dR.hide,h),showBars:mA(dR.show,h),events:v.registry}}(c,f,b),d=ng.create({beforeResize:g1(["table"]),afterResize:g1(["table"]),startDrag:g1([])});return a.events.adjustHeight.bind(function(h){d.trigger.beforeResize(h.table());var g=b.delta(h.delta(),h.table());aI(h.table(),g,h.row(),b),d.trigger.afterResize(h.table())}),a.events.startAdjust.bind(function(g){d.trigger.startDrag()}),a.events.adjustWidth.bind(function(h){d.trigger.beforeResize(h.table());var g=f.delta(h.delta(),h.table());e9(h.table(),g,h.column(),f),d.trigger.afterResize(h.table())}),{on:a.on,off:a.off,hideBars:a.hideBars,showBars:a.showBars,destroy:a.destroy,events:d.registry}}var dy=function(b,a){return b.inline?kp(kq(b),(c=jK.fromTag("div"),k7.setAll(c,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),id.append(fy.body(),c),c)):i0(jK.fromDom(b.getDoc()));var c},gP=function(b,a){b.inline&&m6.remove(a.parent())},gp=function(e){var d,m,k=mz.none(),g=mz.none(),b=mz.none(),j=/(\d+(\.\d+)?)%/,h=function(a){return"TABLE"===a.nodeName};return e.on("init",function(){var f,a=cd(kE.directionAt),i=dy(e);if(b=mz.some(i),("table"===(f=e.getParam("object_resizing",!0))||f)&&e.getParam("table_resize_bars",!0,"boolean")){var c=b6(i,a);c.on(),c.events.startDrag.bind(function(l){k=mz.some(e.selection.getRng())}),c.events.beforeResize.bind(function(n){var l=n.table().dom();dg(e,l,g2(l),nh(l))}),c.events.afterResize.bind(function(o){var l=o.table(),p=l.dom();k1(l),k.each(function(n){e.selection.setRng(n),e.focus()}),h9(e,p,g2(p),nh(p)),e.undoManager.add()}),g=mz.some(c)}}),e.on("ObjectResizeStart",function(c){var a,f=c.target;h(f)&&(d=c.width,a=f,m=e.dom.getStyle(a,"width")||e.dom.getAttrib(a,"width"))}),e.on("ObjectResized",function(l){var c=l.target;if(h(c)){var q=c;if(j.test(m)){var f=parseFloat(j.exec(m)[1]),p=l.width*f/d;e.dom.setStyle(q,"width",p+"%")}else{var a=[];eH.each(q.rows,function(i){eH.each(i.cells,function(o){var n=e.dom.getStyle(o,"width",!0);a.push({cell:o,width:n})})}),eH.each(a,function(i){e.dom.setStyle(i.cell,"width",i.width),e.dom.setAttrib(i.cell,"width",null)})}}}),{lazyResize:function(){return g},lazyWire:function(){return b.getOr(i0(jK.fromDom(e.getBody())))},destroy:function(){g.each(function(a){a.destroy()}),b.each(function(a){gP(e,a)})}}},dd=function(a){return{fold:a}},h7=function(a){return dd(function(d,b,f,c){return d(a)})},jW=function(a){return dd(function(d,b,f,c){return b(a)})},c0=function(b,a){return dd(function(f,c,g,d){return g(b,a)})},eF=function(a){return dd(function(d,b,f,c){return c(a)})},hK=function(b,a){return eE.table(b,a).bind(function(d){var c=eE.cells(d);return mp(c,function(f){return bJ.eq(b,f)}).map(function(f){return{index:mW(f),all:mW(c)}})})},dJ=function(a,b){return hK(a,b).fold(function(){return h7(a)},function(c){return c.index()+1<c.all().length?c0(a,c.all()[c.index()+1]):eF(a)})},bh=function(a,b){return hK(a,b).fold(function(){return h7()},function(c){return 0<=c.index()-1?c0(a,c.all()[c.index()-1]):jW(a)})},av=dk([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),dU={before:av.before,on:av.on,after:av.after,cata:function(c,a,d,b){return c.fold(a,d,b)},getStart:function(a){return a.fold(lG,lG,lG)}},iD=dk([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),fV=mm("start","soffset","finish","foffset"),j7={domRange:iD.domRange,relative:iD.relative,exact:iD.exact,exactFromRange:function(a){return iD.exact(a.start(),a.soffset(),a.finish(),a.foffset())},range:fV,getWin:function(b){var a=b.match({domRange:function(c){return jK.fromDom(c.startContainer)},relative:function(d,c){return dU.getStart(d)},exact:function(f,c,g,d){return f}});return iR.defaultView(a)}},eR=function(c,a,f,b){var d=iR.owner(c).dom().createRange();return d.setStart(c.dom(),a),d.setEnd(f.dom(),b),d},e1=function(d,b,g,c){var f=eR(d,b,g,c),a=bJ.eq(d,g)&&b===c;return f.collapsed&&!a},bV=function(b,a){b.selectNodeContents(a.dom())},bC=function(a){a.deleteContents()},fz=function(a){return{left:mW(a.left),top:mW(a.top),right:mW(a.right),bottom:mW(a.bottom),width:mW(a.width),height:mW(a.height)}},aR={create:function(a){return a.document.createRange()},replaceWith:function(b,a){bC(b),b.insertNode(a.dom())},selectNodeContents:function(b,a){var c=b.document.createRange();return bV(c,a),c},selectNodeContentsUsing:bV,relativeToNative:function(d,b,g){var c,f,a=d.document.createRange();return c=a,b.fold(function(h){c.setStartBefore(h.dom())},function(i,h){c.setStart(i.dom(),h)},function(h){c.setStartAfter(h.dom())}),f=a,g.fold(function(h){f.setEndBefore(h.dom())},function(i,h){f.setEnd(i.dom(),h)},function(h){f.setEndAfter(h.dom())}),a},exactToNative:function(d,b,g,c,f){var a=d.document.createRange();return a.setStart(b.dom(),g),a.setEnd(c.dom(),f),a},deleteContents:bC,cloneFragment:function(b){var a=b.cloneContents();return jK.fromDom(a)},getFirstRect:function(b){var a=b.getClientRects(),c=0<a.length?a[0]:b.getBoundingClientRect();return 0<c.width||0<c.height?mz.some(c).map(fz):mz.none()},getBounds:function(b){var a=b.getBoundingClientRect();return 0<a.width||0<a.height?mz.some(a).map(fz):mz.none()},isWithin:function(b,a){return a.compareBoundaryPoints(b.END_TO_START,b)<1&&-1<a.compareBoundaryPoints(b.START_TO_END,b)},toString:function(a){return a.toString()}},a2=dk([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),d5=function(b,a,c){return a(jK.fromDom(c.startContainer),c.startOffset,jK.fromDom(c.endContainer),c.endOffset)},em=function(d,b){var f,g,c,a=(f=d,b.match({domRange:function(h){return{ltr:mW(h),rtl:mz.none}},relative:function(i,h){return{ltr:g8(function(){return aR.relativeToNative(f,i,h)}),rtl:g8(function(){return mz.some(aR.relativeToNative(f,h,i))})}},exact:function(j,h,k,i){return{ltr:g8(function(){return aR.exactToNative(f,j,h,k,i)}),rtl:g8(function(){return mz.some(aR.exactToNative(f,k,i,j,h))})}}}));return(c=(g=a).ltr()).collapsed?g.rtl().filter(function(h){return !1===h.collapsed}).map(function(h){return a2.rtl(jK.fromDom(h.endContainer),h.endOffset,jK.fromDom(h.startContainer),h.startOffset)}).getOrThunk(function(){return d5(0,a2.ltr,c)}):d5(0,a2.ltr,c)},bM={ltr:a2.ltr,rtl:a2.rtl,diagnose:em,asLtrRange:function(a,b){return em(a,b).match({ltr:function(f,c,h,d){var g=a.document.createRange();return g.setStart(f.dom(),c),g.setEnd(h.dom(),d),g},rtl:function(f,c,h,d){var g=a.document.createRange();return g.setStart(h.dom(),d),g.setEnd(f.dom(),c),g}})}},cP=function(b,a,c){return a>=b.left&&a<=b.right&&c>=b.top&&c<=b.bottom},aG=function(h,m,f,b,d){if(0===d){return 0}if(m===b){return d-1}for(var g=b,l=1;l<d;l++){var k=h(l),j=Math.abs(m-k.left);if(f<=k.bottom){if(f<k.top||g<j){return l-1}g=j}}return 0},k8={locate:function(a,g,c,i){var h=a.dom().createRange();h.selectNode(g.dom());var b=h.getClientRects();return eb(b,function(d){return cP(d,c,i)?mz.some(d):mz.none()}).map(function(l){return j=a,s=c,f=i,k=l,q=function(o){var n=j.dom().createRange();return n.setStart(d.dom(),o),n.collapse(!0),n},p=gw.get(d=g).length,m=aG(function(n){return q(n).getBoundingClientRect()},s,f,k.right,p),q(m);var j,d,s,f,k,q,p,m})}},hp=function(b,d,g,c){var f=b.dom().createRange(),a=iR.children(d);return eb(a,function(h){return f.selectNode(h.dom()),cP(f.getBoundingClientRect(),g,c)?i8(b,h,g,c):mz.none()})},i8=function(c,a,d,b){return(jk.isText(a)?k8.locate:hp)(c,a,d,b)},ig=function(h,f,k,g){var j=h.dom().createRange();j.selectNode(f.dom());var d=j.getBoundingClientRect(),c=Math.max(d.left,Math.min(d.right,k)),b=Math.max(d.top,Math.min(d.bottom,g));return i8(h,f,c,b)},iW=function(b,a){return a-b.left<b.right-a},kj=function(c,a,d){var b=c.dom().createRange();return b.selectNode(a.dom()),b.collapse(d),b},gU=function(b,d,g){var c=b.dom().createRange();c.selectNode(d.dom());var f=c.getBoundingClientRect(),a=iW(f,g);return(!0===a?cz.first:cz.last)(d).map(function(h){return kj(b,h,a)})},m7=function(c,a,f){var b=a.dom().getBoundingClientRect(),d=iW(b,f);return mz.some(kj(c,a,d))},lX=function(b,a,c){return(0===iR.children(a).length?m7:gU)(b,a,c)},jH=document.caretPositionFromPoint?function(c,b,a){return mz.from(c.dom().caretPositionFromPoint(b,a)).bind(function(f){if(null===f.offsetNode){return mz.none()}var d=c.dom().createRange();return d.setStart(f.offsetNode,f.offset),d.collapse(),mz.some(d)})}:document.caretRangeFromPoint?function(b,a,c){return mz.from(b.dom().caretRangeFromPoint(a,c))}:function(c,a,b){return jK.fromPoint(c,a,b).bind(function(f){var d=function(){return lX(c,f,a)};return 0===iR.children(f).length?d():function(m,k,q,l){var p=m.dom().createRange();p.selectNode(k.dom());var j=p.getBoundingClientRect(),h=Math.max(j.left,Math.min(j.right,q)),g=Math.max(j.top,Math.min(j.bottom,l));return ig(m,k,h,g)}(c,f,a,b).orThunk(d)})},kW=function(c,a,d){var b=jK.fromDom(c.document);return jH(b,a,d).map(function(f){return j7.range(jK.fromDom(f.startContainer),f.startOffset,jK.fromDom(f.endContainer),f.endOffset)})},hP=function(b,a){var c=jk.name(b);return"input"===c?dU.after(b):mT(["br","img"],c)?0===a?dU.before(b):dU.after(b):dU.on(b,a)},lv=function(c,a){var d=c.fold(dU.before,hP,dU.after),b=a.fold(dU.before,hP,dU.after);return j7.relative(d,b)},jv=function(d,b,g,c){var f=hP(d,b),a=hP(g,c);return j7.relative(f,a)},kK=function(a){return a.match({domRange:function(c){var b=jK.fromDom(c.startContainer),d=jK.fromDom(c.endContainer);return jv(b,c.startOffset,d,c.endOffset)},relative:lv,exact:jv})},kz=lv,iK=jv,gx=function(b,a){mz.from(b.getSelection()).each(function(c){c.removeAllRanges(),c.addRange(a)})},mK=function(d,b,g,c,f){var a=aR.exactToNative(d,b,g,c,f);gx(d,a)},f0=function(a,b){return bM.diagnose(a,b).match({ltr:function(f,c,g,d){mK(a,f,c,g,d)},rtl:function(p,w,h,d){var g,k,v,s,q,j=a.getSelection();if(j.setBaseAndExtent){j.setBaseAndExtent(p.dom(),w,h.dom(),d)}else{if(j.extend){try{k=p,v=w,s=h,q=d,(g=j).collapse(k.dom(),v),g.extend(s.dom(),q)}catch(m){mK(a,h,d,p,w)}}else{mK(a,h,d,p,w)}}}})},e6=function(b){var a=jK.fromDom(b.anchorNode),c=jK.fromDom(b.focusNode);return e1(a,b.anchorOffset,c,b.focusOffset)?mz.some(j7.range(jK.fromDom(b.anchorNode),b.anchorOffset,jK.fromDom(b.focusNode),b.focusOffset)):function(f){if(0<f.rangeCount){var d=f.getRangeAt(0),g=f.getRangeAt(f.rangeCount-1);return mz.some(j7.range(jK.fromDom(d.startContainer),d.startOffset,jK.fromDom(g.endContainer),g.endOffset))}return mz.none()}(b)},fE=function(a){return mz.from(a.getSelection()).filter(function(b){return 0<b.rangeCount}).bind(e6)},g5=function(d,b,g,c,f){var a=iK(b,g,c,f);f0(d,a)},cA=function(a){return fE(a).map(function(b){return j7.exact(b.start(),b.soffset(),b.finish(),b.foffset())})},ch=function(c,a,d){var b=kz(a,d);f0(c,b)},b2=function(b){var c=j7.getWin(b).dom(),a=function(h,f,i,g){return aR.exactToNative(c,h,f,i,g)},d=kK(b);return bM.diagnose(c,d).match({ltr:a,rtl:a})},dq=function(b,a){var c=aR.selectNodeContents(b,a);gx(b,c)},gI=function(a){a.getSelection().removeAllRanges()},gd=function(b,a){var c=bM.asLtrRange(b,a);return aR.getFirstRect(c)},c7=function(b,a,c){return kW(b,a,c)},h0=tinymce.util.Tools.resolve("tinymce.util.VK"),jS=function(c,a,d,b){return dF(c,a,dJ(d),b)},cW=function(c,a,d,b){return dF(c,a,bh(d),b)},ez=function(b,a){var c=j7.exact(a,0,a,0);return b2(c)},hD=function(c,a){var d,b=b9.descendants(a,"tr");return(d=b,0===d.length?mz.none():mz.some(d[d.length-1])).bind(function(f){return a5.descendant(f,"td,th").map(function(g){return ez(0,g)})})},dF=function(b,c,a,d,f){return a.fold(mz.none,mz.none,function(h,g){return cz.first(g).map(function(i){return ez(0,i)})},function(e){return eE.table(e,c).bind(function(h){var g=dC.noMenu(e);return b.undoManager.transact(function(){d.insertRowsAfter(h,g)}),hD(0,h)})})},a9=["table","li","dl"],ak=function(f,k,g,j){if(f.keyCode===h0.TAB){var d=kq(k),c=function(i){var a=jk.name(i);return bJ.eq(i,d)||mT(a9,a)},h=k.selection.getRng();if(h.collapsed){var b=jK.fromDom(h.startContainer);eE.cell(b,c).each(function(a){f.preventDefault(),(f.shiftKey?cW:jS)(k,c,a,g,j).each(function(i){k.selection.setRng(i)})})}}},dQ={response:mm("selection","kill")},iz=function(a){return function(b){return b===a}},fP=iz(38),j3=iz(40),eK={ltr:{isBackward:iz(37),isForward:iz(39)},rtl:{isBackward:iz(39),isForward:iz(37)},isUp:fP,isDown:j3,isNavigation:function(a){return 37<=a&&a<=40}},eV=function(b,a){var c=bM.asLtrRange(b,a);return{start:mW(jK.fromDom(c.startContainer)),soffset:mW(c.startOffset),finish:mW(jK.fromDom(c.endContainer)),foffset:mW(c.endOffset)}},bR=function(c,a,d,b){return{start:mW(dU.on(c,a)),finish:mW(dU.on(d,b))}},bv=(a1.detect().browser.isSafari(),function(c){var a=c!==undefined?c.dom():document,d=a.body.scrollLeft||a.documentElement.scrollLeft,b=a.body.scrollTop||a.documentElement.scrollTop;return m5(d,b)}),fp=bv,aN=function(b,a,c){(c!==undefined?c.dom():document).defaultView.scrollBy(b,a)};function aY(a){return{elementFromPoint:function(c,b){return jK.fromPoint(jK.fromDom(a.document),c,b)},getRect:function(b){return b.dom().getBoundingClientRect()},getRangedRect:function(d,b,g,c){var f=j7.exact(d,b,g,c);return gd(a,f).map(function(h){return mQ(h,md)})},getSelection:function(){return cA(a).map(function(b){return eV(a,b)})},fromSitus:function(c){var b=j7.relative(c.start(),c.finish());return eV(a,b)},situsFromPoint:function(c,b){return c7(a,c,b).map(function(d){return{start:mW(dU.on(d.start(),d.soffset())),finish:mW(dU.on(d.finish(),d.foffset()))}})},clearSelection:function(){gI(a)},setSelection:function(b){g5(a,b.start(),b.soffset(),b.finish(),b.foffset())},setRelativeSelection:function(c,b){ch(a,c,b)},selectContents:function(b){dq(a,b)},getInnerHeight:function(){return a.innerHeight},getScrollY:function(){return fp(jK.fromDom(a.document)).top()},scrollBy:function(c,b){aN(c,b,jK.fromDom(a.document))}}}var d1=function(f,c,b,a,d){return bJ.eq(b,a)?mz.none():iH(b,a,c).bind(function(h){var g=h.boxes().getOr([]);return 0<g.length?(d(f,g,h.start(),h.finish()),mz.some(dQ.response(mz.some(bR(b,0,b,e5(b))),!0))):mz.none()})},eg={sync:function(h,d,f,c,g,b,a){return bJ.eq(f,g)&&c===b?mz.none():a5.closest(f,"td,th",d).bind(function(e){return a5.closest(g,"td,th",d).bind(function(i){return d1(h,d,e,i,a)})})},detect:d1,update:function(c,a,f,b,d){return mB(b,c,a,d.firstSelectedSelector(),d.lastSelectedSelector()).map(function(g){return d.clear(f),d.selectRange(f,g.boxes(),g.start(),g.finish()),g.boxes()})}},bG=ld(["left","top","right","bottom"],[]),cL={nu:bG,moveUp:function(b,a){return bG({left:b.left(),top:b.top()-a,right:b.right(),bottom:b.bottom()-a})},moveDown:function(b,a){return bG({left:b.left(),top:b.top()+a,right:b.right(),bottom:b.bottom()+a})},moveBottomTo:function(b,a){var c=b.bottom()-b.top();return bG({left:b.left(),top:a-c,right:b.right(),bottom:a})},moveTopTo:function(b,a){var c=b.bottom()-b.top();return bG({left:b.left(),top:a,right:b.right(),bottom:a+c})},getTop:function(a){return a.top()},getBottom:function(a){return a.bottom()},translate:function(b,a,c){return bG({left:b.left()+a,top:b.top()+c,right:b.right()+a,bottom:b.bottom()+c})},toString:function(a){return"("+a.left()+", "+a.top()+") -> ("+a.right()+", "+a.bottom()+")"}},aC=function(a){return cL.nu({left:a.left,top:a.top,right:a.right,bottom:a.bottom})},lb=function(b,a){return mz.some(b.getRect(a))},hs=function(d,b,g){return jk.isElement(b)?lb(d,b).map(aC):jk.isText(b)?(c=d,f=b,a=g,0<=a&&a<e5(f)?c.getRangedRect(f,a,f,a+1):0<a?c.getRangedRect(f,a-1,f,a):mz.none()).map(aC):mz.none();var c,f,a},jb=function(b,a){return jk.isElement(a)?lb(b,a).map(aC):jk.isText(a)?b.getRangedRect(a,0,a,e5(a)).map(aC):mz.none()},ij=mm("item","mode"),iY=function(c,a,f,b){var d=b!==undefined?b:gW;return c.property().parent(a).map(function(g){return ij(g,d)})},gW=function(c,a,f,b){var d=b!==undefined?b:m9;return f.sibling(c,a).map(function(g){return ij(g,d)})},m9=function(d,b,g,c){var f=c!==undefined?c:m9,a=d.property().children(b);return g.first(a).map(function(h){return ij(h,f)})},l4=[{current:iY,next:gW,fallback:mz.none()},{current:gW,next:m9,fallback:mz.some(iY)},{current:m9,next:m9,fallback:mz.some(gW)}],jJ=function(a,f,b,d,c){return c=c!==undefined?c:l4,mI(c,function(g){return g.current===b}).bind(function(g){return g.current(a,f,d,g.next).orThunk(function(){return g.fallback.bind(function(h){return jJ(a,f,h,d)})})})},kY={backtrack:iY,sidestep:gW,advance:m9,go:jJ},hR={left:function(){return{sibling:function(b,a){return b.query().prevSibling(a)},first:function(a){return 0<a.length?mz.some(a[a.length-1]):mz.none()}}},right:function(){return{sibling:function(b,a){return b.query().nextSibling(a)},first:function(a){return 0<a.length?mz.some(a[0]):mz.none()}}}},lx=function(b,d,g,c,f,a){return kY.go(b,d,c,f).bind(function(h){return a(h.item())?mz.none():g(h.item())?mz.some(h.item()):lx(b,h.item(),g,h.mode(),f,a)})},jx=function(c,a,d,b){return lx(c,a,d,kY.sidestep,hR.left(),b)},kM=function(c,a,d,b){return lx(c,a,d,kY.sidestep,hR.right(),b)},kB=function(b,a){return 0===b.property().children(a).length},iM=function(c,a,d,b){return jx(c,a,d,b)},gz=function(c,a,d,b){return kM(c,a,d,b)},mR={before:function(b,a,c){return iM(b,a,mA(kB,b),c)},after:function(b,a,c){return gz(b,a,mA(kB,b),c)},seekLeft:iM,seekRight:gz,walkers:function(){return{left:hR.left,right:hR.right}},walk:function(c,a,f,b,d){return kY.go(c,a,f,b,d)},backtrack:kY.backtrack,sidestep:kY.sidestep,advance:kY.advance},f2=cV(),e8={gather:function(b,a,c){return mR.gather(f2,b,a,c)},before:function(b,a){return mR.before(f2,b,a)},after:function(b,a){return mR.after(f2,b,a)},seekLeft:function(b,a,c){return mR.seekLeft(f2,b,a,c)},seekRight:function(b,a,c){return mR.seekRight(f2,b,a,c)},walkers:function(){return mR.walkers()},walk:function(c,a,d,b){return mR.walk(f2,c,a,d,b)}},fG=dk([{none:[]},{retry:["caret"]}]),g7=function(a,c,b){return hw.closest(c,eT).fold(mW(!1),function(d){return jb(a,d).exists(function(g){return h=g,(f=b).left()<h.left()||Math.abs(h.right()-f.left())<1||f.left()>h.right();var f,h})})},cC={point:cL.getTop,adjuster:function(d,b,g,c,f){var a=cL.moveUp(f,5);return Math.abs(g.top()-c.top())<1?fG.retry(a):g.bottom()<f.top()?fG.retry(a):g.bottom()===f.top()?fG.retry(cL.moveUp(f,1)):g7(d,b,f)?fG.retry(cL.translate(a,5,0)):fG.none()},move:cL.moveUp,gather:e8.before},ck={point:cL.getBottom,adjuster:function(d,b,g,c,f){var a=cL.moveDown(f,5);return Math.abs(g.bottom()-c.bottom())<1?fG.retry(a):g.top()>f.bottom()?fG.retry(a):g.top()===f.bottom()?fG.retry(cL.moveDown(f,1)):g7(d,b,f)?fG.retry(cL.translate(a,5,0)):fG.none()},move:cL.moveDown,gather:e8.after},b4=function(g,b,d,j,s){return 0===s?mz.some(j):(p=g,h=j.left(),k=b.point(j),p.elementFromPoint(h,k).filter(function(a){return"table"===jk.name(a)}).isSome()?(v=j,q=s-1,b4(g,m=b,d,m.move(v,5),q)):g.situsFromPoint(j.left(),b.point(j)).bind(function(a){return a.start().fold(mz.none,function(c,f){return jb(g,c,f).bind(function(i){return b.adjuster(g,c,i,d,j).fold(mz.none,function(l){return b4(g,b,d,l,s-1)})}).orThunk(function(){return mz.some(j)})},mz.none)}));var m,v,q,p,h,k},dw=function(f,k,h){var g,j,d,c=f.move(h,5),b=b4(k,f,h,c,100).getOr(c);return(g=f,j=b,d=k,g.point(j)>d.getInnerHeight()?mz.some(g.point(j)-d.getInnerHeight()):g.point(j)<0?mz.some(-g.point(j)):mz.none()).fold(function(){return k.situsFromPoint(b.left(),f.point(b))},function(a){return k.scrollBy(0,a),k.situsFromPoint(b.left(),f.point(b)-a)})},gK={tryUp:mA(dw,cC),tryDown:mA(dw,ck),ieTryUp:function(b,a){return b.situsFromPoint(a.left(),a.top()-5)},ieTryDown:function(b,a){return b.situsFromPoint(a.left(),a.bottom()+5)},getJumpSize:mW(5)},gh=dk([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),c9=function(a){return a5.closest(a,"tr")},h2={verify:function(b,g,d,j,f,i,h){return a5.closest(j,"td,th",h).bind(function(a){return a5.closest(g,"td,th",h).map(function(c){return bJ.eq(a,c)?bJ.eq(j,a)&&e5(a)===f?i(c):gh.none("in same cell"):cK.sharedOne(c9,[a,c]).fold(function(){return k=c,q=a,l=(m=b).getRect(k),(p=m.getRect(q)).right>l.left&&p.left<l.right?gh.success():i(c);var m,k,q,l,p},function(k){return i(c)})})}).getOr(gh.none("default"))},cata:function(c,a,f,b,d){return c.fold(a,f,b,d)},adt:gh},jU={point:mm("element","offset"),delta:mm("element","deltaOffset"),range:mm("element","start","finish"),points:mm("begin","end"),text:mm("element","text")},cY=(mm("ancestor","descendants","element","index"),mm("parent","children","element","index")),eB=function(b,a){return mp(b,mA(bJ.eq,a))},hF=function(a){return iR.parent(a).bind(function(b){var c=iR.children(b);return eB(c,a).map(function(d){return cY(b,c,a,d)})})},dH=function(a){return"br"===jk.name(a)},bd=function(b,a,c){return a(b,c).bind(function(d){return jk.isText(d)&&0===gw.get(d).trim().length?bd(d,a,c):mz.some(d)})},ap=function(b,d,g,c){return(f=d,a=g,iR.child(f,a).filter(dH).orThunk(function(){return iR.child(f,a-1).filter(dH)})).bind(function(h){return c.traverse(h).fold(function(){return bd(h,c.gather,b).map(c.relative)},function(i){return hF(i).map(function(j){return dU.on(j.parent(),j.index())})})});var f,a},dS=function(f,c,h,d){var g,b,a;return(dH(c)?(g=f,b=c,(a=d).traverse(b).orThunk(function(){return bd(b,a.gather,g)}).map(a.relative)):ap(f,c,h,d)).map(function(i){return{start:mW(i),finish:mW(i)}})},iB=function(a){return h2.cata(a,function(b){return mz.none()},function(){return mz.none()},function(b){return mz.some(jU.point(b,0))},function(b){return mz.some(jU.point(b,e5(b)))})},fR=a1.detect(),j5=function(f,g,e,d,b,h){return 0===h?mz.none():bT(f,g,e,d,b).bind(function(c){var a=f.fromSitus(c),i=h2.verify(f,e,d,a.finish(),a.foffset(),b.failure,g);return h2.cata(i,function(){return mz.none()},function(){return mz.some(c)},function(j){return bJ.eq(e,j)&&0===d?eM(f,e,d,cL.moveUp,b):j5(f,g,j,0,b,h-1)},function(j){return bJ.eq(e,j)&&d===e5(j)?eM(f,e,d,cL.moveDown,b):j5(f,g,j,e5(j),b,h-1)})})},eM=function(a,c,f,b,d){return hs(a,c,f).bind(function(g){return eX(a,d,b(g,gK.getJumpSize()))})},eX=function(b,a,c){return fR.browser.isChrome()||fR.browser.isSafari()||fR.browser.isFirefox()||fR.browser.isEdge()?a.otherRetry(b,c):fR.browser.isIE()?a.ieRetry(b,c):mz.none()},bT=function(a,c,f,b,d){return hs(a,f,b).bind(function(g){return eX(a,d,g)})},bx=function(c,f,d){return(e=c,b=f,a=d,e.getSelection().bind(function(g){return dS(b,g.finish(),g.foffset(),a).fold(function(){return mz.some(jU.point(g.finish(),g.foffset()))},function(i){var h=e.fromSitus(i),j=h2.verify(e,g.finish(),g.foffset(),h.finish(),h.foffset(),a.failure,b);return iB(j)})})).bind(function(g){return j5(c,f,g.element(),g.offset(),d,20).map(c.fromSitus)});var e,b,a},fv=function(b,a,c){return hw.ancestor(b,a,c).isSome()},aP=a1.detect(),a0=function(c,f,b,d,a){return a5.closest(d,"td,th",f).bind(function(e){return a5.closest(e,"table",f).bind(function(h){return g=h,fv(a,function(i){return iR.parent(i).exists(function(j){return bJ.eq(j,g)})})?bx(c,f,b).bind(function(i){return a5.closest(i.finish(),"td,th",f).map(function(j){return{start:mW(e),finish:mW(j),range:mW(i)}})}):mz.none();var g})})},d3=function(d,b,g,c,f,a){return aP.browser.isIE()?mz.none():a(c,b).orThunk(function(){return a0(d,b,g,c,f).map(function(i){var h=i.range();return dQ.response(mz.some(bR(h.start(),h.soffset(),h.finish(),h.foffset())),!0)})})},ej=function(f,c,h,d,g,b,a){return a0(f,h,d,g,b).bind(function(i){return eg.detect(c,h,i.start(),i.finish(),a)})},bI=function(b,a){return a5.closest(b,"tr",a).bind(function(c){return a5.closest(c,"table",a).bind(function(f){var d=b9.descendants(f,"tr");return bJ.eq(c,d[0])?e8.seekLeft(f,function(g){return cz.last(g).isSome()},a).map(function(h){var g=e5(h);return dQ.response(mz.some(bR(h,g,h,g)),!0)}):mz.none()})})},cN=function(b,a){return a5.closest(b,"tr",a).bind(function(c){return a5.closest(c,"table",a).bind(function(f){var d=b9.descendants(f,"tr");return bJ.eq(c,d[d.length-1])?e8.seekRight(f,function(g){return cz.first(g).isSome()},a).map(function(g){return dQ.response(mz.some(bR(g,0,g,0)),!0)}):mz.none()})})},aE=function(b,a){return a5.closest(b,"td,th",a)},k4={down:{traverse:iR.nextSibling,gather:e8.after,relative:dU.before,otherRetry:gK.tryDown,ieRetry:gK.ieTryDown,failure:h2.adt.failedDown},up:{traverse:iR.prevSibling,gather:e8.before,relative:dU.before,otherRetry:gK.tryUp,ieRetry:gK.ieTryUp,failure:h2.adt.failedUp}},hd=mm("rows","cols"),i4={mouse:function(m,w,g,b){var d,j,v,q,p,h,k=aY(m),x=(d=k,j=w,v=g,q=b,p=mz.none(),h=function(){p=mz.none()},{mousedown:function(a){q.clear(j),p=aE(a.target(),v)},mouseover:function(a){p.each(function(c){q.clear(j),aE(a.target(),v).each(function(e){iH(c,e,v).each(function(i){var f=i.boxes().getOr([]);(1<f.length||1===f.length&&!bJ.eq(c,e))&&(q.selectRange(j,f,i.start(),i.finish()),d.selectContents(e))})})})},mouseup:function(){p.each(h)}});return{mousedown:x.mousedown,mouseover:x.mouseover,mouseup:x.mouseup}},keyboard:function(h,j,a,g){var b=aY(h),i=function(){return g.clear(j),mz.none()};return{keydown:function(m,k,q,l,p,f){var d=m.raw().which,c=!0===m.raw().shiftKey;return gq(j,g.selectedSelector()).fold(function(){return eK.isDown(d)&&c?mA(ej,b,j,a,k4.down,l,k,g.selectRange):eK.isUp(d)&&c?mA(ej,b,j,a,k4.up,l,k,g.selectRange):eK.isDown(d)?mA(d3,b,a,k4.down,l,k,cN):eK.isUp(d)?mA(d3,b,a,k4.up,l,k,bI):mz.none},function(n){var o=function(r){return function(){return eb(r,function(s){return eg.update(s.rows(),s.cols(),j,n,g)}).fold(function(){return fW(j,g.firstSelectedSelector(),g.lastSelectedSelector()).map(function(u){var s=eK.isDown(d)||f.isForward(d)?dU.after:dU.before;return b.setRelativeSelection(dU.on(u.first(),0),s(u.table())),g.clear(j),dQ.response(mz.none(),!0)})},function(s){return mz.some(dQ.response(mz.none(),!0))})}};return eK.isDown(d)&&c?o([hd(1,0)]):eK.isUp(d)&&c?o([hd(-1,0)]):f.isBackward(d)&&c?o([hd(0,-1),hd(-1,0)]):f.isForward(d)&&c?o([hd(0,1),hd(1,0)]):eK.isNavigation(d)&&!1===c?i:mz.none})()},keyup:function(d,k,e,f,c){return gq(j,g.selectedSelector()).fold(function(){var l=d.raw().which;return 0==(!0===d.raw().shiftKey)?mz.none():eK.isNavigation(l)?eg.sync(j,a,k,e,f,c,g.selectRange):mz.none()},mz.none)}}}},h6=function(a,b){lW(b,function(c){h1.remove(a,c)})},iS=function(a){return function(b){h1.add(b,a)}},kd=function(a){return function(b){h6(b,a)}},gO={byClass:function(c){var b=iS(c.selected()),d=kd([c.selected(),c.lastSelected(),c.firstSelected()]),a=function(g){var f=b9.descendants(g,c.selectedSelector());lW(f,d)};return{clear:a,selectRange:function(h,f,i,g){a(h),lW(f,b),h1.add(i,c.firstSelected()),h1.add(g,c.lastSelected())},selectedSelector:c.selectedSelector,firstSelectedSelector:c.firstSelectedSelector,lastSelectedSelector:c.lastSelectedSelector}},byAttr:function(c){var d=function(f){my.remove(f,c.selected()),my.remove(f,c.firstSelected()),my.remove(f,c.lastSelected())},b=function(f){my.set(f,c.selected(),"1")},a=function(g){var f=b9.descendants(g,c.selectedSelector());lW(f,d)};return{clear:a,selectRange:function(h,f,i,g){a(h),lW(f,b),my.set(i,c.firstSelected(),"1"),my.set(g,c.lastSelected(),"1")},selectedSelector:c.selectedSelector,firstSelectedSelector:c.firstSelectedSelector,lastSelectedSelector:c.lastSelectedSelector}}},m3=function(a){return !1===h1.has(jK.fromDom(a.target),"ephox-snooker-resizer-bar")};function lL(e,f){var d=ld(["mousedown","mouseover","mouseup","keyup","keydown"],[]),a=mz.none(),c=gO.byAttr(bZ);return e.on("init",function(x){var b=e.getWin(),h=kq(e),C=mg(e),j=i4.mouse(b,h,C,c),A=i4.keyboard(b,h,C,c),z=function(i,g){!0===i.raw().shiftKey&&(g.kill()&&i.kill(),g.selection().each(function(m){var l=j7.relative(m.start(),m.finish()),o=bM.asLtrRange(b,l);e.selection.setRng(o)}))},q=function(l){var g=w(l);if(g.raw().shiftKey&&eK.isNavigation(g.raw().which)){var s=e.selection.getRng(),i=jK.fromDom(s.startContainer),m=jK.fromDom(s.endContainer);A.keyup(g,i,s.startOffset,m,s.endOffset).each(function(n){z(g,n)})}},B=function(E){var m=w(E);f().each(function(i){i.hideBars()});var G=e.selection.getRng(),s=jK.fromDom(e.selection.getStart()),F=jK.fromDom(G.startContainer),l=jK.fromDom(G.endContainer),g=kE.directionAt(s).isRtl()?eK.rtl:eK.ltr;A.keydown(m,F,G.startOffset,l,G.endOffset,g).each(function(i){z(m,i)}),f().each(function(i){i.showBars()})},p=function(g){return g.hasOwnProperty("x")&&g.hasOwnProperty("y")},w=function(l){var g=jK.fromDom(l.target),s=function(){l.stopPropagation()},i=function(){l.preventDefault()},m=lD(i,s);return{target:mW(g),x:mW(p(l)?l.x:null),y:mW(p(l)?l.y:null),stop:s,prevent:i,kill:m,raw:mW(l)}},D=function(g){return 0===g.button},y=function(g){D(g)&&m3(g)&&j.mousedown(w(g))},k=function(i){var g;(g=i).buttons!==undefined&&0==(1&g.buttons)||!m3(i)||j.mouseover(w(i))},v=function(g){D(g)&&m3(g)&&j.mouseup(w(g))};e.on("mousedown",y),e.on("mouseover",k),e.on("mouseup",v),e.on("keyup",q),e.on("keydown",B),e.on("nodechange",function(){var i=e.selection,g=jK.fromDom(i.getStart()),l=jK.fromDom(i.getEnd());cK.sharedOne(eE.table,[g,l]).fold(function(){c.clear(h)},lC)}),a=mz.some(d({mousedown:y,mouseover:k,mouseup:v,keyup:q,keydown:B}))}),{clear:c.clear,destroy:function(){a.each(function(b){})}}}var jD=eH.each,kS=function(a){var c=[];function b(d){return function(){a.execCommand(d)}}jD("inserttable tableprops deletetable | cell row column".split(" "),function(d){"|"===d?c.push({text:"-"}):c.push(a.menuItems[d])}),a.addButton("table",{type:"menubutton",title:"Table",menu:c}),a.addButton("tableprops",{title:"Table properties",onclick:b("mceTableProps"),icon:"table"}),a.addButton("tabledelete",{title:"Delete table",onclick:b("mceTableDelete")}),a.addButton("tablecellprops",{title:"Cell properties",onclick:b("mceTableCellProps")}),a.addButton("tablemergecells",{title:"Merge cells",onclick:b("mceTableMergeCells")}),a.addButton("tablesplitcells",{title:"Split cell",onclick:b("mceTableSplitCells")}),a.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:b("mceTableInsertRowBefore")}),a.addButton("tableinsertrowafter",{title:"Insert row after",onclick:b("mceTableInsertRowAfter")}),a.addButton("tabledeleterow",{title:"Delete row",onclick:b("mceTableDeleteRow")}),a.addButton("tablerowprops",{title:"Row properties",onclick:b("mceTableRowProps")}),a.addButton("tablecutrow",{title:"Cut row",onclick:b("mceTableCutRow")}),a.addButton("tablecopyrow",{title:"Copy row",onclick:b("mceTableCopyRow")}),a.addButton("tablepasterowbefore",{title:"Paste row before",onclick:b("mceTablePasteRowBefore")}),a.addButton("tablepasterowafter",{title:"Paste row after",onclick:b("mceTablePasteRowAfter")}),a.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:b("mceTableInsertColBefore")}),a.addButton("tableinsertcolafter",{title:"Insert column after",onclick:b("mceTableInsertColAfter")}),a.addButton("tabledeletecol",{title:"Delete column",onclick:b("mceTableDeleteCol")})},hJ=function(a){var b,c=""===(b=a.getParam("table_toolbar",iP))||!1===b?[]:lF(b)?b.split(/[ ,]/):l9(b)?b:[];0<c.length&&a.addContextToolbar(function(d){return a.dom.is(d,"table")&&a.getBody().contains(d)},c.join(" "))},lm=function(z,A){var x=mz.none(),D=[],k=[],L=[],J=[],C=function(a){a.disabled(!0)},G=function(a){a.disabled(!1)},H=function(){var a=this;D.push(a),x.fold(function(){C(a)},function(b){G(a)})},q=function(){var a=this;k.push(a),x.fold(function(){C(a)},function(b){G(a)})};z.on("init",function(){z.on("nodechange",function(b){var a=mz.from(z.dom.getParent(z.selection.getStart(),"th,td"));(x=a.bind(function(d){var c=jK.fromDom(d);return eE.table(c).map(function(f){return dC.forMenu(A,f,c)})})).fold(function(){lW(D,C),lW(k,C),lW(L,C),lW(J,C)},function(c){lW(D,G),lW(k,G),lW(L,function(d){d.disabled(c.mergable().isNone())}),lW(J,function(d){d.disabled(c.unmergable().isNone())})})})});var w=function(s,O,g,b){var d,m,N,M,v,h=b.getEl().getElementsByTagName("table")[0],p=b.isRtl()||"tl-tr"===b.parent().rel;for(h.nextSibling.innerHTML=O+1+" x "+(g+1),p&&(O=9-O),m=0;m<10;m++){for(d=0;d<10;d++){M=h.rows[m].childNodes[d].firstChild,v=(p?O<=d:d<=O)&&m<=g,s.dom.toggleClass(M,"mce-active",v),v&&(N=M)}}return N.parentNode},I=!1===z.getParam("table_grid",!0,"boolean")?{text:"Table",icon:"table",context:"table",onclick:B("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(a){a.aria&&(this.parent().hideAll(),a.stopImmediatePropagation(),z.execCommand("mceInsertTable"))},onshow:function(){w(z,0,0,this.menu.items()[0])},onhide:function(){var a=this.menu.items()[0].getEl().getElementsByTagName("a");z.dom.removeClass(a,"mce-active"),z.dom.addClass(a[0],"mce-active")},menu:[{type:"container",html:function(){var b="";b='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var a=0;a<10;a++){b+="<tr>";for(var c=0;c<10;c++){b+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*a+c)+'" href="#" data-mce-x="'+c+'" data-mce-y="'+a+'"></a></td>'}b+="</tr>"}return b+="</table>",b+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(c){var a,d,b=c.target;"A"===b.tagName.toUpperCase()&&(a=parseInt(b.getAttribute("data-mce-x"),10),d=parseInt(b.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(a=9-a),a===this.lastX&&d===this.lastY||(w(z,a,d,c.control),this.lastX=a,this.lastY=d))},onclick:function(b){var a=this;"A"===b.target.tagName.toUpperCase()&&(b.preventDefault(),b.stopPropagation(),a.parent().cancel(),z.undoManager.transact(function(){cQ(z,a.lastX+1,a.lastY+1)}),z.addVisual())}}]};function B(a){return function(){z.execCommand(a)}}var F={text:"Table properties",context:"table",onPostRender:H,onclick:B("mceTableProps")},E={text:"Delete table",context:"table",onPostRender:H,cmd:"mceTableDelete"},y={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:B("mceTableInsertRowBefore"),onPostRender:q},{text:"Insert row after",onclick:B("mceTableInsertRowAfter"),onPostRender:q},{text:"Delete row",onclick:B("mceTableDeleteRow"),onPostRender:q},{text:"Row properties",onclick:B("mceTableRowProps"),onPostRender:q},{text:"-"},{text:"Cut row",onclick:B("mceTableCutRow"),onPostRender:q},{text:"Copy row",onclick:B("mceTableCopyRow"),onPostRender:q},{text:"Paste row before",onclick:B("mceTablePasteRowBefore"),onPostRender:q},{text:"Paste row after",onclick:B("mceTablePasteRowAfter"),onPostRender:q}]},j={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:B("mceTableInsertColBefore"),onPostRender:q},{text:"Insert column after",onclick:B("mceTableInsertColAfter"),onPostRender:q},{text:"Delete column",onclick:B("mceTableDeleteCol"),onPostRender:q}]},K={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:B("mceTableCellProps"),onPostRender:q},{text:"Merge cells",onclick:B("mceTableMergeCells"),onPostRender:function(){var a=this;L.push(a),x.fold(function(){C(a)},function(b){a.disabled(b.mergable().isNone())})}},{text:"Split cell",onclick:B("mceTableSplitCells"),onPostRender:function(){var a=this;J.push(a),x.fold(function(){C(a)},function(b){a.disabled(b.unmergable().isNone())})}}]};z.addMenuItem("inserttable",I),z.addMenuItem("tableprops",F),z.addMenuItem("deletetable",E),z.addMenuItem("row",y),z.addMenuItem("column",j),z.addMenuItem("cell",K)},jm=function(b,a){return{insertTable:function(d,c){return cQ(b,d,c)},setClipboardRows:function(d){return c=a,f=mZ(d,jK.fromDom),void c.set(mz.from(f));var c,f},getClipboardRows:function(){return a.get().fold(function(){},function(c){return mZ(c,function(d){return d.dom()})})}}};lZ.add("table",function(c){var h,d=gp(c),f=lL(c,d.lazyResize),g=jX(c,d.lazyWire),b=(h=c,{get:function(){var i=kq(h);return e2(i,bZ.selectedSelector()).fold(function(){return h.selection.getStart()===undefined?f6.none():f6.single(h.selection)},function(j){return f6.multiple(j)})}}),a=gG(mz.none());return im(c,g,f,b,a),a6(c,b,g,f),lm(c,b),kS(c),hJ(c),c.on("PreInit",function(){c.serializer.addTempAttr(bZ.firstSelected()),c.serializer.addTempAttr(bZ.lastSelected())}),c.getParam("table_tab_navigation",!0,"boolean")&&c.on("keydown",function(i){ak(i,c,g,d.lazyWire)}),c.on("remove",function(){d.destroy(),f.destroy()}),jm(c,a)})}();