(function(){var a=(function(){var n=function(M){var N=M;var L=function(){return N};var P=function(Q){N=Q};var O=function(){return n(L())};return{get:L,set:P,clone:O}};var c=tinymce.util.Tools.resolve("tinymce.PluginManager");var F=tinymce.util.Tools.resolve("tinymce.util.Tools");var D=tinymce.util.Tools.resolve("tinymce.html.DomParser");var C=tinymce.util.Tools.resolve("tinymce.html.Node");var B=tinymce.util.Tools.resolve("tinymce.html.Serializer");var G=function(L){return L.getParam("fullpage_hide_in_source_view")};var q=function(L){return L.getParam("fullpage_default_xml_pi")};var o=function(L){return L.getParam("fullpage_default_encoding")};var x=function(L){return L.getParam("fullpage_default_font_family")};var K=function(L){return L.getParam("fullpage_default_font_size")};var e=function(L){return L.getParam("fullpage_default_text_color")};var I=function(L){return L.getParam("fullpage_default_title")};var u=function(L){return L.getParam("fullpage_default_doctype","<!DOCTYPE html>")};var m={shouldHideInSourceView:G,getDefaultXmlPi:q,getDefaultEncoding:o,getDefaultFontFamily:x,getDefaultFontSize:K,getDefaultTextColor:e,getDefaultTitle:I,getDefaultDocType:u};var r=function(L){return D({validate:false,root_name:"#document"}).parse(L)};var v=function(N,M){var O=r(M);var Q={};var R,P;function L(U,S){var T=U.attr(S);return T||""}Q.fontface=m.getDefaultFontFamily(N);Q.fontsize=m.getDefaultFontSize(N);R=O.firstChild;if(R.type===7){Q.xml_pi=true;P=/encoding="([^"]+)"/.exec(R.value);if(P){Q.docencoding=P[1]}}R=O.getAll("#doctype")[0];if(R){Q.doctype="<!DOCTYPE"+R.value+">"}R=O.getAll("title")[0];if(R&&R.firstChild){Q.title=R.firstChild.value}F.each(O.getAll("meta"),function(V){var T=V.attr("name");var S=V.attr("http-equiv");var U;if(T){Q[T.toLowerCase()]=V.attr("content")}else{if(S==="Content-Type"){U=/charset\s*=\s*(.*)\s*/gi.exec(V.attr("content"));if(U){Q.docencoding=U[1]}}}});R=O.getAll("html")[0];if(R){Q.langcode=L(R,"lang")||L(R,"xml:lang")}Q.stylesheets=[];F.each(O.getAll("link"),function(S){if(S.attr("rel")==="stylesheet"){Q.stylesheets.push(S.attr("href"))}});R=O.getAll("body")[0];if(R){Q.langdir=L(R,"dir");Q.style=L(R,"style");Q.visited_color=L(R,"vlink");Q.link_color=L(R,"link");Q.active_color=L(R,"alink")}return Q};var z=function(S,P,V){var O,M,R,U,W;var N=S.dom;function L(Z,X,Y){Z.attr(X,Y?Y:undefined)}function T(X){if(M.firstChild){M.insert(X,M.firstChild)}else{M.append(X)}}O=r(V);M=O.getAll("head")[0];if(!M){U=O.getAll("html")[0];M=new C("head",1);if(U.firstChild){U.insert(M,U.firstChild,true)}else{U.append(M)}}U=O.firstChild;if(P.xml_pi){W='version="1.0"';if(P.docencoding){W+=' encoding="'+P.docencoding+'"'}if(U.type!==7){U=new C("xml",7);O.insert(U,O.firstChild,true)}U.value=W}else{if(U&&U.type===7){U.remove()}}U=O.getAll("#doctype")[0];if(P.doctype){if(!U){U=new C("#doctype",10);if(P.xml_pi){O.insert(U,O.firstChild)}else{T(U)}}U.value=P.doctype.substring(9,P.doctype.length-1)}else{if(U){U.remove()}}U=null;F.each(O.getAll("meta"),function(X){if(X.attr("http-equiv")==="Content-Type"){U=X}});if(P.docencoding){if(!U){U=new C("meta",1);U.attr("http-equiv","Content-Type");U.shortEnded=true;T(U)}U.attr("content","text/html; charset="+P.docencoding)}else{if(U){U.remove()}}U=O.getAll("title")[0];if(P.title){if(!U){U=new C("title",1);T(U)}else{U.empty()}U.append(new C("#text",3)).value=P.title}else{if(U){U.remove()}}F.each("keywords,description,author,copyright,robots".split(","),function(Y){var X=O.getAll("meta");var Z,ab;var aa=P[Y];for(Z=0;Z<X.length;Z++){ab=X[Z];if(ab.attr("name")===Y){if(aa){ab.attr("content",aa)}else{ab.remove()}return}}if(aa){U=new C("meta",1);U.attr("name",Y);U.attr("content",aa);U.shortEnded=true;T(U)}});var Q={};F.each(O.getAll("link"),function(X){if(X.attr("rel")==="stylesheet"){Q[X.attr("href")]=X}});F.each(P.stylesheets,function(X){if(!Q[X]){U=new C("link",1);U.attr({rel:"stylesheet",text:"text/css",href:X});U.shortEnded=true;T(U)}delete Q[X]});F.each(Q,function(X){X.remove()});U=O.getAll("body")[0];if(U){L(U,"dir",P.langdir);L(U,"style",P.style);L(U,"vlink",P.visited_color);L(U,"link",P.link_color);L(U,"alink",P.active_color);N.setAttribs(S.getBody(),{style:P.style,dir:P.dir,vLink:P.visited_color,link:P.link_color,aLink:P.active_color})}U=O.getAll("html")[0];if(U){L(U,"lang",P.langcode);L(U,"xml:lang",P.langcode)}if(!M.firstChild){M.remove()}R=B({validate:false,indent:true,apply_source_formatting:true,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(O);return R.substring(0,R.indexOf("</body>"))};var p={parseHeader:r,htmlToData:v,dataToHtml:z};var s=function(M,L){var N=p.htmlToData(M,L.get());M.windowManager.open({title:"Document properties",data:N,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(P){var O=p.dataToHtml(M,F.extend(N,P.data),L.get());L.set(O)}})};var d={open:s};var g=function(M,L){M.addCommand("mceFullPageProperties",function(){d.open(M,L)})};var A={register:g};var J=function(L,M){F.each(L,function(N){M=M.replace(N,function(O){return"<!--mce:protected "+escape(O)+"-->"})});return M};var h=function(L){return L.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(N,M){return unescape(M)})};var j={protectHtml:J,unprotectHtml:h};var E=F.each;var b=function(L){return L.replace(/<\/?[A-Z]+/g,function(M){return M.toLowerCase()})};var k=function(P,W,U,V){var S,L,R,N,X="";var M=P.dom;var T;if(V.selection){return}R=j.protectHtml(P.settings.protect,V.content);if(V.format==="raw"&&W.get()){return}if(V.source_view&&m.shouldHideInSourceView(P)){return}if(R.length===0&&!V.source_view){R=F.trim(W.get())+"\n"+F.trim(R)+"\n"+F.trim(U.get())}R=R.replace(/<(\/?)BODY/gi,"<$1body");S=R.indexOf("<body");if(S!==-1){S=R.indexOf(">",S);W.set(b(R.substring(0,S+1)));L=R.indexOf("</body",S);if(L===-1){L=R.length}V.content=F.trim(R.substring(S+1,L));U.set(b(R.substring(L)))}else{W.set(i(P));U.set("\n</body>\n</html>")}N=p.parseHeader(W.get());E(N.getAll("style"),function(Y){if(Y.firstChild){X+=Y.firstChild.value}});T=N.getAll("body")[0];if(T){M.setAttribs(P.getBody(),{style:T.attr("style")||"",dir:T.attr("dir")||"",vLink:T.attr("vlink")||"",link:T.attr("link")||"",aLink:T.attr("alink")||""})}M.remove("fullpage_styles");var Q=P.getDoc().getElementsByTagName("head")[0];if(X){M.add(Q,"style",{id:"fullpage_styles"},X);T=M.get("fullpage_styles");if(T.styleSheet){T.styleSheet.cssText=X}}var O={};F.each(Q.getElementsByTagName("link"),function(Y){if(Y.rel==="stylesheet"&&Y.getAttribute("data-mce-fullpage")){O[Y.href]=Y}});F.each(N.getAll("link"),function(Z){var Y=Z.attr("href");if(!Y){return true}if(!O[Y]&&Z.attr("rel")==="stylesheet"){M.add(Q,"link",{rel:"stylesheet",text:"text/css",href:Y,"data-mce-fullpage":"1"})}delete O[Y]});F.each(O,function(Y){Y.parentNode.removeChild(Y)})};var i=function(L){var P="",O,N="";if(m.getDefaultXmlPi(L)){var M=m.getDefaultEncoding(L);P+='<?xml version="1.0" encoding="'+(M?M:"ISO-8859-1")+'" ?>\n'}P+=m.getDefaultDocType(L);P+="\n<html>\n<head>\n";if(O=m.getDefaultTitle(L)){P+="<title>"+O+"</title>\n"}if(O=m.getDefaultEncoding(L)){P+='<meta http-equiv="Content-Type" content="text/html; charset='+O+'" />\n'}if(O=m.getDefaultFontFamily(L)){N+="font-family: "+O+";"}if(O=m.getDefaultFontSize(L)){N+="font-size: "+O+";"}if(O=m.getDefaultTextColor(L)){N+="color: "+O+";"}P+="</head>\n<body"+(N?' style="'+N+'"':"")+">\n";return P};var H=function(O,N,M,L){if(!L.selection&&(!L.source_view||!m.shouldHideInSourceView(O))){L.content=j.unprotectHtml(F.trim(N)+"\n"+F.trim(L.content)+"\n"+F.trim(M))}};var f=function(N,M,L){N.on("BeforeSetContent",function(O){k(N,M,L,O)});N.on("GetContent",function(O){H(N,M.get(),L.get(),O)})};var t={setup:f};var w=function(L){L.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"});L.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})};var y={register:w};c.add("fullpage",function(N){var M=n(""),L=n("");A.register(N,M);y.register(N);t.setup(N,M,L)});function l(){}return l}())})();