(function(){var b=(function(){var av=function(g){var f=g;var c=function(){return f};var e=function(h){f=h};var d=function(){return av(c())};return{get:c,set:e,clone:d}};var aQ=tinymce.util.Tools.resolve("tinymce.PluginManager");var W=function(c){if(/(^|[ ,])tinymcespellchecker([, ]|$)/.test(c.settings.plugins)&&aQ.get("tinymcespellchecker")){if(typeof window.console!=="undefined"&&window.console.log){window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option.")}return true}else{return false}};var at={hasProPlugin:W};var al=function(d){var c="English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";return d.getParam("spellchecker_languages",c)};var aG=function(c){var d=c.getParam("language","en");return c.getParam("spellchecker_language",d)};var aK=function(c){return c.getParam("spellchecker_rpc_url")};var ai=function(c){return c.getParam("spellchecker_callback")};var ac=function(d){var c=new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xA7\xA9\xAB\xAE\xB1\xB6\xB7\xB8\xBB\xBC\xBD\xBE\xBF\xD7\xF7\xA4\u201D\u201C\u201E\xA0\u2002\u2003\u2009]+',"g");return d.getParam("spellchecker_wordchar_pattern",c)};var aE={getLanguages:al,getLanguage:aG,getRpcUrl:aK,getSpellcheckerCallback:ai,getSpellcheckerWordcharPattern:ac};var ad=tinymce.util.Tools.resolve("tinymce.util.Tools");var ae=tinymce.util.Tools.resolve("tinymce.util.URI");var af=tinymce.util.Tools.resolve("tinymce.util.XHR");var ab=function(c){return c.fire("SpellcheckStart")};var aj=function(c){return c.fire("SpellcheckEnd")};var aO={fireSpellcheckStart:ab,fireSpellcheckEnd:aj};function ay(c){return c&&c.nodeType===1&&c.contentEditable==="false"}var X=function(n,C){var o,c=[],x;var j=C.dom;var r,w,l;r=C.schema.getBlockElements();w=C.schema.getWhiteSpaceElements();l=C.schema.getShortEndedElements();function k(E,F){if(!E[0]){throw new Error("findAndReplaceDOMText cannot handle zero-length matches")}return{start:E.index,end:E.index+E[0].length,text:E[0],data:F}}function f(F){var E;if(F.nodeType===3){return F.data}if(w[F.nodeName]&&!r[F.nodeName]){return""}if(ay(F)){return"\n"}E="";if(r[F.nodeName]||l[F.nodeName]){E+="\n"}if(F=F.firstChild){do{E+=f(F)}while(F=F.nextSibling)}return E}function i(L,J,F){var N,G,I,M,E=[],H=0,K=L,O,P=0;J=J.slice(0);J.sort(function(Q,R){return Q.start-R.start});O=J.shift();out:while(true){if(r[K.nodeName]||l[K.nodeName]||ay(K)){H++}if(K.nodeType===3){if(!G&&K.length+H>=O.end){G=K;M=O.end-H}else{if(N){E.push(K)}}if(!N&&K.length+H>O.start){N=K;I=O.start-H}H+=K.length}if(N&&G){K=F({startNode:N,startNodeIndex:I,endNode:G,endNodeIndex:M,innerNodes:E,match:O.text,matchIndex:P});H-=G.length-M;N=null;G=null;E=[];O=J.shift();P++;if(!O){break}}else{if((!w[K.nodeName]||r[K.nodeName])&&K.firstChild){if(!ay(K)){K=K.firstChild;continue}}else{if(K.nextSibling){K=K.nextSibling;continue}}}while(true){if(K.nextSibling){K=K.nextSibling;break}else{if(K.parentNode!==L){K=K.parentNode}else{break out}}}}}function u(F){function E(H,J){var I=c[J];if(!I.stencil){I.stencil=F(I)}var G=I.stencil.cloneNode(false);G.setAttribute("data-mce-index",J);if(H){G.appendChild(j.doc.createTextNode(H))}return G}return function(J){var S;var O;var I;var M=J.startNode;var G=J.endNode;var R=J.matchIndex;var Q=j.doc;if(M===G){var T=M;I=T.parentNode;if(J.startNodeIndex>0){S=Q.createTextNode(T.data.substring(0,J.startNodeIndex));I.insertBefore(S,T)}var N=E(J.match,R);I.insertBefore(N,T);if(J.endNodeIndex<T.length){O=Q.createTextNode(T.data.substring(J.endNodeIndex));I.insertBefore(O,T)}T.parentNode.removeChild(T);return N}S=Q.createTextNode(M.data.substring(0,J.startNodeIndex));O=Q.createTextNode(G.data.substring(J.endNodeIndex));var V=E(M.data.substring(J.startNodeIndex),R);var aR=[];for(var K=0,L=J.innerNodes.length;K<L;++K){var P=J.innerNodes[K];var U=E(P.data,R);P.parentNode.replaceChild(U,P);aR.push(U)}var H=E(G.data.substring(0,J.endNodeIndex),R);I=M.parentNode;I.insertBefore(S,M);I.insertBefore(V,M);I.removeChild(M);I=G.parentNode;I.insertBefore(H,G);I.insertBefore(O,G);I.removeChild(G);return H}}function B(F){var E=F.parentNode;E.insertBefore(F.firstChild,F);F.parentNode.removeChild(F)}function e(E){return E.className.indexOf("mce-spellchecker-word")!==-1}function m(H){var E=n.getElementsByTagName("*"),F=[];H=typeof H==="number"?""+H:null;for(var G=0;G<E.length;G++){var I=E[G],J=I.getAttribute("data-mce-index");if(J!==null&&J.length&&e(I)){if(J===H||H===null){F.push(I)}}}return F}function d(E){var F=c.length;while(F--){if(c[F]===E){return F}}return -1}function y(F){var E=[];D(function(H,G){if(F(H,G)){E.push(H)}});c=E;return this}function D(F){for(var G=0,E=c.length;G<E;G++){if(F(c[G],G)===false){break}}return this}function z(E){if(c.length){i(n,c,u(E))}return this}function s(E,F){if(x&&E.global){while(o=E.exec(x)){c.push(k(o,F))}}return this}function p(E){var G;var F=m(E?d(E):null);G=F.length;while(G--){B(F[G])}return this}function q(E){return c[E.getAttribute("data-mce-index")]}function v(E){return m(d(E))[0]}function t(F,E,G){c.push({start:F,end:F+E,text:x.substr(F,E),data:G});return this}function A(G){var F=m(d(G));var E=C.dom.createRng();E.setStartBefore(F[0]);E.setEndAfter(F[F.length-1]);return E}function h(G,F){var E=A(G);E.deleteContents();if(F.length>0){E.insertNode(C.dom.doc.createTextNode(F))}return E}function g(){c.splice(0,c.length);p();return this}x=f(n);return{text:x,matches:c,each:D,filter:y,reset:g,matchFromElement:q,elementFromMatch:v,find:s,add:t,wrap:z,unwrap:p,replace:h,rangeFromMatch:A,indexOf:d}};var aI=function(e,c){if(!c.get()){var d=X(e.getBody(),e);c.set(d)}return c.get()};var aB=function(d){for(var c in d){return false}return true};var ap=function(d,e,c){return function(f,g,k,i){var h={method:f,lang:c.get()};var j="";h[f==="addToDictionary"?"word":"text"]=g;ad.each(h,function(l,m){if(j){j+="&"}j+=m+"="+encodeURIComponent(l)});af.send({url:new ae(e).toAbsolute(aE.getRpcUrl(d)),type:"post",content_type:"application/x-www-form-urlencoded",data:j,success:function(m){m=JSON.parse(m);if(!m){var l=d.translate("Server response wasn't proper JSON.");i(l)}else{if(m.error){i(m.error)}else{k(m)}}},error:function(){var l=d.translate("The spelling service was not found: (")+aE.getRpcUrl(d)+d.translate(")");i(l)}})}};var an=function(k,c,j,g,e,f,d){var h=aE.getSpellcheckerCallback(k);var i=h?h:ap(k,c,j);i.call(k.plugins.spellchecker,g,e,f,d)};var a=function(e,f,d,h,j,g){if(aF(e,d,h)){return}var i=function(k){e.notificationManager.open({text:k,type:"error"});e.setProgressState(false);aF(e,d,h)};var c=function(k){aP(e,d,h,j,k)};e.setProgressState(true);an(e,f,g,"spellcheck",aI(e,h).text,c,i);e.focus()};var ag=function(e,d,c){if(!e.dom.select("span.mce-spellchecker-word").length){aF(e,d,c)}};var aH=function(g,f,e,i,c,d,h){g.setProgressState(true);an(g,f,c,"addToDictionary",d,function(){g.setProgressState(false);g.dom.remove(h,true);ag(g,e,i)},function(j){g.notificationManager.open({text:j,type:"error"});g.setProgressState(false)})};var aA=function(f,e,c,d,h,g){f.selection.collapse();if(g){ad.each(f.dom.select("span.mce-spellchecker-word"),function(i){if(i.getAttribute("data-mce-word")===d){f.dom.remove(i,true)}})}else{f.dom.remove(h,true)}ag(f,e,c)};var aF=function(e,d,c){aI(e,c).reset();c.set(null);if(d.get()){d.set(false);aO.fireSpellcheckEnd(e);return true}};var am=function(d){var c=d.getAttribute("data-mce-index");if(typeof c==="number"){return""+c}return c};var aM=function(f,h){var c;var e=[];c=ad.toArray(f.getBody().getElementsByTagName("span"));if(c.length){for(var g=0;g<c.length;g++){var d=am(c[g]);if(d===null||!d.length){continue}if(d===h.toString()){e.push(c[g])}}}return e};var aP=function(h,f,i,j,e){var c,d;if(typeof e!=="string"&&e.words){d=!!e.dictionary;c=e.words}else{c=e}h.setProgressState(false);if(aB(c)){var g=h.translate("No misspellings found.");h.notificationManager.open({text:g,type:"info"});f.set(false);return}j.set({suggestions:c,hasDictionarySupport:d});aI(h,i).find(aE.getSpellcheckerWordcharPattern(h)).filter(function(k){return !!c[k.text]}).wrap(function(k){return h.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":k.text})});f.set(true);aO.fireSpellcheckStart(h)};var ao={spellcheck:a,checkIfFinished:ag,addToDictionary:aH,ignoreWord:aA,findSpansByIndex:aM,getElmIndex:am,markErrors:aP};var Y=function(k,e,h,f,j,g){var i=function(){return j.get()};var l=function(){return aE.getSpellcheckerWordcharPattern(k)};var c=function(m){ao.markErrors(k,e,f,h,m)};var d=function(){return f.get()};return{getTextMatcher:d,getWordCharPattern:l,markErrors:c,getLanguage:i}};var aa={get:Y};var aJ=function(f,e,d,g,c,h){f.addCommand("mceSpellCheck",function(){ao.spellcheck(f,e,d,g,c,h)})};var aN={register:aJ};var au=function(d,c){var e=[];ad.each(c,function(f){e.push({selectable:true,text:f.name,data:f.value})});return e};var Z=function(d,c){return function(e){var f=c.get();e.control.items().each(function(g){g.active(g.settings.data===f)})}};var aD=function(c){return ad.map(aE.getLanguages(c).split(","),function(d){d=d.split("=");return{name:d[0],value:d[1]}})};var aq=function(c,e,f,g,j,h){var k=au("Language",aD(c));var i=function(){ao.spellcheck(c,e,f,g,h,j)};var d={tooltip:"Spellcheck",onclick:i,onPostRender:function(l){var m=l.control;c.on("SpellcheckStart SpellcheckEnd",function(){m.active(f.get())})}};if(k.length>1){d.type="splitbutton";d.menu=k;d.onshow=Z(c,j);d.onselect=function(l){j.set(l.control.settings.data)}}c.addButton("spellchecker",d);c.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:i,selectable:true,onPostRender:function(){var l=this;l.active(f.get());c.on("SpellcheckStart SpellcheckEnd",function(){l.active(f.get())})}})};var aw={register:aq};var ah=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils");var ak=tinymce.util.Tools.resolve("tinymce.ui.Factory");var aC;var ar=function(o,c,h,e,f,j,g,n){var m=[],p=h.get().suggestions[g];ad.each(p,function(q){m.push({text:q,onclick:function(){o.insertContent(o.dom.encode(q));o.dom.remove(n);ao.checkIfFinished(o,e,f)}})});m.push({text:"-"});var d=h.get().hasDictionarySupport;if(d){m.push({text:"Add to Dictionary",onclick:function(){ao.addToDictionary(o,c,e,f,j,g,n)}})}m.push.apply(m,[{text:"Ignore",onclick:function(){ao.ignoreWord(o,e,f,g,n)}},{text:"Ignore all",onclick:function(){ao.ignoreWord(o,e,f,g,n,true)}}]);aC=ak.create("menu",{items:m,context:"contextmenu",onautohide:function(q){if(q.target.className.indexOf("spellchecker")!==-1){q.preventDefault()}},onhide:function(){aC.remove();aC=null}});aC.renderTo(document.body);var k=ah.DOM.getPos(o.getContentAreaContainer());var i=o.dom.getPos(n[0]);var l=o.dom.getRoot();if(l.nodeName==="BODY"){i.x-=l.ownerDocument.documentElement.scrollLeft||l.scrollLeft;i.y-=l.ownerDocument.documentElement.scrollTop||l.scrollTop}else{i.x-=l.scrollLeft;i.y-=l.scrollTop}k.x+=i.x;k.y+=i.y;aC.moveTo(k.x,k.y+n[0].offsetHeight)};var aL=function(f,e,c,d,g,h){f.on("click",function(i){var j=i.target;if(j.className==="mce-spellchecker-word"){i.preventDefault();var k=ao.findSpansByIndex(f,ao.getElmIndex(j));if(k.length>0){var l=f.dom.createRng();l.setStartBefore(k[0]);l.setEndAfter(k[k.length-1]);f.selection.setRng(l);ar(f,e,c,d,g,h,j.getAttribute("data-mce-word"),k)}}})};var ax={setup:aL};aQ.add("spellchecker",function(f,e){if(at.hasProPlugin(f)===false){var d=av(false);var g=av(aE.getLanguage(f));var h=av(null);var c=av(null);aw.register(f,e,d,h,g,c);ax.setup(f,e,c,d,h,g);aN.register(f,e,d,h,c,g);return aa.get(f,d,c,h,g,e)}});function az(){}return az}())})();