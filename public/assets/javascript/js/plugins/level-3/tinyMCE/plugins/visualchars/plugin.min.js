(function(){var a=(function(){var J=function(ao){var ap=ao;var an=function(){return ap};var ar=function(at){ap=at};var aq=function(){return J(an())};return{get:an,set:ar,clone:aq}};var c=tinymce.util.Tools.resolve("tinymce.PluginManager");var ai=function(an){var ao=function(){return an.get()};return{isEnabled:ao}};var E={get:ai};var L=function(an,ao){return an.fire("VisualChars",{state:ao})};var w={fireVisualChars:L};var H={"\xA0":"nbsp","\xAD":"shy"};var ac=function(ap,aq){var ao,an="";for(ao in ap){an+=ao}return new RegExp("["+an+"]",aq?"g":"")};var ak=function(ap){var ao,an="";for(ao in ap){if(an){an+=","}an+="span.mce-"+ap[ao]}return an};var ae={charMap:H,regExp:ac(H),regExpGlobal:ac(H,true),selector:ak(H),charMapToRegExp:ac,charMapToSelector:ak};var S=function(an){return function(){return an}};var O=S(false);var I=S(true);var d=O;var ad=I;var C=function(){return X};var X=function(){var an=function(av){return av.isNone()};var ap=function(av){return av()};var au=function(av){return av};var ao=function(){};var aq=function(){return null};var ar=function(){return undefined};var at={fold:function(aw,av){return aw()},is:d,isSome:d,isNone:ad,getOr:au,getOrThunk:ap,getOrDie:function(av){throw new Error(av||"error: getOrDie called on none.")},getOrNull:aq,getOrUndefined:ar,or:au,orThunk:ap,map:C,ap:C,each:ao,bind:C,flatten:C,exists:d,forall:ad,filter:C,equals:an,equals_:an,toArray:function(){return[]},toString:S("none()")};if(Object.freeze){Object.freeze(at)}return at}();var Y=function(an){var at=function(){return an};var ao=function(){return ap};var aq=function(au){return Y(au(an))};var ar=function(au){return au(an)};var ap={fold:function(av,au){return au(an)},is:function(au){return an===au},isSome:ad,isNone:d,getOr:at,getOrThunk:at,getOrDie:at,getOrNull:at,getOrUndefined:at,or:ao,orThunk:ao,map:aq,ap:function(au){return au.fold(C,function(av){return Y(av(an))})},each:function(au){au(an)},bind:ar,flatten:at,exists:ar,forall:ar,filter:function(au){return au(an)?ap:X},equals:function(au){return au.is(an)},equals_:function(av,au){return av.fold(d,function(aw){return au(an,aw)})},toArray:function(){return[an]},toString:function(){return"some("+an+")"}};return ap};var v=function(an){return an===null||an===undefined?X:Y(an)};var q={some:Y,none:C,from:v};var n=function(an){if(an===null){return"null"}var ao=typeof an;if(ao==="object"&&Array.prototype.isPrototypeOf(an)){return"array"}if(ao==="object"&&String.prototype.isPrototypeOf(an)){return"string"}return ao};var R=function(an){return function(ao){return n(ao)===an}};var A=R("function");var P=function(ap,at){var ao=ap.length;var ar=new Array(ao);for(var aq=0;aq<ao;aq++){var an=ap[aq];ar[aq]=at(an,aq,ap)}return ar};var af=function(ap,ar){for(var aq=0,ao=ap.length;aq<ao;aq++){var an=ap[aq];ar(an,aq,ap)}};var z=Array.prototype.slice;var i=A(Array.from)?Array.from:function(an){return z.call(an)};var l=function(an,ao){var ap=ao||document;var aq=ap.createElement("div");aq.innerHTML=an;if(!aq.hasChildNodes()||aq.childNodes.length>1){console.error("HTML does not have a single root node",an);throw"HTML must have a single root node"}return r(aq.childNodes[0])};var al=function(an,ao){var aq=ao||document;var ap=aq.createElement(an);return r(ap)};var k=function(aq,an){var ap=an||document;var ao=ap.createTextNode(aq);return r(ao)};var r=function(an){if(an===null||an===undefined){throw new Error("Node cannot be null or undefined")}return{dom:S(an)}};var x=function(ao,an,aq){var ap=ao.dom();return q.from(ap.elementFromPoint(an,aq)).map(r)};var Z={fromHtml:l,fromTag:al,fromText:k,fromDom:r,fromPoint:x};var j={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE};var t=function(an){var ao=an.dom().nodeName;return ao.toLowerCase()};var am=function(an){return an.dom().nodeType};var ab=function(an){return an.dom().nodeValue};var aa=function(an){return function(ao){return am(ao)===an}};var u=function(an){return am(an)===j.COMMENT||t(an)==="#comment"};var aj=aa(j.ELEMENT);var h=aa(j.TEXT);var G=aa(j.DOCUMENT);var D={name:t,type:am,value:ab,isElement:aj,isText:h,isDocument:G,isComment:u};var y=function(an){return'<span data-mce-bogus="1" class="mce-'+ae.charMap[an]+'">'+an+"</span>"};var K={wrapCharWithSpan:y};var M=function(an){return D.isText(an)&&D.value(an)!==undefined&&ae.regExp.test(D.value(an))};var s=function(aq,ao){var an=[];var ar=aq.dom();var ap=P(ar.childNodes,Z.fromDom);af(ap,function(at){if(ao(at)){an=an.concat([at])}an=an.concat(s(at,ao))});return an};var f=function(ao,an){while(ao.parentNode){if(ao.parentNode===an){return ao}ao=ao.parentNode}};var B=function(an){return an.replace(ae.regExpGlobal,K.wrapCharWithSpan)};var m={isMatch:M,filterDescendants:s,findParentElm:f,replaceWithSpans:B};var W=function(ao,aq){var ap,ar;var an=m.filterDescendants(Z.fromDom(aq),m.isMatch);af(an,function(au){var at=m.replaceWithSpans(D.value(au));ar=ao.dom.create("div",null,at);while(ap=ar.lastChild){ao.dom.insertAfter(ap,au.dom())}ao.dom.remove(au.dom())})};var ah=function(ap,an){var ao=ap.dom.select(ae.selector,an);af(ao,function(aq){ap.dom.remove(aq,1)})};var N=function(aq){var ao=aq.getBody();var ap=aq.selection.getBookmark();var an=m.findParentElm(aq.selection.getNode(),ao);an=an!==undefined?an:ao;ah(aq,an);W(aq,an);aq.selection.moveToBookmark(ap)};var V={show:W,hide:ah,toggle:N};var Q=function(ar,ao){var an=ar.getBody();var aq=ar.selection;var ap;ao.set(!ao.get());w.fireVisualChars(ar,ao.get());ap=aq.getBookmark();if(ao.get()===true){V.show(ar,an)}else{V.hide(ar,an)}aq.moveToBookmark(ap)};var b={toggleVisualChars:Q};var p=function(ao,an){ao.addCommand("mceVisualChars",function(){b.toggleVisualChars(ao,an)})};var e={register:p};var ag=tinymce.util.Tools.resolve("tinymce.util.Delay");var o=function(ao,an){var ap=ag.debounce(function(){V.toggle(ao)},300);if(ao.settings.forced_root_block!==false){ao.on("keydown",function(aq){if(an.get()===true){aq.keyCode===13?V.toggle(ao):ap()}})}};var T={setup:o};var g=function(an){return function(ap){var ao=ap.control;an.on("VisualChars",function(aq){ao.active(aq.state)})}};var U=function(an){an.addButton("visualchars",{active:false,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g(an)});an.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:g(an),selectable:true,context:"view",prependToContext:true})};c.add("visualchars",function(ao){var an=J(false);e.register(ao,an);U(ao);T.setup(ao,an);return E.get(an)});function F(){}return F}())})();