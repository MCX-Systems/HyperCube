(function(){var b=(function(){var E=tinymce.util.Tools.resolve("tinymce.PluginManager");var F=tinymce.util.Tools.resolve("tinymce.Env");var A=function(c){return parseInt(c.getParam("plugin_preview_width","650"),10)};var y=function(c){return parseInt(c.getParam("plugin_preview_height","500"),10)};var v=function(c){return c.getParam("content_style","")};var t={getPreviewDialogWidth:A,getPreviewDialogHeight:y,getContentStyle:v};var H=tinymce.util.Tools.resolve("tinymce.util.Tools");var x=function(g){var i;var d="";var h=g.dom.encode;var c=t.getContentStyle(g);d+='<base href="'+h(g.documentBaseURI.getURI())+'">';if(c){d+='<style type="text/css">'+c+"</style>"}H.each(g.contentCSS,function(l){d+='<link type="text/css" rel="stylesheet" href="'+h(g.documentBaseURI.toAbsolute(l))+'">'});var f=g.settings.body_id||"tinymce";if(f.indexOf("=")!==-1){f=g.getParam("body_id","","hash");f=f[g.id]||f}var e=g.settings.body_class||"";if(e.indexOf("=")!==-1){e=g.getParam("body_class","","hash");e=e[g.id]||""}var k='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ';var j=g.settings.directionality?' dir="'+g.settings.directionality+'"':"";i="<!DOCTYPE html><html><head>"+d+'</head><body id="'+h(f)+'" class="mce-content-body '+h(e)+'"'+h(j)+">"+g.getContent()+k+"</body></html>";return i};var a=function(d,e,f){var g=x(d);if(!f){var c=e.contentWindow.document;c.open();c.write(g);c.close()}else{e.src="data:text/html;charset=utf-8,"+encodeURIComponent(g)}};var C={getPreviewHtml:x,injectIframeContent:a};var B=function(e){var g=!F.ie;var c='<iframe src="" frameborder="0"'+(g?' sandbox="allow-scripts"':"")+"></iframe>";var d=t.getPreviewDialogWidth(e);var f=t.getPreviewDialogHeight(e);e.windowManager.open({title:"Preview",width:d,height:f,html:c,buttons:{text:"Close",onclick:function(h){h.control.parent().parent().close()}},onPostRender:function(i){var h=i.control.getEl("body").firstChild;C.injectIframeContent(e,h,g)}})};var z={open:B};var s=function(c){c.addCommand("mcePreview",function(){z.open(c)})};var w={register:s};var G=function(c){c.addButton("preview",{title:"Preview",cmd:"mcePreview"});c.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})};var D={register:G};E.add("preview",function(c){w.register(c);D.register(c)});function u(){}return u}())})();