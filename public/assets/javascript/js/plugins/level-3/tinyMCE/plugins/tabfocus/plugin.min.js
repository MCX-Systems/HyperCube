(function(){var a=(function(){var e=tinymce.util.Tools.resolve("tinymce.PluginManager");var d=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils");var b=tinymce.util.Tools.resolve("tinymce.EditorManager");var p=tinymce.util.Tools.resolve("tinymce.Env");var n=tinymce.util.Tools.resolve("tinymce.util.Delay");var l=tinymce.util.Tools.resolve("tinymce.util.Tools");var k=tinymce.util.Tools.resolve("tinymce.util.VK");var i=function(q){return q.getParam("tabfocus_elements",":prev,:next")};var c=function(q){return q.getParam("tab_focus",i(q))};var f={getTabFocus:c};var m=d.DOM;var o=function(q){if(q.keyCode===k.TAB&&!q.ctrlKey&&!q.altKey&&!q.metaKey){q.preventDefault()}};var h=function(r){function q(z){var s,w,t,u;if(z.keyCode!==k.TAB||z.ctrlKey||z.altKey||z.metaKey||z.isDefaultPrevented()){return}function A(B){w=m.select(":input:enabled,*[tabindex]:not(iframe)");function x(C){return C.nodeName==="BODY"||C.type!=="hidden"&&C.style.display!=="none"&&C.style.visibility!=="hidden"&&x(C.parentNode)}function v(C){return/INPUT|TEXTAREA|BUTTON/.test(C.tagName)&&b.get(z.id)&&C.tabIndex!==-1&&x(C)}l.each(w,function(D,C){if(D.id===r.id){s=C;return false}});if(B>0){for(u=s+1;u<w.length;u++){if(v(w[u])){return w[u]}}}else{for(u=s-1;u>=0;u--){if(v(w[u])){return w[u]}}}return null}t=l.explode(f.getTabFocus(r));if(t.length===1){t[1]=t[0];t[0]=":prev"}if(z.shiftKey){if(t[0]===":prev"){w=A(-1)}else{w=m.get(t[0])}}else{if(t[1]===":next"){w=A(1)}else{w=m.get(t[1])}}if(w){var y=b.get(w.id||w.name);if(w.id&&y){y.focus()}else{n.setTimeout(function(){if(!p.webkit){window.focus()}w.focus()},10)}z.preventDefault()}}r.on("init",function(){if(r.inline){m.setAttrib(r.getBody(),"tabIndex",null)}r.on("keyup",o);if(p.gecko){r.on("keypress keydown",q)}else{r.on("keydown",q)}})};var g={setup:h};e.add("tabfocus",function(q){g.setup(q)});function j(){}return j}())})();