(function(){var a=(function(){var e=tinymce.util.Tools.resolve("tinymce.PluginManager");var b=tinymce.util.Tools.resolve("tinymce.Env");var h=function(r){return r.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)};var p=function(r){return r.getParam("default_link_target","")};var i={getAutoLinkPattern:h,getDefaultLinkTarget:p};var q=function(s,r){return s===r||s===" "||s.charCodeAt(0)===160};var o=function(r){c(r,-1,"(")};var j=function(r){c(r,0,"")};var f=function(r){c(r,-1,"")};var d=function(s,t){if(t<0){t=0}if(s.nodeType===3){var r=s.data.length;if(t>r){t=r}}return t};var l=function(s,r,t){if(r.nodeType!==1||r.hasChildNodes()){s.setStart(r,d(r,t))}else{s.setStartBefore(r)}};var k=function(s,r,t){if(r.nodeType!==1||r.hasChildNodes()){s.setEnd(r,d(r,t))}else{s.setEndAfter(r)}};var c=function(A,C,s){var r,w,u,F,B,E,y,v,z,D;var x=i.getAutoLinkPattern(A);var t=i.getDefaultLinkTarget(A);if(A.selection.getNode().tagName==="A"){return}r=A.selection.getRng(true).cloneRange();if(r.startOffset<5){v=r.endContainer.previousSibling;if(!v){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling){return}v=r.endContainer.firstChild.nextSibling}z=v.length;l(r,v,z);k(r,v,z);if(r.endOffset<5){return}w=r.endOffset;F=v}else{F=r.endContainer;if(F.nodeType!==3&&F.firstChild){while(F.nodeType!==3&&F.firstChild){F=F.firstChild}if(F.nodeType===3){l(r,F,0);k(r,F,F.nodeValue.length)}}if(r.endOffset===1){w=2}else{w=r.endOffset-1-C}}u=w;do{l(r,F,w>=2?w-2:0);k(r,F,w>=1?w-1:0);w-=1;D=r.toString()}while(D!==" "&&D!==""&&D.charCodeAt(0)!==160&&w-2>=0&&D!==s);if(q(r.toString(),s)){l(r,F,w);k(r,F,u);w+=1}else{if(r.startOffset===0){l(r,F,0);k(r,F,u)}else{l(r,F,w);k(r,F,u)}}E=r.toString();if(E.charAt(E.length-1)==="."){k(r,F,u-1)}E=r.toString().trim();y=E.match(x);if(y){if(y[1]==="www."){y[1]="http://www."}else{if(/@$/.test(y[1])&&!/^mailto:/.test(y[1])){y[1]="mailto:"+y[1]}}B=A.selection.getBookmark();A.selection.setRng(r);A.execCommand("createlink",false,y[1]+y[2]);if(t){A.dom.setAttrib(A.selection.getNode(),"target",t)}A.selection.moveToBookmark(B);A.nodeChanged()}};var g=function(s){var r;s.on("keydown",function(t){if(t.keyCode===13){return f(s)}});if(b.ie){s.on("focus",function(){if(!r){r=true;try{s.execCommand("AutoUrlDetect",false,true)}catch(t){}}});return}s.on("keypress",function(t){if(t.keyCode===41){return o(s)}});s.on("keyup",function(t){if(t.keyCode===32){return j(s)}})};var m={setup:g};e.add("autolink",function(r){m.setup(r)});function n(){}return n}())})();