!function(){var aB,aK,av,ax,aA,au=function(c){var b=c,a=function(){return b};return{get:a,set:function(d){b=d},clone:function(){return au(a())}}},aG=tinymce.util.Tools.resolve("tinymce.PluginManager"),aM=function(a){return{isEnabled:function(){return a.get()}}},aO=function(b,a){return b.fire("VisualChars",{state:a})},aJ={"\xa0":"nbsp","\xad":"shy"},aD=function(d,c){var a,b="";for(a in d){b+=a}return new RegExp("["+b+"]",c?"g":"")},aL=function(c){var b,a="";for(b in c){a&&(a+=","),a+="span.mce-"+c[b]}return a},aw={charMap:aJ,regExp:aD(aJ),regExpGlobal:aD(aJ,!0),selector:aL(aJ),charMapToRegExp:aD,charMapToSelector:aL},aC=function(a){return function(){return a}},ad=aC(!1),ak=aC(!0),W=ad,ac=ak,at=function(){return aI},aI=(ax={fold:function(b,a){return b()},is:W,isSome:W,isNone:ac,getOr:av=function(a){return a},getOrThunk:aK=function(a){return a()},getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:av,orThunk:aK,map:at,ap:at,each:function(){},bind:at,flatten:at,exists:W,forall:ac,filter:at,equals:aB=function(a){return a.isNone()},equals_:aB,toArray:function(){return[]},toString:aC("none()")},Object.freeze&&Object.freeze(ax),ax),aH=function(a){var f=function(){return a},c=function(){return d},b=function(e){return e(a)},d={fold:function(h,g){return g(a)},is:function(e){return a===e},isSome:ac,isNone:W,getOr:f,getOrThunk:f,getOrDie:f,getOrNull:f,getOrUndefined:f,or:c,orThunk:c,map:function(e){return aH(e(a))},ap:function(e){return e.fold(at,function(g){return aH(g(a))})},each:function(e){e(a)},bind:b,flatten:f,exists:b,forall:b,filter:function(e){return e(a)?d:aI},equals:function(e){return e.is(a)},equals_:function(h,g){return h.fold(W,function(e){return g(a,e)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return d},az=function(a){return null===a||a===undefined?aI:aH(a)},am=(aA="function",function(a){return function(c){if(null===c){return"null"}var b=typeof c;return"object"===b&&Array.prototype.isPrototypeOf(c)?"array":"object"===b&&String.prototype.isPrototypeOf(c)?"string":b}(a)===aA}),al=function(d,c){for(var a=0,b=d.length;a<b;a++){c(d[a],a,d)}},ae=(Array.prototype.slice,am(Array.from)&&Array.from,function(a){if(null===a||a===undefined){throw new Error("Node cannot be null or undefined")}return{dom:aC(a)}}),ap={fromHtml:function(c,b){var a=(b||document).createElement("div");if(a.innerHTML=c,!a.hasChildNodes()||1<a.childNodes.length){throw console.error("HTML does not have a single root node",c),"HTML must have a single root node"}return ae(a.childNodes[0])},fromTag:function(c,b){var a=(b||document).createElement(c);return ae(a)},fromText:function(c,b){var a=(b||document).createTextNode(c);return ae(a)},fromDom:ae,fromPoint:function(d,c,a){var b=d.dom();return az(b.elementFromPoint(c,a)).map(ae)}},aP={ATTRIBUTE:Node.ATTRIBUTE_NODE,CDATA_SECTION:Node.CDATA_SECTION_NODE,COMMENT:Node.COMMENT_NODE,DOCUMENT:Node.DOCUMENT_NODE,DOCUMENT_TYPE:Node.DOCUMENT_TYPE_NODE,DOCUMENT_FRAGMENT:Node.DOCUMENT_FRAGMENT_NODE,ELEMENT:Node.ELEMENT_NODE,TEXT:Node.TEXT_NODE,PROCESSING_INSTRUCTION:Node.PROCESSING_INSTRUCTION_NODE,ENTITY_REFERENCE:Node.ENTITY_REFERENCE_NODE,ENTITY:Node.ENTITY_NODE,NOTATION:Node.NOTATION_NODE},ao=function(a){return a.dom().nodeName.toLowerCase()},Z=function(a){return a.dom().nodeType},aN=function(a){return function(b){return Z(b)===a}},ag=aN(aP.ELEMENT),aa=aN(aP.TEXT),aE=aN(aP.DOCUMENT),aq={name:ao,type:Z,value:function(a){return a.dom().nodeValue},isElement:ag,isText:aa,isDocument:aE,isComment:function(a){return Z(a)===aP.COMMENT||"#comment"===ao(a)}},ab=function(a){return'<span data-mce-bogus="1" class="mce-'+aw.charMap[a]+'">'+a+"</span>"},Q=function(d,c){var a=[],b=function(k,i){for(var g=k.length,h=new Array(g),j=0;j<g;j++){var f=k[j];h[j]=i(f,j,k)}return h}(d.dom().childNodes,ap.fromDom);return al(b,function(e){c(e)&&(a=a.concat([e])),a=a.concat(Q(e,c))}),a},ar={isMatch:function(a){return aq.isText(a)&&aq.value(a)!==undefined&&aw.regExp.test(aq.value(a))},filterDescendants:Q,findParentElm:function(b,a){for(;b.parentNode;){if(b.parentNode===a){return b}b=b.parentNode}},replaceWithSpans:function(a){return a.replace(aw.regExpGlobal,ab)}},an=function(a,f){var b,d,c=ar.filterDescendants(ap.fromDom(f),ar.isMatch);al(c,function(h){var g=ar.replaceWithSpans(aq.value(h));for(d=a.dom.create("div",null,g);b=d.lastChild;){a.dom.insertAfter(b,h.dom())}a.dom.remove(h.dom())})},af=function(b,c){var a=b.dom.select(aw.selector,c);al(a,function(d){b.dom.remove(d,1)})},ai=an,K=af,z=function(d){var c=d.getBody(),a=d.selection.getBookmark(),b=ar.findParentElm(d.selection.getNode(),c);b=b!==undefined?b:c,af(d,b),an(d,b),d.selection.moveToBookmark(a)},aj=function(f,c){var a,b=f.getBody(),d=f.selection;c.set(!c.get()),aO(f,c.get()),a=d.getBookmark(),!0===c.get()?ai(f,b):K(f,b),d.moveToBookmark(a)},aF=function(b,a){b.addCommand("mceVisualChars",function(){aj(b,a)})},ay=tinymce.util.Tools.resolve("tinymce.util.Delay"),ah=function(c,a){var b=ay.debounce(function(){z(c)},300);!1!==c.settings.forced_root_block&&c.on("keydown",function(d){!0===a.get()&&(13===d.keyCode?z(c):b())})},J=function(a){return function(c){var b=c.control;a.on("VisualChars",function(d){b.active(d.state)})}};aG.add("visualchars",function(c){var b,a=au(!1);return aF(c,a),(b=c).addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:J(b)}),b.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:J(b),selectable:!0,context:"view",prependToContext:!0}),ah(c,a),aM(a)})}();