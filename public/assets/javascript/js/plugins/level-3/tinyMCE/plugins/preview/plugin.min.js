(function(){var a=(function(){var e=tinymce.util.Tools.resolve("tinymce.PluginManager");var d=tinymce.util.Tools.resolve("tinymce.Env");var i=function(s){return parseInt(s.getParam("plugin_preview_width","650"),10)};var k=function(s){return parseInt(s.getParam("plugin_preview_height","500"),10)};var n=function(s){return s.getParam("content_style","")};var p={getPreviewDialogWidth:i,getPreviewDialogHeight:k,getContentStyle:n};var b=tinymce.util.Tools.resolve("tinymce.util.Tools");var l=function(w){var u;var z="";var v=w.dom.encode;var A=p.getContentStyle(w);z+='<base href="'+v(w.documentBaseURI.getURI())+'">';if(A){z+='<style type="text/css">'+A+"</style>"}b.each(w.contentCSS,function(B){z+='<link type="text/css" rel="stylesheet" href="'+v(w.documentBaseURI.toAbsolute(B))+'">'});var x=w.settings.body_id||"tinymce";if(x.indexOf("=")!==-1){x=w.getParam("body_id","","hash");x=x[w.id]||x}var y=w.settings.body_class||"";if(y.indexOf("=")!==-1){y=w.getParam("body_class","","hash");y=y[w.id]||""}var s='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ';var t=w.settings.directionality?' dir="'+w.settings.directionality+'"':"";u="<!DOCTYPE html><html><head>"+z+'</head><body id="'+v(x)+'" class="mce-content-body '+v(y)+'"'+v(t)+">"+w.getContent()+s+"</body></html>";return u};var r=function(v,u,t){var s=l(v);if(!t){var w=u.contentWindow.document;w.open();w.write(s);w.close()}else{u.src="data:text/html;charset=utf-8,"+encodeURIComponent(s)}};var g={getPreviewHtml:l,injectIframeContent:r};var h=function(u){var s=!d.ie;var w='<iframe src="" frameborder="0"'+(s?' sandbox="allow-scripts"':"")+"></iframe>";var v=p.getPreviewDialogWidth(u);var t=p.getPreviewDialogHeight(u);u.windowManager.open({title:"Preview",width:v,height:t,html:w,buttons:{text:"Close",onclick:function(x){x.control.parent().parent().close()}},onPostRender:function(y){var x=y.control.getEl("body").firstChild;g.injectIframeContent(u,x,s)}})};var j={open:h};var q=function(s){s.addCommand("mcePreview",function(){j.open(s)})};var m={register:q};var c=function(s){s.addButton("preview",{title:"Preview",cmd:"mcePreview"});s.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})};var f={register:c};e.add("preview",function(s){m.register(s);f.register(s)});function o(){}return o}())})();